{"version":3,"file":"fcl.js","sources":["../src/VERSION.js","../src/config-utils.js","../src/default-config.js","../src/exec/utils/is.js","../src/exec/utils/normalize-args.js","../src/exec/query.js","../src/current-user/fetch-services.js","../src/current-user/merge-services.js","../src/current-user/normalize/__vsn.js","../src/current-user/normalize/authn.js","../src/current-user/normalize/authz.js","../src/current-user/normalize/pre-authz.js","../src/current-user/normalize/frame.js","../src/current-user/normalize/back-channel-rpc.js","../src/current-user/normalize/open-id.js","../src/current-user/normalize/user-signature.js","../src/current-user/normalize/local-view.js","../src/current-user/normalize/account-proof.js","../src/current-user/normalize/authn-refresh.js","../src/current-user/normalize/service.js","../src/current-user/build-user.js","../src/current-user/service-of-type.js","../src/current-user/exec-service/strategies/utils/service-endpoint.js","../src/current-user/exec-service/strategies/utils/fetch-service.js","../src/current-user/normalize/polling-response.js","../src/current-user/exec-service/strategies/utils/poll.js","../src/current-user/exec-service/strategies/utils/render-frame.js","../src/current-user/exec-service/strategies/utils/render-pop.js","../src/current-user/exec-service/strategies/utils/render-tab.js","../src/current-user/exec-service/exec-local.js","../src/current-user/exec-service/strategies/http-post.js","../src/current-user/exec-service/strategies/utils/buildMessageHandler.js","../src/current-user/exec-service/strategies/utils/frame.js","../src/current-user/exec-service/strategies/iframe-rpc.js","../src/current-user/exec-service/strategies/utils/pop.js","../src/current-user/exec-service/strategies/pop-rpc.js","../src/current-user/exec-service/strategies/utils/tab.js","../src/current-user/exec-service/strategies/tab-rpc.js","../src/current-user/exec-service/strategies/utils/extension.js","../src/current-user/exec-service/strategies/ext-rpc.js","../src/current-user/exec-service/index.js","../src/current-user/normalize/composite-signature.js","../src/current-user/index.js","../src/transaction/index.js","../src/exec/mutate.js","../src/wallet-utils/on-message-from-fcl.js","../src/wallet-utils/send-msg-to-fcl.js","../src/wallet-utils/CompositeSignature.js","../src/wallet-utils/encode-account-proof.js","../src/wallet-utils/inject-ext-service.js","../src/app-utils/verify-signatures.js","../../util-logger/dist/util-logger.module.js","../src/utils/deprecate.js","../src/exec/verify.js","../src/serialize/index.js","../src/events/index.js","../src/discovery/services.js","../src/discovery/services/authn.js","../src/discovery/index.js","../src/fcl.js"],"sourcesContent":["export const VERSION = MICROBUNDLE_CURRENT_VERSION || \"TESTVERSION\"\n","import {config} from \"@onflow/config\"\nimport {VERSION} from \"./VERSION\"\n\nconst isServerSide = () => typeof window === \"undefined\"\n\nconst SESSION_STORAGE = {\n  can: !isServerSide(),\n  get: async key => JSON.parse(sessionStorage.getItem(key)),\n  put: async (key, value) => sessionStorage.setItem(key, JSON.stringify(value)),\n}\n\nconst LOCAL_STORAGE = {\n  can: !isServerSide(),\n  get: async key => JSON.parse(localStorage.getItem(key)),\n  put: async (key, value) => localStorage.setItem(key, JSON.stringify(value)),\n}\n\nconst NO_STORAGE = {\n  can: false,\n}\n\nexport const STORAGE_DEFAULT = SESSION_STORAGE\nexport const DISCOVERY_METHOD = \"IFRAME/RPC\"\n\nexport async function configLens(regex) {\n  return Object.fromEntries(\n    Object.entries(await config().where(regex)).map(([key, value]) => [\n      key.replace(regex, \"\"),\n      value,\n    ])\n  )\n}\n\nexport async function getDiscoveryService() {\n  const discoveryWallet = await config.first([\n    \"discovery.wallet\",\n    \"challenge.handshake\",\n  ])\n\n  const discoveryAuthnInclude = await config.get(\"discovery.authn.include\", [])\n\n  const discoveryWalletMethod = await config.first([\n    \"discovery.wallet.method\",\n    \"discovery.wallet.method.default\",\n  ])\n\n  return {\n    type: \"authn\",\n    endpoint: discoveryWallet,\n    method: discoveryWalletMethod,\n    discoveryAuthnInclude\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {DISCOVERY_METHOD, STORAGE_DEFAULT} from \"./config-utils\"\n\nconfig({\n  \"discovery.wallet.method.default\": DISCOVERY_METHOD,\n  \"fcl.storage.default\": STORAGE_DEFAULT,\n})\n","const is = type => d => typeof d === type\n\nexport const isRequired = d => d != null\nexport const isObject = is(\"object\")\nexport const isString = is(\"string\")\nexport const isFunc = is(\"function\")\nexport const isNumber = is(\"number\")\n","import {isFunc} from \"./is\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\n\nexport function normalizeArgs(ax) {\n  if (isFunc(ax)) return ax(sdk.arg, t)\n  return []\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\nimport {isRequired, isObject, isString, isFunc} from \"./utils/is\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\n\n/** Query the Flow Blockchain\n *\n *  @arg {Object} opts         - Query Options and configuration\n *  @arg {string} opts.cadence - Cadence Script used to query Flow\n *  @arg {ArgsFn} opts.args    - Arguments passed to cadence script\n *  @arg {number} opts.limit   - Compute Limit for Query\n *  @returns {Promise<Response>}\n *\n *  Where:\n *    @callback ArgsFn\n *    @arg {ArgFn}  arg - Argument function to define a single argument\n *    @arg {Object} t   - Cadence Types object used to define the type\n *    @returns {args[]}\n *\n *    @callback ArgFn\n *    @arg {Any}  value - the value of the argument\n *    @arg {Type} type  - the cadence type of the value\n *    @returns {arg}\n *\n *  Example:\n *    const cadence = `\n *      cadence: `\n *        pub fun main(a: Int, b: Int, c: Address): Int {\n *          log(c)\n *          return a + b\n *        }\n *    `.trim()\n *\n *    const args = (arg, t) => [\n *      arg(5, t.Int),\n *      arg(7, t.Int),\n *      arg(\"0xb2db43ad6bc345fec9\", t.Address),\n *    ]\n *\n *    await query({ cadence, args })\n */\nexport async function query(opts = {}) {\n  await preQuery(opts)\n\n  // prettier-ignore\n  return sdk.send([\n    sdk.script(opts.cadence),\n    sdk.args(normalizeArgs(opts.args || [])),\n    opts.limit && typeof opts.limit === \"number\" && sdk.limit(opts.limit)\n  ]).then(sdk.decode)\n}\n\nasync function preQuery(opts) {\n  invariant(\n    isRequired(opts.cadence),\n    \"query({ cadence }) -- cadence is required\"\n  )\n\n  invariant(\n    isString(opts.cadence),\n    \"query({ cadence }) -- cadence must be a string\"\n  )\n\n  invariant(\n    await sdk.config.get(\"accessNode.api\"),\n    `Required value for \"accessNode.api\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`\n  )\n}\n","export async function fetchServices(servicesURL, code) {\n  if (servicesURL == null || code == null) return []\n\n  const url = new URL(servicesURL)\n  url.searchParams.append(\"code\", code)\n\n  const resp = await fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  }).then(d => d.json())\n\n  if (Array.isArray(resp)) return resp\n\n  // Backwards compatibility for First-Gen Wallet Providers\n  const services = []\n\n  // Convert authorizations into authz services\n  if (Array.isArray(resp.authorizations)) {\n    for (let service of resp.authorizations) {\n      services.push({\n        type: \"authz\",\n        keyId: resp.keyId,\n        ...service,\n      })\n    }\n  }\n\n  // Convert Provider info into an authn service\n  if (resp.provider != null) {\n    services.push({\n      type: \"authn\",\n      id: \"wallet-provider#authn\",\n      ...resp.provider,\n    })\n  }\n\n  return services\n}\n","import {withPrefix} from \"@onflow/util-address\"\n\nexport function mergeServices(sx1 = [], sx2 = []) {\n  // TODO: Make this smarter\n  return [...sx1, ...sx2]\n}\n","export const SERVICE_PRAGMA = {\n  f_type: \"Service\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const IDENTITY_PRAGMA = {\n  f_type: \"Identity\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const PROVIDER_PRAGMA = {\n  f_type: \"Provider\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const USER_PRAGMA = {\n  f_type: \"USER\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const POLLING_RESPONSE_PRAGMA = {\n  f_type: \"PollingResponse\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const COMPOSITE_SIGNATURE_PRAGMA = {\n  f_type: \"CompositeSignature\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const OPEN_ID_PRAGMA = {\n  f_type: \"OpenId\",\n  f_vsn: \"1.0.0\",\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"identity\": {\n//     \"address\": \"0x____\"\n//   },\n//   \"provider\": {\n//     \"address\": \"0x____\",\n//     \"name\": \"Best Wallet\",\n//     \"description\": \"The Best Wallet\"\n//     \"icon\": \"https://\",\n//   }\n// }\nexport function normalizeAuthn(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.authn,\n        id: service.pid,\n        provider: {\n          address: withPrefix(service.addr),\n          name: service.name,\n          icon: service.icon,\n        },\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"pre-authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of pre-authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizePreAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"frame\",\n//    \"endpoint\": \"https://rawr\",\n//    \"data\": {},   // Sent to frame when ready\n//    \"params\": {}, // include in query params on frame\n// }\nexport function normalizeFrame(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        old: service,\n        ...SERVICE_PRAGMA,\n        type: \"frame\",\n        endpoint: service.endpoint,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"back-channel-rpc\",\n//    \"endpoint\": \"https://rawr\",\n//    \"method\": \"HTTP/GET\", // HTTP/GET | HTTP/POST\n//    \"data\": {},           // included in body of rpc\n//    \"params\": {},         // included as query params on endpoint url\n// }\nexport function normalizeBackChannelRpc(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: \"back-channel-rpc\",\n        endpoint: service.endpoint,\n        method: service.method,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {SERVICE_PRAGMA, OPEN_ID_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"open-id\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"method: \"data\",\n//   \"data\": {\n//      \"profile\": {\n//        \"name\": \"Bob\",\n//        \"family_name\": \"Builder\",\n//        \"given_name\": \"Robert\",\n//        \"middle_name\": \"the\",\n//        \"nickname\": \"Bob the Builder\",\n//        \"perferred_username\": \"bob\",\n//        \"profile\": \"https://www.bobthebuilder.com/\",\n//        \"picture\": \"https://avatars.onflow.org/avatar/bob\",\n//        \"gender\": \"...\",\n//        \"birthday\": \"2001-01-18\",\n//        \"zoneinfo\": \"America/Vancouver\",\n//        \"locale\": \"en-us\",\n//        \"updated_at\": \"1614970797388\"\n//      },\n//      \"email\": {\n//        \"email\": \"bob@bob.bob\",\n//        \"email_verified\": true\n//      },\n//      \"address\": {\n//        \"address\": \"One Apple Park Way, Cupertino, CA 95014, USA\"\n//      },\n//      \"phone\": {\n//        \"phone_number\": \"+1 (xxx) yyy-zzzz\",\n//        \"phone_number_verified\": true\n//      },\n//      \"social\": {\n//        \"twitter\": \"@_qvvg\",\n//        \"twitter_verified\": true\n//      },\n//   }\n// }\nexport function normalizeOpenId(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"user-signature\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"IFRAME/RPC\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of user-signature request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeUserSignature(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(\"Invalid user-signature service\")\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    type: \"local-view\",\n//    method: \"VIEW/IFRAME\",\n//    endpoint: \"https://woot.org/authz/local\",\n//    data: {},\n//    params: {},\n// }\nexport function normalizeLocalView(resp) {\n  if (resp == null) return null\n  if (resp.method == null) {\n    resp = {...resp, type: \"local-view\", method: \"VIEW/IFRAME\"}\n  }\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: resp.type || \"local-view\",\n        method: resp.method,\n        endpoint: resp.endpoint,\n        data: resp.data || {},\n        params: resp.params || {},\n      }\n  }\n}\n","// {\n//   \"f_type\": \"Service\",                    // Its a service!\n//   \"f_vsn\": \"1.0.0\",                       // Follows the v1.0.0 spec for the service\n//   \"type\": \"account-proof\",                // the type of service it is\n//   \"method\": \"DATA\",                       // Its data!\n//   \"uid\": \"awesome-wallet#account-proof\",  // A unique identifier for the service\n//   \"data\": {\n//     \"f_type\": \"account-proof\",\n//     \"f_vsn\": \"1.0.0\",\n//     \"nonce\": \"0A1BC2FF\",                  // Nonce signed by the current account-proof (minimum 32 bytes in total, i.e 64 hex characters)\n//     \"address\": \"0xUSER\",                  // The user's address (8 bytes, i.e 16 hex characters)\n//     \"signature\": CompositeSignature,      // address (sans-prefix), keyId, signature (hex)\n// }\n\nexport function normalizeAccountProof(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(`FCL Normalizer Error: Invalid account-proof service`)\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn-refresh\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\",  // \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthnRefresh(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(\"Invalid authn-refresh service\")\n  }\n}\n","import {normalizeAuthn} from \"./authn\"\nimport {normalizeAuthz} from \"./authz\"\nimport {normalizePreAuthz} from \"./pre-authz\"\nimport {normalizeFrame} from \"./frame\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeOpenId} from \"./open-id\"\nimport {normalizeUserSignature} from \"./user-signature\"\nimport {normalizeLocalView} from \"./local-view\"\nimport {normalizeAccountProof} from \"./account-proof\"\nimport {normalizeAuthnRefresh} from \"./authn-refresh\"\n\nexport function normalizeServices(services, data) {\n  return services.map(service => normalizeService(service, data))\n}\n\nconst serviceNormalizers = {\n  \"back-channel-rpc\": normalizeBackChannelRpc,\n  \"pre-authz\": normalizePreAuthz,\n  authz: normalizeAuthz,\n  authn: normalizeAuthn,\n  frame: normalizeFrame,\n  \"open-id\": normalizeOpenId,\n  \"user-signature\": normalizeUserSignature,\n  \"local-view\": normalizeLocalView,\n  \"account-proof\": normalizeAccountProof,\n  \"authn-refresh\": normalizeAuthnRefresh,\n}\n\nexport function normalizeService(service, data) {\n  try {\n    var normalized = serviceNormalizers[service.type](service, data)\n    return normalized\n  } catch (error) {\n    console.error(\n      `Unrecognized FCL Service Type [${service.type}]`,\n      service,\n      error\n    )\n    return service\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport * as rlp from \"@onflow/rlp\"\nimport {fetchServices} from \"./fetch-services\"\nimport {mergeServices} from \"./merge-services\"\nimport {USER_PRAGMA} from \"./normalize/__vsn\"\nimport {normalizeService} from \"./normalize/service\"\n\nfunction deriveCompositeId(authn) {\n  return rlp\n    .encode([\n      authn.provider.address || authn.provider.name || \"UNSPECIFIED\",\n      authn.id,\n    ])\n    .toString(\"hex\")\n}\n\nfunction normalizeData(data) {\n  data.addr = data.addr ? withPrefix(data.addr) : null\n  data.paddr = data.paddr ? withPrefix(data.paddr) : null\n  return data\n}\n\nfunction findService(type, services) {\n  return services.find(d => d.type === type)\n}\n\nexport async function buildUser(data) {\n  data = normalizeData(data)\n\n  var services = mergeServices(\n    data.services || [],\n    await fetchServices(data.hks, data.code)\n  ).map(service => normalizeService(service, data))\n\n  const authn = findService(\"authn\", services)\n\n  return {\n    ...USER_PRAGMA,\n    addr: withPrefix(data.addr),\n    cid: deriveCompositeId(authn),\n    loggedIn: true,\n    services: services,\n    expiresAt: data.expires,\n  }\n}\n","export function serviceOfType(services = [], type) {\n  return services.find(service => service.type === type)\n}\n","export function serviceEndpoint(service) {\n  const url = new URL(service.endpoint)\n  url.searchParams.append(\"l6n\", window.location.origin)\n  if (service.params != null) {\n    for (let [key, value] of Object.entries(service.params || {})) {\n      url.searchParams.append(key, value)\n    }\n  }\n  return url\n}\n","import {serviceEndpoint} from \"./service-endpoint\"\n\nexport function fetchService(service, opts = {}) {\n  const method = opts.method || \"POST\"\n  const body =\n    method === \"GET\"\n      ? undefined\n      : JSON.stringify(opts.data || service.data || {})\n\n  return fetch(serviceEndpoint(service), {\n    method: method,\n    headers: {\n      ...(service.headers || {}),\n      ...(opts.headers || {}),\n      \"Content-Type\": \"application/json\",\n    },\n    body: body,\n  }).then((d) => d.json())\n}\n","import {POLLING_RESPONSE_PRAGMA} from \"./__vsn\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeFrame} from \"./frame\"\n\n// {\n//    \"f_type\": \"PollingResponse\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"status\": \"PENDING\", // PENDING | APPROVED | DECLINED | REDIRECT\n//    \"reason\": null,      // Reason for Declining Transaction\n//    \"data\": null,        // Return value for APPROVED\n//    \"updates\": BackChannelRpc,\n//    \"local\": Frame,\n// }\nexport function normalizePollingResponse(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...POLLING_RESPONSE_PRAGMA,\n        status: resp.status ?? \"APPROVED\",\n        reason: resp.reason ?? null,\n        data: resp.compositeSignature || resp.data || {...resp} || {},\n        updates: normalizeBackChannelRpc(resp.authorizationUpdates),\n        local: normalizeFrame((resp.local || [])[0]),\n      }\n  }\n}\n","import {normalizePollingResponse} from \"../../../normalize/polling-response\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {fetchService} from \"./fetch-service\"\n\nconst OPTIONS = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\",\n}\n\nconst serviceMethod = service => {\n  invariant(\n    OPTIONS[service.method],\n    \"Invalid Service Method for type back-channel-rpc\",\n    {service}\n  )\n  return OPTIONS[service.method]\n}\n\nconst serviceBody = service => {\n  if (service.method === \"HTTP/GET\") return undefined\n  if (service.method === \"HTTP/POST\" && service.data != null)\n    return JSON.stringify(service.data)\n  return undefined\n}\n\nexport async function poll(service, canContinue = () => true) {\n  invariant(service, \"Missing Polling Service\", {service})\n  if (!canContinue()) throw new Error(\"Externally Halted\")\n\n  const resp = await fetchService(service, {\n    method: serviceMethod(service),\n  }).then(normalizePollingResponse)\n\n  switch (resp.status) {\n    case \"APPROVED\":\n      return resp.data\n    case \"DECLINED\":\n      throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n    default:\n      await new Promise(r => setTimeout(r, 500))\n      return poll(resp.updates, canContinue)\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\n\nconst FRAME = \"FCL_IFRAME\"\n\nconst FRAME_STYLES = `\n  position:fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  height: 100%;\n  width: 100vw;\n  display:block;\n  background:rgba(0,0,0,0.25);\n  z-index: 2147483647;\n  box-sizing: border-box;\n`\n\nexport function renderFrame(src) {\n  invariant(\n    !document.getElementById(FRAME),\n    \"Attempt at triggering multiple Frames\",\n    {src}\n  )\n\n  const $frame = document.createElement(\"iframe\")\n  $frame.src = src\n  $frame.id = FRAME\n  $frame.allow = \"usb *; hid *\"\n  $frame.frameBorder = \"0\"\n  $frame.style.cssText = FRAME_STYLES\n  document.body.append($frame)\n\n  const unmount = () => {\n    if (document.getElementById(FRAME)) {\n      document.getElementById(FRAME).remove()\n    }\n  }\n\n  return [$frame.contentWindow, unmount]\n}\n","const POP = \"FCL_POP\"\n\nlet popup = null\nlet previousUrl = null\n\nfunction popupWindow(url, windowName, win, w, h) {\n  const y = win.top.outerHeight / 2 + win.top.screenY - h / 2\n  const x = win.top.outerWidth / 2 + win.top.screenX - w / 2\n  return win.open(\n    url,\n    windowName,\n    `toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${w}, height=${h}, top=${y}, left=${x}`\n  )\n}\n\nexport function renderPop(src) {\n  if (popup == null || popup?.closed) {\n    popup = popupWindow(src, POP, window, 640, 770)\n  } else if (previousUrl !== src) {\n    popup.location.replace(src)\n    popup.focus()\n  } else {\n    popup.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (popup && !popup.closed) {\n      popup.close()\n    }\n    popup = null\n  }\n\n  return [popup, unmount]\n}\n","const TAB = \"FCL_TAB\"\n\nlet tab = null\nlet previousUrl = null\n\nexport function renderTab(src) {\n  if (tab == null || tab?.closed) {\n    tab = window.open(src, \"_blank\")\n  } else if (previousUrl !== src) {\n    tab.location.replace(src)\n    tab.focus()\n  } else {\n    tab.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (tab && !tab.closed) {\n      tab.close()\n    }\n    tab = null\n  }\n\n  return [tab, unmount]\n}\n","import {renderFrame} from \"./strategies/utils/render-frame\"\nimport {renderPop} from \"./strategies/utils/render-pop\"\nimport {renderTab} from \"./strategies/utils/render-tab\"\nimport {serviceEndpoint} from \"./strategies/utils/service-endpoint\"\n\nconst VIEWS = {\n  \"VIEW/IFRAME\": renderFrame,\n  \"VIEW/POP\": renderPop,\n  \"VIEW/TAB\": renderTab,\n}\n\nexport async function execLocal(service, opts = {}) {\n  try {\n    return VIEWS[service.method](serviceEndpoint(service), opts)\n  } catch (error) {\n    console.error(\"execLocal({service, opts = {}})\", error, {service, opts})\n    throw error\n  }\n}\n","import {fetchService} from \"./utils/fetch-service\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {normalizeLocalView} from \"../../normalize/local-view\"\nimport {poll} from \"./utils/poll\"\nimport {execLocal} from \"../exec-local\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport async function execHttpPost(service, signable, opts, config) {\n  const resp = await fetchService(service, {\n    data: {\n      fclVersion: VERSION,\n      service: {\n        params: service.params,\n        data: service.data,\n        type: service.type,\n      },\n      config,\n      ...signable,\n    },\n  }).then(normalizePollingResponse)\n\n  if (resp.status === \"APPROVED\") {\n    return resp.data\n  } else if (resp.status === \"DECLINED\") {\n    throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n  } else if (resp.status === \"REDIRECT\") {\n    return resp\n  } else if (resp.status === \"PENDING\") {\n    var canContinue = true\n    const [_, unmount] = await execLocal(normalizeLocalView(resp.local))\n\n    const close = () => {\n      try {\n        unmount()\n        canContinue = false\n      } catch (error) {\n        console.error(\"Frame Close Error\", error)\n      }\n    }\n\n    return poll(resp.updates, () => canContinue)\n      .then(serviceResponse => {\n        close()\n        return serviceResponse\n      })\n      .catch(error => {\n        console.error(error)\n        close()\n        throw error\n      })\n  } else {\n    console.error(`Auto Decline: Invalid Response`, {service, resp})\n    throw new Error(`Auto Decline: Invalid Response`)\n  }\n}\n","const CLOSE_EVENT = \"FCL:VIEW:CLOSE\"\nconst READY_EVENT = \"FCL:VIEW:READY\"\nconst RESPONSE_EVENT = \"FCL:VIEW:RESPONSE\"\n\nconst _ = e => typeof e === \"string\" && e.toLowerCase()\n\nconst IGNORE = new Set([\n  \"monetizationstart\",\n  \"monetizationpending\",\n  \"monetizationprogress\",\n  \"monetizationstop\",\n])\n\nconst deprecate = (was, want) =>\n  console.warn(\n    \"DEPRECATION NOTICE\",\n    `Received ${was}, please use ${want} for this and future versions of FCL`\n  )\n\nexport const buildMessageHandler =\n  ({close, send, onReady, onResponse, onMessage}) =>\n  e => {\n    try {\n      if (typeof e.data !== \"object\") return\n      if (IGNORE.has(e.data.type)) return\n      if (_(e.data.type) === _(CLOSE_EVENT)) close()\n      if (_(e.data.type) === _(READY_EVENT)) onReady(e, {send, close})\n      if (_(e.data.type) === _(RESPONSE_EVENT)) onResponse(e, {send, close})\n      onMessage(e, {send, close})\n\n      // Backwards Compatible\n      if (_(e.data.type) === _(\"FCL:FRAME:READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:CLOSE\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      //\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::AUTHZ_READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      if (_(e.data.type) === _(\"FCL::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n    } catch (error) {\n      console.error(\"Frame Callback Error\", error)\n      close()\n    }\n  }\n","import {renderFrame} from \"./render-frame\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function frame(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n  const [$frame, unmount] = renderFrame(serviceEndpoint(service))\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Frame Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $frame.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Frame Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {frame} from \"./utils/frame\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execIframeRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const includeOlderJsonRpcCall = opts.includeOlderJsonRpcCall\n\n    frame(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            fclVersion: VERSION,\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n              deprecated: {\n                message:\n                  \"jsonrpc is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n              },\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderPop} from \"./render-pop\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function pop(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n  const [$pop, unmount] = renderPop(serviceEndpoint(service))\n  const timer = setInterval(function () {\n    if ($pop && $pop.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Popup Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $pop.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Popup Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {pop} from \"./utils/pop\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execPopRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    pop(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderTab} from \"./render-tab\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function tab(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n  const [$tab, unmount] = renderTab(serviceEndpoint(service))\n  const timer = setInterval(function () {\n    if ($tab && $tab.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Tab Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $tab.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Tab Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {tab} from \"./utils/tab\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execTabRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    tab(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function extension(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n\n  send({service})\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      onClose()\n    } catch (error) {\n      console.error(\"Ext Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      window && window.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Ext Send Error\", msg, error)\n    }\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {extension} from \"./utils/extension\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execExtRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    extension(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execExtRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {execHttpPost} from \"./strategies/http-post\"\nimport {execIframeRPC} from \"./strategies/iframe-rpc\"\nimport {execPopRPC} from \"./strategies/pop-rpc\"\nimport {execTabRPC} from \"./strategies/tab-rpc\"\nimport {execExtRPC} from \"./strategies/ext-rpc\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {configLens} from \"../../config-utils\"\nimport {VERSION} from \"../../VERSION\"\n\nconst STRATEGIES = {\n  \"HTTP/RPC\": execHttpPost,\n  \"HTTP/POST\": execHttpPost,\n  \"IFRAME/RPC\": execIframeRPC,\n  \"POP/RPC\": execPopRPC,\n  \"TAB/RPC\": execTabRPC,\n  \"EXT/RPC\": execExtRPC,\n}\n\nexport async function execService({service, msg = {}, opts = {}, config = {}}) {\n  msg.data = service.data\n  const fullConfig = {\n    ...config,\n    services: await configLens(/^service\\./),\n    app: await configLens(/^app\\.detail\\./),\n    client: {\n      fclVersion: VERSION,\n      fclLibrary: \"https://github.com/onflow/fcl-js\",\n      hostname: window?.location?.hostname ?? null,\n      extensions: window?.fcl_extensions || [],\n    },\n  }\n\n  try {\n    const res = await STRATEGIES[service.method](\n      service, \n      msg, \n      opts, \n      fullConfig\n    )\n    if (res.status === \"REDIRECT\") {\n      invariant(\n        service.type === res.data.type,\n        \"Cannot shift recursive service type in execService\"\n      )\n      return await execService({\n        service: res.data, \n        msg, \n        opts, \n        config: fullConfig\n      })\n    } else {\n      return res\n    }\n  } catch (error) {\n    console.error(\"execService({service, msg = {}, opts = {}, config = {}})\", error, {\n      service,\n      msg,\n      opts,\n      config\n    })\n    throw error\n  }\n}\n","import {COMPOSITE_SIGNATURE_PRAGMA} from \"./__vsn\"\nimport {sansPrefix} from \"@onflow/util-address\"\n\n// {\n//    \"f_type\": \"CompositeSignature\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"addr\": \"_____\",         // sans-prefix\n//    \"signature\": \"adfe1234\", // hex\n//    \"keyId\": 3,\n// }\nexport function normalizeCompositeSignature(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...COMPOSITE_SIGNATURE_PRAGMA,\n        addr: sansPrefix(resp.addr || resp.address),\n        signature: resp.signature || resp.sig,\n        keyId: resp.keyId,\n      }\n  }\n}\n","import \"../default-config\"\nimport * as t from \"@onflow/types\"\nimport {account, arg} from \"@onflow/sdk\"\nimport {config} from \"@onflow/config\"\nimport {spawn, send, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {withPrefix, sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {buildUser} from \"./build-user\"\nimport {serviceOfType} from \"./service-of-type\"\nimport {execService} from \"./exec-service\"\nimport {normalizeCompositeSignature} from \"./normalize/composite-signature\"\nimport {getDiscoveryService} from \"../config-utils\"\n\nconst NAME = \"CURRENT_USER\"\nconst UPDATED = \"CURRENT_USER/UPDATED\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst SET_CURRENT_USER = \"SET_CURRENT_USER\"\nconst DEL_CURRENT_USER = \"DEL_CURRENT_USER\"\n\nconst DATA = `{\n  \"f_type\": \"User\",\n  \"f_vsn\": \"1.0.0\",\n  \"addr\":null,\n  \"cid\":null,\n  \"loggedIn\":null,\n  \"expiresAt\":null,\n  \"services\":[]\n}`\n\nconst getStoredUser = async storage => {\n  const fallback = JSON.parse(DATA)\n  const stored = await storage.get(NAME)\n  if (stored != null && fallback[\"f_vsn\"] !== stored[\"f_vsn\"]) {\n    storage.removeItem(NAME)\n    return fallback\n  }\n  return stored || fallback\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    if (typeof window === \"undefined\") {\n      console.warn(\n        `\n        %cFCL Warning\n        ============================\n        \"currentUser\" is only available in the browser.\n        For more info, please see the docs: https://docs.onflow.org/fcl/\n        ============================\n        `,\n        \"font-weight:bold;font-family:monospace;\"\n      )\n    }\n\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) {\n      const user = await getStoredUser(storage)\n      if (notExpired(user)) ctx.merge(user)\n    }\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply({...ctx.all()})\n  },\n  [SET_CURRENT_USER]: async (ctx, letter, data) => {\n    ctx.merge(data)\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n  [DEL_CURRENT_USER]: async (ctx, letter) => {\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n}\n\nconst spawnCurrentUser = () => spawn(HANDLERS, NAME)\n\nfunction notExpired(user) {\n  return (\n    user.expiresAt == null ||\n    user.expiresAt === 0 ||\n    user.expiresAt > Date.now()\n  )\n}\n\nasync function getAccountProofData() {\n  const accountProofDataResolver = await config.get(\"fcl.accountProof.resolver\")\n  const accountProofData =\n    accountProofDataResolver ?? (await accountProofDataResolver())\n\n  if (accountProofData == null) return\n\n  invariant(\n    typeof accountProofData.appIdentifier === \"string\",\n    \"appIdentifier must be a string\"\n  )\n  invariant(\n    /^[0-9a-f]+$/i.test(accountProofData.nonce),\n    \"Nonce must be a hex string\"\n  )\n\n  return accountProofData\n}\n\nasync function authenticate({service, redir = false} = {}) {\n  return new Promise(async (resolve, reject) => {\n    spawnCurrentUser()\n    const opts = {redir}\n    const user = await snapshot()\n    const discoveryService = await getDiscoveryService()\n    const refreshService = serviceOfType(user.services, \"authn-refresh\")\n    let accountProofData\n\n    try {\n      accountProofData = await getAccountProofData()\n    } catch (error) {\n      console.error(\n        `Error During Authentication: Could not resolve account proof data.\n        ${error}`\n      )\n      return reject(error)\n    }\n\n    invariant(\n      service || discoveryService.endpoint,\n      `\n        If no service passed to \"authenticate,\" then \"discovery.wallet\" must be defined in config.\n        See: \"https://docs.onflow.org/fcl/reference/api/#setting-configuration-values\"\n      `\n    )\n\n    if (user.loggedIn) {\n      if (refreshService) {\n        try {\n          const response = await execService({\n            service: refreshService,\n            msg: accountProofData,\n            opts,\n          })\n          send(NAME, SET_CURRENT_USER, await buildUser(response))\n        } catch (e) {\n          console.error(\"Error: Could not refresh authentication.\", e)\n        } finally {\n          return resolve(await snapshot())\n        }\n      } else {\n        return resolve(user)\n      }\n    }\n\n    try {\n      const response = await execService({\n        service: {\n          ...(service || discoveryService),\n          method: discoveryService?.method || service.method || \"IFRAME/RPC\",\n        },\n        msg: accountProofData,\n        opts,\n        config: {\n          discoveryAuthnInclude: discoveryService.discoveryAuthnInclude,\n        },\n      })\n      send(NAME, SET_CURRENT_USER, await buildUser(response))\n    } catch (e) {\n      console.error(\"Error while authenticating\", e)\n    } finally {\n      resolve(await snapshot())\n    }\n  })\n}\n\nfunction unauthenticate() {\n  spawnCurrentUser()\n  send(NAME, DEL_CURRENT_USER)\n}\n\nconst normalizePreAuthzResponse = authz => ({\n  f_type: \"PreAuthzResponse\",\n  f_vsn: \"1.0.0\",\n  proposer: (authz || {}).proposer,\n  payer: (authz || {}).payer || [],\n  authorization: (authz || {}).authorization || [],\n})\n\nfunction resolvePreAuthz(authz) {\n  const resp = normalizePreAuthzResponse(authz)\n  const axs = []\n\n  if (resp.proposer != null) axs.push([\"PROPOSER\", resp.proposer])\n  for (let az of resp.payer || []) axs.push([\"PAYER\", az])\n  for (let az of resp.authorization || []) axs.push([\"AUTHORIZER\", az])\n\n  var result = axs.map(([role, az]) => ({\n    tempId: [az.identity.address, az.identity.keyId].join(\"|\"),\n    addr: az.identity.address,\n    keyId: az.identity.keyId,\n    signingFunction(signable) {\n      return execService({service: az, msg: signable})\n    },\n    role: {\n      proposer: role === \"PROPOSER\",\n      payer: role === \"PAYER\",\n      authorizer: role === \"AUTHORIZER\",\n    },\n  }))\n  return result\n}\n\nasync function authorization(account) {\n  spawnCurrentUser()\n\n  return {\n    ...account,\n    tempId: \"CURRENT_USER\",\n    async resolve(account, preSignable) {\n      const user = await authenticate({redir: true})\n      const authz = serviceOfType(user.services, \"authz\")\n      const preAuthz = serviceOfType(user.services, \"pre-authz\")\n\n      if (preAuthz)\n        return resolvePreAuthz(\n          await execService({\n            service: preAuthz,\n            msg: preSignable,\n          })\n        )\n      if (authz)\n        return {\n          ...account,\n          tempId: \"CURRENT_USER\",\n          resolve: null,\n          addr: sansPrefix(authz.identity.address),\n          keyId: authz.identity.keyId,\n          sequenceNum: null,\n          signature: null,\n          async signingFunction(signable) {\n            return normalizeCompositeSignature(\n              await execService({\n                service: authz,\n                msg: signable,\n                opts: {\n                  includeOlderJsonRpcCall: true,\n                },\n              })\n            )\n          },\n        }\n      throw new Error(\n        \"No Authz or PreAuthz Service configured for CURRENT_USER\"\n      )\n    },\n  }\n}\n\nfunction subscribe(callback) {\n  spawnCurrentUser()\n  const EXIT = \"@EXIT\"\n  const self = spawn(async ctx => {\n    ctx.send(NAME, SUBSCRIBE)\n    while (1) {\n      const letter = await ctx.receive()\n      if (letter.tag === EXIT) {\n        ctx.send(NAME, UNSUBSCRIBE)\n        return\n      }\n      callback(letter.data)\n    }\n  })\n  return () => send(self, EXIT)\n}\n\nfunction snapshot() {\n  spawnCurrentUser()\n  return send(NAME, SNAPSHOT, null, {expectReply: true, timeout: 0})\n}\n\nasync function info() {\n  spawnCurrentUser()\n  const {addr} = await snapshot()\n  if (addr == null) throw new Error(\"No Flow Address for Current User\")\n  return account(addr)\n}\n\nasync function resolveArgument() {\n  const {addr} = await authenticate()\n  return arg(withPrefix(addr), t.Address)\n}\n\nconst makeSignable = msg => {\n  invariant(/^[0-9a-f]+$/i.test(msg), \"Message must be a hex string\")\n\n  return {\n    message: msg,\n  }\n}\n\nasync function signUserMessage(msg) {\n  spawnCurrentUser()\n  const user = await authenticate({redir: true})\n\n  const signingService = serviceOfType(user.services, \"user-signature\")\n\n  invariant(\n    signingService,\n    \"Current user must have authorized a signing service.\"\n  )\n\n  try {\n    const response = await execService({\n      service: signingService,\n      msg: makeSignable(msg),\n    })\n    if (Array.isArray(response)) {\n      return response.map(compSigs => normalizeCompositeSignature(compSigs))\n    } else {\n      return [normalizeCompositeSignature(response)]\n    }\n  } catch (error) {\n    return error\n  }\n}\n\nlet currentUser = () => {\n  return {\n    authenticate,\n    unauthenticate,\n    authorization,\n    signUserMessage,\n    subscribe,\n    snapshot,\n    resolveArgument,\n  }\n}\n\ncurrentUser.authenticate = authenticate\ncurrentUser.unauthenticate = unauthenticate\ncurrentUser.authorization = authorization\ncurrentUser.signUserMessage = signUserMessage\ncurrentUser.subscribe = subscribe\ncurrentUser.snapshot = snapshot\ncurrentUser.resolveArgument = resolveArgument\n\nexport {currentUser}\n","import \"../default-config\"\nimport {\n  spawn,\n  send,\n  subscriber,\n  snapshoter,\n  UPDATED,\n  SNAPSHOT,\n  INIT,\n  SUBSCRIBE,\n  UNSUBSCRIBE,\n} from \"@onflow/util-actor\"\nimport {send as fclSend, decode, getTransactionStatus} from \"@onflow/sdk\"\n\nconst RATE = 2500\nconst POLL = \"POLL\"\n\nconst fetchTxStatus = async transactionId => {\n  return fclSend([getTransactionStatus(transactionId)]).then(decode)\n}\n\nconst isExpired = tx => tx.status === 5\nconst isSealed = tx => tx.status >= 4\nconst isExecuted = tx => tx.status >= 3\nconst isFinalized = tx => tx.status >= 2\nconst isPending = tx => tx.status >= 1\nconst isUnknown = tx => tx.status >= 0\n\nconst isDiff = (cur, next) => {\n  return JSON.stringify(cur) !== JSON.stringify(next)\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    const tx = await fetchTxStatus(ctx.self())\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    ctx.merge(tx)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, ctx.all())\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply(ctx.all())\n  },\n  [POLL]: async ctx => {\n    let tx\n    try {\n      tx = await fetchTxStatus(ctx.self())\n    } catch (e) {\n      console.error(e)\n      setTimeout(() => ctx.sendSelf(POLL), RATE)\n      return\n    }\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    if (isDiff(ctx.all(), tx)) ctx.broadcast(UPDATED, tx)\n    ctx.merge(tx)\n  },\n}\n\nconst scoped = transactionId => {\n  if (typeof transactionId === \"object\")\n    transactionId = transactionId.transactionId\n  if (transactionId == null) throw new Error(\"transactionId required\")\n  return transactionId\n}\n\nconst spawnTransaction = transactionId => {\n  return spawn(HANDLERS, scoped(transactionId))\n}\n\nexport function transaction(transactionId) {\n  function snapshot() {\n    return snapshoter(transactionId, spawnTransaction)\n  }\n\n  function subscribe(callback) {\n    return subscriber(scoped(transactionId), spawnTransaction, callback)\n  }\n\n  function once(predicate) {\n    return function innerOnce(opts = {}) {\n      const suppress = opts.suppress || false\n      return new Promise((resolve, reject) => {\n        const unsub = subscribe(txStatus => {\n          if (txStatus.statusCode && !suppress) {\n            reject(txStatus.errorMessage)\n            unsub()\n          } else if (predicate(txStatus)) {\n            resolve(txStatus)\n            unsub()\n          }\n        })\n      })\n    }\n  }\n\n  return {\n    snapshot,\n    subscribe,\n    onceFinalized: once(isFinalized),\n    onceExecuted: once(isExecuted),\n    onceSealed: once(isSealed),\n  }\n}\n\ntransaction.isUnknown = isUnknown\ntransaction.isPending = isPending\ntransaction.isFinalized = isFinalized\ntransaction.isExecuted = isExecuted\ntransaction.isSealed = isSealed\ntransaction.isExpired = isExpired\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport {isRequired, isObject, isString, isFunc, isNumber} from \"./utils/is\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\nimport {currentUser} from \"../current-user\"\nimport {transaction} from \"../transaction\"\n\n/** As the current user Mutate the Flow Blockchain\n *\n *  @arg {Object} opts - Mutation Options and configuration\n *  @arg {string} opts.cadence - Cadence Transaction used to mutate Flow\n *  @arg {ArgsFn} opts.args - Arguments passed to cadence transaction\n *  @arg {number} opts.limit - Compute Limit for transaction\n *  @returns {string} Transaction Id\n *\n *  Where:\n *    @callback ArgsFn\n *    @arg {ArgFn}  arg - Argument function to define a single argument\n *    @arg {Object} t   - Cadence Types object used to define the type\n *    @returns {args[]}\n *\n *    @callback ArgFn\n *    @arg {Any}  value - the value of the argument\n *    @arg {Type} type  - the cadence type of the value\n *    @returns {arg}\n *\n *  Example:\n *    fcl.mutate({\n *      cadence: `\n *        transaction(a: Int, b: Int, c: Address) {\n *          prepare(acct: AuthAccount) {\n *            log(acct)\n *            log(a)\n *            log(b)\n *            log(c)\n *          }\n *        }\n *      `,\n *      args: (arg, t) => [\n *        arg(6, t.Int),\n *        arg(7, t.Int),\n *        arg(\"0xba1132bc08f82fe2\", t.Address),\n *      ],\n *    })\n *\n *\n *  Options:\n *    type Options = {\n *      cadence: String!,\n *      args: (arg, t) => Array<Arg>,\n *      limit: Number,\n *      authz: AuthzFn, // will overload the trinity of signatory roles\n *      proposer: AuthzFn, // will overload the proposer signatory role\n *      payer: AuthzFn, // will overload the payer signatory role\n *      authorizations: [AuthzFn], // an array of authorization functions used as authorizations signatory roles\n *    }\n */\n\nconst noop = () => {}\n\nexport async function mutate(opts = {}) {\n  var txid\n  try {\n    await prepMutation(opts)\n\n    // Allow for a config to overwrite the authorization function.\n    // prettier-ignore\n    const authz = await sdk.config().get(\"fcl.authz\", currentUser().authorization)\n\n    // prettier-ignore\n    txid = sdk.send([\n      sdk.transaction(opts.cadence),\n\n      sdk.args(normalizeArgs(opts.args || [])),\n\n      opts.limit && isNumber(opts.limit) && sdk.limit(opts.limit),\n\n      // opts.proposer > opts.authz > authz\n      sdk.proposer(opts.proposer || opts.authz || authz),\n\n      // opts.payer > opts.authz > authz\n      sdk.payer(opts.payer || opts.authz || authz),\n\n      // opts.authorizations > [opts.authz > authz]\n      sdk.authorizations(opts.authorizations || [opts.authz || authz]),\n    ]).then(sdk.decode)\n\n    return txid\n  } catch (error) {\n    throw error\n  }\n}\n\nasync function prepMutation(opts) {\n  // prettier-ignore\n  invariant(isRequired(opts), \"mutate(opts) -- opts is required\")\n  // prettier-ignore\n  invariant(isObject(opts), \"mutate(opts) -- opts must be an object\")\n  // prettier-ignore\n  invariant(isRequired(opts.cadence), \"mutate({ cadence }) -- cadence is required\")\n  // prettier-ignore\n  invariant(isString(opts.cadence), \"mutate({ cadence }) -- cadence must be a string\")\n  // prettier-ignore\n  invariant(\n    await sdk.config.get(\"accessNode.api\"),\n    `Required value for \"accessNode.api\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`\n  )\n}\n","export const onMessageFromFCL = (messageType, cb = () => {}) => {\n  const buildData = data => {\n    if (data.deprecated)\n      console.warn(\"DEPRECATION NOTICE\", data.deprecated.message)\n    delete data?.body?.interaction\n\n    return data\n  }\n\n  const internal = e => {\n    const {data} = e\n    if (typeof data !== \"object\") return\n    if (typeof data == null) return\n    if (data.type !== messageType) return\n\n    cb(buildData(data))\n  }\n\n  window.addEventListener(\"message\", internal)\n  return () => window.removeEventListener(\"message\", internal)\n}\n","import {onMessageFromFCL} from \"./on-message-from-fcl\"\n\nexport const sendMsgToFCL = (type, msg = {}) => {\n  if (window.location !== window.parent.location) {\n    window.parent.postMessage({...msg, type}, \"*\")\n  } else {\n    window.opener.postMessage({...msg, type}, \"*\")\n  }\n}\n\nexport const ready = (cb, msg = {}) => {\n  onMessageFromFCL(\"FCL:VIEW:READY:RESPONSE\", cb)\n  sendMsgToFCL(\"FCL:VIEW:READY\")\n}\n\nexport const close = () => {\n  sendMsgToFCL(\"FCL:VIEW:CLOSE\")\n}\n\nexport const approve = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"APPROVED\",\n    reason: null,\n    data: data,\n  })\n}\n\nexport const decline = reason => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"DECLINED\",\n    reason: reason,\n    data: null,\n  })\n}\n\nexport const redirect = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"REDIRECT\",\n    reason: null,\n    data: data,\n  })\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {COMPOSITE_SIGNATURE_PRAGMA} from \"../current-user/normalize/__vsn\"\n\nexport function CompositeSignature(addr, keyId, signature) {\n  this.f_type = COMPOSITE_SIGNATURE_PRAGMA.f_type\n  this.f_vsn = COMPOSITE_SIGNATURE_PRAGMA.f_vsn\n  this.addr = withPrefix(addr)\n  this.keyId = Number(keyId)\n  this.signature = signature\n}\n","import {sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {Buffer, encode as rlpEncode} from \"@onflow/rlp\"\n\nconst rightPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padEnd(pad * 2, \"0\"), \"hex\")\n\nconst leftPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padStart(pad * 2, \"0\"), \"hex\")\n\nconst addressBuffer = addr => leftPaddedHexBuffer(addr, 8)\n\nconst nonceBuffer = nonce => Buffer.from(nonce, \"hex\")\n\nexport const encodeAccountProof = (\n  {address, nonce, appIdentifier},\n  includeDomainTag = true\n) => {\n  invariant(\n    address,\n    \"Encode Message For Provable Authn Error: address must be defined\"\n  )\n  invariant(\n    nonce,\n    \"Encode Message For Provable Authn Error: nonce must be defined\"\n  )\n  invariant(\n    appIdentifier,\n    \"Encode Message For Provable Authn Error: appIdentifier must be defined\"\n  )\n\n  invariant(\n    nonce.length >= 64,\n    \"Encode Message For Provable Authn Error: nonce must be minimum of 32 bytes\"\n  )\n\n  const ACCOUNT_PROOF_DOMAIN_TAG = rightPaddedHexBuffer(\n    Buffer.from(\"FCL-ACCOUNT-PROOF-V0.0\").toString(\"hex\"),\n    32\n  )\n\n  if (includeDomainTag) {\n    return Buffer.concat([\n      ACCOUNT_PROOF_DOMAIN_TAG,\n      rlpEncode([\n        appIdentifier,\n        addressBuffer(sansPrefix(address)),\n        nonceBuffer(nonce),\n      ]),\n    ]).toString(\"hex\")\n  }\n\n  return rlpEncode([\n    appIdentifier,\n    addressBuffer(sansPrefix(address)),\n    nonceBuffer(nonce),\n  ]).toString(\"hex\")\n}\n","export function injectExtService(service) {\n  if (service.type === \"authn\" && service.endpoint != null) {\n    if (!Array.isArray(window.fcl_extensions)) {\n      window.fcl_extensions = []\n    }\n    window.fcl_extensions.push(service)\n  } else {\n    console.warn(\"Authn service is required\")\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {sansPrefix} from \"@onflow/util-address\"\nimport {query} from \"../exec/query\"\nimport {encodeAccountProof} from \"../wallet-utils\"\nimport {isString} from \"../exec/utils/is\"\n\nconst ACCOUNT_PROOF = \"ACCOUNT_PROOF\"\nconst USER_SIGNATURE = \"USER_SIGNATURE\"\n\nexport const validateArgs = args => {\n  if (args.appIdentifier) {\n    const {appIdentifier, address, nonce, signatures} = args\n    invariant(\n      isString(appIdentifier),\n      \"verifyAccountProof({ appIdentifier }) -- appIdentifier must be a string\"\n    )\n    invariant(\n      isString(address) && sansPrefix(address).length === 16,\n      \"verifyAccountProof({ address }) -- address must be a valid address\"\n    )\n    invariant(/^[0-9a-f]+$/i.test(nonce), \"nonce must be a hex string\")\n    invariant(\n      Array.isArray(signatures) &&\n        signatures.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      signatures.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  } else {\n    const {message, compSigs} = args\n    invariant(\n      /^[0-9a-f]+$/i.test(message),\n      \"Signed message must be a hex string\"\n    )\n    invariant(\n      Array.isArray(compSigs) &&\n        compSigs.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      compSigs.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  }\n}\n\nconst getVerifySignaturesScript = async (sig, opts) => {\n  const verifyFunction =\n    sig === \"ACCOUNT_PROOF\"\n      ? \"verifyAccountProofSignatures\"\n      : \"verifyUserSignatures\"\n\n  const network = await config.first([\"env\", \"flow.network\"])\n  let fclCryptoContract\n\n  invariant(\n    opts.fclCryptoContract || network === \"testnet\" || network === \"mainnet\",\n    \"${verifyFunction}({ fclCryptoContract }) -- config.flow.network must be specified (testnet || mainnet) or contract address provided via opts.fclCryptoContract\"\n  )\n\n  if (opts.fclCryptoContract) {\n    fclCryptoContract = opts.fclCryptoContract\n  } else {\n    fclCryptoContract =\n      network === \"testnet\" ? \"0x74daa6f9c7ef24b1\" : \"0xb4b82a1c9d21d284\"\n  }\n\n  return `\n      import FCLCrypto from ${fclCryptoContract}\n\n      pub fun main(\n          address: Address, \n          message: String, \n          keyIndices: [Int], \n          signatures: [String]\n      ): Bool {\n        return FCLCrypto.${verifyFunction}(address: address, message: message, keyIndices: keyIndices, signatures: signatures)\n      }\n    `\n}\n\n/**\n * Verify a valid account proof signature or signatures for an account on Flow.\n *\n * @param {string} appIdentifier - A message string in hexadecimal format\n * @param {Object} accountProofData - An object consisting of address, nonce, and signatures\n * @param {string} accountProofData.address - A Flow account address\n * @param {string} accountProofData.nonce - A random string in hexadecimal format (minimum 32 bytes in total, i.e 64 hex characters)\n * @param {Object[]} accountProofData.signatures - An array of composite signatures to verify\n * @param {Object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override Flow account address where the FCLCrypto contract is deployed\n * @return {bool}\n *\n * @example\n *\n *  const accountProofData = {\n *   address: \"0x123\",\n *   nonce: \"F0123\"\n *   signatures: [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *  }\n *\n *  const isValid = await fcl.AppUtils.verifyAccountProof(\n *    \"AwesomeAppId\",\n *    accountProofData,\n *    {fclCryptoContract}\n *  )\n */\n\nexport async function verifyAccountProof(\n  appIdentifier,\n  {address, nonce, signatures},\n  opts = {}\n) {\n  validateArgs({appIdentifier, address, nonce, signatures})\n\n  const message = encodeAccountProof({address, nonce, appIdentifier}, false)\n\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of signatures) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId)\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(ACCOUNT_PROOF, opts),\n    args: (arg, t) => [\n      arg(address, t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array([t.Int])),\n      arg(signaturesArr, t.Array([t.String])),\n    ],\n  })\n}\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @param {string} msg - A message string in hexadecimal format\n * @param {Array} compSigs - An array of Composite Signatures\n * @param {string} compSigs[].addr - The account address\n * @param {number} compSigs[].keyId - The account keyId\n * @param {string} compSigs[].signature - The signature to verify\n * @param {Object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override of Flow account address where the FCLCrypto contract is deployed\n * @return {bool}\n *\n * @example\n *\n *  const isValid = await fcl.AppUtils.verifyUserSignatures(\n *    Buffer.from('FOO').toString(\"hex\"),\n *    [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *    {fclCryptoContract}\n *  )\n */\nexport async function verifyUserSignatures(message, compSigs, opts = {}) {\n  validateArgs({message, compSigs})\n\n  const address = compSigs[0].addr\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of compSigs) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId)\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(USER_SIGNATURE, opts),\n    args: (arg, t) => [\n      arg(address, t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array([t.Int])),\n      arg(signaturesArr, t.Array([t.String])),\n    ],\n  })\n}\n","var promise;\nvar queueMicrotask_1 = typeof queueMicrotask === 'function' ? queueMicrotask : function (cb) {\n  return (promise || (promise = Promise.resolve())).then(cb)[\"catch\"](function (err) {\n    return setTimeout(function () {\n      throw err;\n    }, 0);\n  });\n};\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar mailbox = function mailbox() {\n  var queue = [];\n  var next;\n  return {\n    deliver: function deliver(msg) {\n      try {\n        queue.push(msg);\n\n        if (next) {\n          next(queue.shift());\n          next = undefined;\n        }\n\n        return Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    },\n    receive: function receive() {\n      return new Promise(function innerReceive(resolve) {\n        var msg = queue.shift();\n        if (msg) return resolve(msg);\n        next = resolve;\n      });\n    }\n  };\n};\n\nfunction _catch(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n\n  return result;\n}\n\nfunction _finallyRethrows(body, finalizer) {\n  try {\n    var result = body();\n  } catch (e) {\n    return finalizer(true, e);\n  }\n\n  if (result && result.then) {\n    return result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n  }\n\n  return finalizer(false, result);\n}\n\nfunction _settle(pact, state, value) {\n  if (!pact.s) {\n    if (value instanceof _Pact) {\n      if (value.s) {\n        if (state & 1) {\n          state = value.s;\n        }\n\n        value = value.v;\n      } else {\n        value.o = _settle.bind(null, pact, state);\n        return;\n      }\n    }\n\n    if (value && value.then) {\n      value.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n      return;\n    }\n\n    pact.s = state;\n    pact.v = value;\n    var observer = pact.o;\n\n    if (observer) {\n      observer(pact);\n    }\n  }\n}\n\nvar _Pact = /*#__PURE__*/function () {\n  function _Pact() {}\n\n  _Pact.prototype.then = function (onFulfilled, onRejected) {\n    var result = new _Pact();\n    var state = this.s;\n\n    if (state) {\n      var callback = state & 1 ? onFulfilled : onRejected;\n\n      if (callback) {\n        try {\n          _settle(result, 1, callback(this.v));\n        } catch (e) {\n          _settle(result, 2, e);\n        }\n\n        return result;\n      } else {\n        return this;\n      }\n    }\n\n    this.o = function (_this) {\n      try {\n        var value = _this.v;\n\n        if (_this.s & 1) {\n          _settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n        } else if (onRejected) {\n          _settle(result, 1, onRejected(value));\n        } else {\n          _settle(result, 2, value);\n        }\n      } catch (e) {\n        _settle(result, 2, e);\n      }\n    };\n\n    return result;\n  };\n\n  return _Pact;\n}();\n\nfunction _isSettledPact(thenable) {\n  return thenable instanceof _Pact && thenable.s & 1;\n}\n\nfunction _for(test, update, body) {\n  var stage;\n\n  for (;;) {\n    var shouldContinue = test();\n\n    if (_isSettledPact(shouldContinue)) {\n      shouldContinue = shouldContinue.v;\n    }\n\n    if (!shouldContinue) {\n      return result;\n    }\n\n    if (shouldContinue.then) {\n      stage = 0;\n      break;\n    }\n\n    var result = body();\n\n    if (result && result.then) {\n      if (_isSettledPact(result)) {\n        result = result.s;\n      } else {\n        stage = 1;\n        break;\n      }\n    }\n\n    if (update) {\n      var updateValue = update();\n\n      if (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n        stage = 2;\n        break;\n      }\n    }\n  }\n\n  var pact = new _Pact();\n\n  var reject = _settle.bind(null, pact, 2);\n\n  (stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n  return pact;\n\n  function _resumeAfterBody(value) {\n    result = value;\n\n    do {\n      if (update) {\n        updateValue = update();\n\n        if (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n          updateValue.then(_resumeAfterUpdate).then(void 0, reject);\n          return;\n        }\n      }\n\n      shouldContinue = test();\n\n      if (!shouldContinue || _isSettledPact(shouldContinue) && !shouldContinue.v) {\n        _settle(pact, 1, result);\n\n        return;\n      }\n\n      if (shouldContinue.then) {\n        shouldContinue.then(_resumeAfterTest).then(void 0, reject);\n        return;\n      }\n\n      result = body();\n\n      if (_isSettledPact(result)) {\n        result = result.v;\n      }\n    } while (!result || !result.then);\n\n    result.then(_resumeAfterBody).then(void 0, reject);\n  }\n\n  function _resumeAfterTest(shouldContinue) {\n    if (shouldContinue) {\n      result = body();\n\n      if (result && result.then) {\n        result.then(_resumeAfterBody).then(void 0, reject);\n      } else {\n        _resumeAfterBody(result);\n      }\n    } else {\n      _settle(pact, 1, result);\n    }\n  }\n\n  function _resumeAfterUpdate() {\n    if (shouldContinue = test()) {\n      if (shouldContinue.then) {\n        shouldContinue.then(_resumeAfterTest).then(void 0, reject);\n      } else {\n        _resumeAfterTest(shouldContinue);\n      }\n    } else {\n      _settle(pact, 1, result);\n    }\n  }\n}\n\nvar INIT = \"INIT\";\nvar SUBSCRIBE = \"SUBSCRIBE\";\nvar UNSUBSCRIBE = \"UNSUBSCRIBE\";\nvar EXIT = \"EXIT\";\nvar TERMINATE = \"TERMINATE\";\nvar root = typeof self === \"object\" && self.self === self && self || typeof global === \"object\" && global.global === global && global || typeof window === \"object\" && window.window === window && window;\nroot.FCL_REGISTRY = root.FCL_REGISTRY == null ? {} : root.FCL_REGISTRY;\nvar pid = 0;\nvar DEFAULT_TIMEOUT = 5000;\n\nvar _send = function send(addr, tag, data, opts) {\n  if (opts === void 0) {\n    opts = {};\n  }\n\n  return new Promise(function (reply, reject) {\n    var expectReply = opts.expectReply || false;\n    var timeout = opts.timeout != null ? opts.timeout : DEFAULT_TIMEOUT;\n\n    if (expectReply && timeout) {\n      setTimeout(function () {\n        return reject(new Error(\"Timeout: \" + timeout + \"ms passed without a response.\"));\n      }, timeout);\n    }\n\n    var payload = {\n      to: addr,\n      from: opts.from,\n      tag: tag,\n      data: data,\n      timeout: timeout,\n      reply: reply,\n      reject: reject\n    };\n\n    try {\n      root.FCL_REGISTRY[addr] && root.FCL_REGISTRY[addr].mailbox.deliver(payload);\n      if (!expectReply) reply(true);\n    } catch (error) {\n      console.error(\"FCL.Actor -- Could Not Deliver Message\", payload, root.FCL_REGISTRY[addr], error);\n    }\n  });\n};\n\nvar kill = function kill(addr) {\n  delete root.FCL_REGISTRY[addr];\n};\n\nvar fromHandlers = function fromHandlers(handlers) {\n  if (handlers === void 0) {\n    handlers = {};\n  }\n\n  return function (ctx) {\n    try {\n      var _temp12 = function _temp12() {\n        var _loopInterrupt;\n\n        var _temp6 = _for(function () {\n          return !_loopInterrupt && 1;\n        }, void 0, function () {\n          return Promise.resolve(ctx.receive()).then(function (letter) {\n            var _temp5 = _finallyRethrows(function () {\n              return _catch(function () {\n                function _temp4() {\n                  return Promise.resolve(handlers[letter.tag](ctx, letter, letter.data || {})).then(function () {});\n                }\n\n                var _temp3 = function () {\n                  if (letter.tag === EXIT) {\n                    var _temp10 = function _temp10() {\n                      _loopInterrupt = 1;\n                    };\n\n                    var _temp11 = function () {\n                      if (typeof handlers[TERMINATE] === \"function\") {\n                        return Promise.resolve(handlers[TERMINATE](ctx, letter, letter.data || {})).then(function () {});\n                      }\n                    }();\n\n                    return _temp11 && _temp11.then ? _temp11.then(_temp10) : _temp10(_temp11);\n                  }\n                }();\n\n                return _temp3 && _temp3.then ? _temp3.then(_temp4) : _temp4(_temp3);\n              }, function (error) {\n                console.error(ctx.self() + \" Error\", letter, error);\n              });\n            }, function (_wasThrown, _result) {\n              return;\n              if (_wasThrown) throw _result;\n              return _result;\n            });\n\n            if (_temp5 && _temp5.then) return _temp5.then(function () {});\n          });\n        });\n\n        var _temp7 = function () {\n          if (_temp6 && _temp6.then) return _temp6.then(function () {});\n        }();\n\n        if (_temp7 && _temp7.then) return _temp7.then(function () {});\n      };\n\n      var _temp13 = function () {\n        if (typeof handlers[INIT] === \"function\") return Promise.resolve(handlers[INIT](ctx)).then(function () {});\n      }();\n\n      return Promise.resolve(_temp13 && _temp13.then ? _temp13.then(_temp12) : _temp12(_temp13));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n};\n\nvar spawn = function spawn(fn, addr) {\n  if (addr === void 0) {\n    addr = null;\n  }\n\n  if (addr == null) addr = ++pid;\n  if (root.FCL_REGISTRY[addr] != null) return addr;\n  root.FCL_REGISTRY[addr] = {\n    addr: addr,\n    mailbox: mailbox(),\n    subs: new Set(),\n    kvs: {}\n  };\n  var ctx = {\n    self: function self() {\n      return addr;\n    },\n    receive: function receive() {\n      return root.FCL_REGISTRY[addr].mailbox.receive();\n    },\n    send: function send(to, tag, data, opts) {\n      if (opts === void 0) {\n        opts = {};\n      }\n\n      opts.from = addr;\n      return _send(to, tag, data, opts);\n    },\n    sendSelf: function sendSelf(tag, data, opts) {\n      if (root.FCL_REGISTRY[addr]) _send(addr, tag, data, opts);\n    },\n    broadcast: function broadcast(tag, data, opts) {\n      if (opts === void 0) {\n        opts = {};\n      }\n\n      opts.from = addr;\n\n      for (var _iterator = _createForOfIteratorHelperLoose(root.FCL_REGISTRY[addr].subs), _step; !(_step = _iterator()).done;) {\n        var to = _step.value;\n\n        _send(to, tag, data, opts);\n      }\n    },\n    subscribe: function subscribe(sub) {\n      return sub != null && root.FCL_REGISTRY[addr].subs.add(sub);\n    },\n    unsubscribe: function unsubscribe(sub) {\n      return sub != null && root.FCL_REGISTRY[addr].subs[\"delete\"](sub);\n    },\n    subscriberCount: function subscriberCount() {\n      return root.FCL_REGISTRY[addr].subs.size;\n    },\n    hasSubs: function hasSubs() {\n      return !!root.FCL_REGISTRY[addr].subs.size;\n    },\n    put: function put(key, value) {\n      if (key != null) root.FCL_REGISTRY[addr].kvs[key] = value;\n    },\n    get: function get(key, fallback) {\n      var value = root.FCL_REGISTRY[addr].kvs[key];\n      return value == null ? fallback : value;\n    },\n    \"delete\": function _delete(key) {\n      delete root.FCL_REGISTRY[addr].kvs[key];\n    },\n    update: function update(key, fn) {\n      if (key != null) root.FCL_REGISTRY[addr].kvs[key] = fn(root.FCL_REGISTRY[addr].kvs[key]);\n    },\n    keys: function keys() {\n      return Object.keys(root.FCL_REGISTRY[addr].kvs);\n    },\n    all: function all() {\n      return root.FCL_REGISTRY[addr].kvs;\n    },\n    where: function where(pattern) {\n      return Object.keys(root.FCL_REGISTRY[addr].kvs).reduce(function (acc, key) {\n        var _extends2;\n\n        return pattern.test(key) ? _extends({}, acc, (_extends2 = {}, _extends2[key] = root.FCL_REGISTRY[addr].kvs[key], _extends2)) : acc;\n      }, {});\n    },\n    merge: function merge(data) {\n      if (data === void 0) {\n        data = {};\n      }\n\n      Object.keys(data).forEach(function (key) {\n        return root.FCL_REGISTRY[addr].kvs[key] = data[key];\n      });\n    }\n  };\n  if (typeof fn === \"object\") fn = fromHandlers(fn);\n  queueMicrotask_1(function () {\n    try {\n      return Promise.resolve(fn(ctx)).then(function () {\n        kill(addr);\n      });\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n  return addr;\n};\n\nfunction subscriber(address, spawnFn, callback) {\n  spawnFn(address);\n  var EXIT = \"@EXIT\";\n  var self = spawn(function (ctx) {\n    try {\n      var _exit2;\n\n      ctx.send(address, SUBSCRIBE);\n      return Promise.resolve(_for(function () {\n        return !_exit2 && 1;\n      }, void 0, function () {\n        return Promise.resolve(ctx.receive()).then(function (letter) {\n          if (letter.tag === EXIT) {\n            ctx.send(address, UNSUBSCRIBE);\n            _exit2 = 1;\n            return;\n          }\n\n          callback(letter.data);\n        });\n      }));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n  return function () {\n    return _send(self, EXIT);\n  };\n}\n\nfunction _extends$1() {\n  _extends$1 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends$1.apply(this, arguments);\n}\n\nvar _iteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\")) : \"@@iterator\";\n\nvar _asyncIteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\")) : \"@@asyncIterator\";\n\nfunction _catch$1(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n\n  return result;\n}\n\nvar _HANDLERS;\n\nvar first = function first(wants, fallback) {\n  if (wants === void 0) {\n    wants = [];\n  }\n\n  try {\n    if (!wants.length) return Promise.resolve(fallback);\n\n    var _wants = wants,\n        head = _wants[0],\n        rest = _wants.slice(1);\n\n    return Promise.resolve(get(head)).then(function (ret) {\n      return ret == null ? first(rest, fallback) : ret;\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nvar NAME = \"config\";\nvar PUT = \"PUT_CONFIG\";\nvar GET = \"GET_CONFIG\";\nvar GET_ALL = \"GET_ALL_CONFIG\";\nvar UPDATE = \"UPDATE_CONFIG\";\nvar DELETE = \"DELETE_CONFIG\";\nvar CLEAR = \"CLEAR_CONFIG\";\nvar WHERE = \"WHERE_CONFIG\";\nvar UPDATED = \"CONFIG/UPDATED\";\n\nvar identity = function identity(v) {\n  return v;\n};\n\nvar HANDLERS = (_HANDLERS = {}, _HANDLERS[PUT] = function (ctx, _letter, _ref) {\n  var key = _ref.key,\n      value = _ref.value;\n  if (key == null) throw new Error(\"Missing 'key' for config/put.\");\n  ctx.put(key, value);\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[GET] = function (ctx, letter, _ref2) {\n  var key = _ref2.key,\n      fallback = _ref2.fallback;\n  if (key == null) throw new Error(\"Missing 'key' for config/get\");\n  letter.reply(ctx.get(key, fallback));\n}, _HANDLERS[GET_ALL] = function (ctx, letter) {\n  letter.reply(_extends$1({}, ctx.all()));\n}, _HANDLERS[UPDATE] = function (ctx, letter, _ref3) {\n  var key = _ref3.key,\n      fn = _ref3.fn;\n  if (key == null) throw new Error(\"Missing 'key' for config/update\");\n  ctx.update(key, fn || identity);\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[DELETE] = function (ctx, letter, _ref4) {\n  var key = _ref4.key;\n  if (key == null) throw new Error(\"Missing 'key' for config/delete\");\n  ctx[\"delete\"](key);\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[CLEAR] = function (ctx, letter) {\n  var keys = Object.keys(ctx.all());\n\n  for (var _i = 0, _keys = keys; _i < _keys.length; _i++) {\n    var key = _keys[_i];\n    ctx[\"delete\"](key);\n  }\n\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[WHERE] = function (ctx, letter, _ref5) {\n  var pattern = _ref5.pattern;\n  if (pattern == null) throw new Error(\"Missing 'pattern' for config/where\");\n  letter.reply(ctx.where(pattern));\n}, _HANDLERS[SUBSCRIBE] = function (ctx, letter) {\n  ctx.subscribe(letter.from);\n  ctx.send(letter.from, UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[UNSUBSCRIBE] = function (ctx, letter) {\n  ctx.unsubscribe(letter.from);\n}, _HANDLERS);\nspawn(HANDLERS, NAME);\n\nfunction put(key, value) {\n  _send(NAME, PUT, {\n    key: key,\n    value: value\n  });\n  return config();\n}\n\nfunction get(key, fallback) {\n  return _send(NAME, GET, {\n    key: key,\n    fallback: fallback\n  }, {\n    expectReply: true,\n    timeout: 10\n  });\n}\n\nfunction all() {\n  return _send(NAME, GET_ALL, null, {\n    expectReply: true,\n    timeout: 10\n  });\n}\n\nfunction update(key, fn) {\n  if (fn === void 0) {\n    fn = identity;\n  }\n\n  _send(NAME, UPDATE, {\n    key: key,\n    fn: fn\n  });\n  return config();\n}\n\nfunction _delete(key) {\n  _send(NAME, DELETE, {\n    key: key\n  });\n  return config();\n}\n\nfunction where(pattern) {\n  return _send(NAME, WHERE, {\n    pattern: pattern\n  }, {\n    expectReply: true,\n    timeout: 10\n  });\n}\n\nfunction subscribe(callback) {\n  return subscriber(NAME, function () {\n    return spawn(HANDLERS, NAME);\n  }, callback);\n}\n\nfunction clearConfig() {\n  return _send(NAME, CLEAR);\n}\n\nfunction config(values) {\n  if (values != null && typeof values === \"object\") {\n    Object.keys(values).map(function (d) {\n      return put(d, values[d]);\n    });\n  }\n\n  return {\n    put: put,\n    get: get,\n    all: all,\n    first: first,\n    update: update,\n    \"delete\": _delete,\n    where: where,\n    subscribe: subscribe,\n    overload: overload\n  };\n}\n\nconfig.put = put;\nconfig.get = get;\nconfig.all = all;\nconfig.first = first;\nconfig.update = update;\nconfig[\"delete\"] = _delete;\nconfig.where = where;\nconfig.subscribe = subscribe;\nconfig.overload = overload;\n\nvar noop = function noop(v) {\n  return v;\n};\n\nfunction overload(opts, callback) {\n  if (opts === void 0) {\n    opts = {};\n  }\n\n  if (callback === void 0) {\n    callback = noop;\n  }\n\n  return new Promise(function (resolve, reject) {\n    try {\n      return Promise.resolve(all()).then(function (oldConfig) {\n        var _temp = _catch$1(function () {\n          config(opts);\n          var _callback = callback;\n          return Promise.resolve(all()).then(function (_all) {\n            return Promise.resolve(_callback(_all)).then(function (result) {\n              return Promise.resolve(clearConfig()).then(function () {\n                return Promise.resolve(config(oldConfig)).then(function () {\n                  resolve(result);\n                });\n              });\n            });\n          });\n        }, function (error) {\n          return Promise.resolve(clearConfig()).then(function () {\n            return Promise.resolve(config(oldConfig)).then(function () {\n              reject(error);\n            });\n          });\n        });\n\n        if (_temp && _temp.then) return _temp.then(function () {});\n      });\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n}\n\nvar LEVELS = Object.freeze({\n  \"debug\": 5,\n  \"info\": 4,\n  \"log\": 3,\n  \"warn\": 2,\n  \"error\": 1\n});\n\nvar buildLoggerMessageArgs = function buildLoggerMessageArgs(_ref) {\n  var title = _ref.title,\n      message = _ref.message;\n  return [\"\\n    %c\" + title + \"\\n    ============================\\n    \" + message + \"\\n    ============================\\n    \", \"font-weight:bold;font-family:monospace;\"];\n};\n\nvar log = function log(_ref2) {\n  var title = _ref2.title,\n      message = _ref2.message,\n      level = _ref2.level,\n      _ref2$always = _ref2.always,\n      always = _ref2$always === void 0 ? false : _ref2$always;\n\n  try {\n    return Promise.resolve(config.get(\"logger.level\", 0)).then(function (configLoggerLevel) {\n      var _console, _console2, _console3, _console4, _console5;\n\n      if (!always && configLoggerLevel < level) return;\n      var loggerMessageArgs = buildLoggerMessageArgs({\n        title: title,\n        message: message\n      });\n\n      switch (level) {\n        case LEVELS.debug:\n          (_console = console).debug.apply(_console, loggerMessageArgs);\n\n          break;\n\n        case LEVELS.info:\n          (_console2 = console).info.apply(_console2, loggerMessageArgs);\n\n          break;\n\n        case LEVELS.warn:\n          (_console3 = console).warn.apply(_console3, loggerMessageArgs);\n\n          break;\n\n        case LEVELS.error:\n          (_console4 = console).error.apply(_console4, loggerMessageArgs);\n\n          break;\n\n        default:\n          (_console5 = console).log.apply(_console5, loggerMessageArgs);\n\n      }\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nexport { LEVELS, log };\n//# sourceMappingURL=util-logger.module.js.map\n","import * as logger from \"@onflow/util-logger\"\n\nexport const deprecate = async ({title, message, level, always}) => {\n  await logger.log({title, message, level, always})\n}\n","import {verifyUserSignatures as verify} from \"../app-utils\"\nimport {deprecate} from \"../utils/deprecate\"\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @deprecated since version '1.0.0-alpha.0', use AppUtils.verifyUserSignatures instead\n *\n */\nexport async function verifyUserSignatures(message, compSigs) {\n  deprecate({\n    title: \"FCL Deprecation Notice\",\n    message: `\n    fcl.verifyUserSignatures() is deprecated and will be removed in a future release\n    Please use fcl.AppUtils.verifyUserSignatures()`,\n    level: 2,\n    always: true,\n  })\n  return verify(message, compSigs)\n}\n","import {interaction, pipe} from \"@onflow/sdk\"\nimport {resolve as defaultResolve} from \"@onflow/sdk\"\nimport {config, createSignableVoucher} from \"@onflow/sdk\"\n\nexport const serialize = async (args = [], opts = {}) => {\n  const resolveFunction = await config.first(\n    [\"sdk.resolve\"],\n    opts.resolve || defaultResolve\n  )\n\n  if (Array.isArray(args)) args = await pipe(interaction(), args)\n\n  return JSON.stringify(\n    createSignableVoucher(await resolveFunction(args)),\n    null,\n    2\n  )\n}\n","import {spawn, subscriber, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {\n  config,\n  block,\n  getEventsAtBlockHeightRange,\n  send,\n  decode\n} from \"@onflow/sdk\"\n\nconst RATE = 10000\nconst UPDATED = \"UPDATED\"\nconst TICK = \"TICK\"\nconst HIGH_WATER_MARK = \"hwm\"\n\nconst scheduleTick = async ctx => {\n  return setTimeout(\n    () => ctx.sendSelf(TICK),\n    await config().get(\"fcl.eventPollRate\", RATE)\n  )\n}\n\nconst HANDLERS = {\n  [TICK]: async ctx => {\n    if (!ctx.hasSubs()) return\n    let hwm = ctx.get(HIGH_WATER_MARK)\n    if (hwm == null) {\n      ctx.put(HIGH_WATER_MARK, await block())\n      ctx.put(TICK, await scheduleTick(ctx))\n    } else {\n      let next = await block()\n      ctx.put(HIGH_WATER_MARK, next)\n      const data = await send([\n        getEventsAtBlockHeightRange(ctx.self(), hwm.height, next.height - 1),\n      ]).then(decode)\n      for (let d of data) ctx.broadcast(UPDATED, d.data)\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n  },\n  [SUBSCRIBE]: async (ctx, letter) => {\n    if (!ctx.hasSubs()) {\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n    ctx.subscribe(letter.from)\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n    if (!ctx.hasSubs()) {\n      clearTimeout(ctx.get(TICK))\n      ctx.delete(TICK)\n      ctx.delete(HIGH_WATER_MARK)\n    }\n  },\n}\n\nconst spawnEvents = key => spawn(HANDLERS, key)\n\nexport function events(key) {\n  return {\n    subscribe: callback => subscriber(key, spawnEvents, callback),\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {VERSION} from \"../VERSION\"\n\nconst asyncPipe = (...fns) => input => fns.reduce((chain, fn) => chain.then(fn), Promise.resolve(input))\n\nasync function addServices(services = []) {\n  const endpoint = await config.get(\"discovery.authn.endpoint\")\n  invariant(Boolean(endpoint), `\"discovery.authn.endpoint\" in config must be defined.`)\n\n  const include = await config.get(\"discovery.authn.include\", [])\n  const url = new URL(endpoint)\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      fclVersion: VERSION,\n      include\n    })\n  }).then(d => d.json())\n  .then(json => [...services, ...json])\n}\n\nfunction addExtensions(services = []) {\n  const extensions = window.fcl_extensions || []\n  return [...extensions, ...services]\n}\n\nfunction filterServicesByType(services = [], type) {\n  return services.filter(service => service.type === type)\n}\n\nexport const getServices = ({ type }) => asyncPipe(\n  addServices,\n  addExtensions,\n  s => filterServicesByType(s, type)\n)([])","import {spawn, subscriber, snapshoter, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {getServices} from \"../services\"\n\nconst NAME = \"authn\"\nconst RESULTS = \"results\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst UPDATED = \"UPDATED\"\n\nconst warn = (fact, msg) => {\n  if (fact) {\n    console.warn(\n      `\n      %cFCL Warning\n      ============================\n      ${msg}\n      For more info, please see the docs: https://docs.onflow.org/fcl/\n      ============================\n      `,\n      \"font-weight:bold;font-family:monospace;\"\n    )\n  }\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    warn(typeof window === \"undefined\", '\"fcl.discovery\" is only available in the browser.')\n    const services = await getServices({ type: NAME })\n    ctx.put(RESULTS, services)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => ctx.unsubscribe(letter.from),\n  [SNAPSHOT]: async (ctx, letter) => letter.reply({...ctx.all()}),\n}\n\nconst spawnProviders = () => spawn(HANDLERS, NAME)\n\nconst authn = {\n  subscribe: cb => subscriber(NAME, spawnProviders, cb),\n  snapshot: () => snapshoter(NAME, spawnProviders)\n}\n\nexport default authn\n","import authn from \"./services/authn\"\n\nconst discovery = {\n  authn\n}\n\nexport {discovery}","import \"./default-config\"\nexport {VERSION} from \"./VERSION\"\nexport {query} from \"./exec/query\"\nexport {mutate} from \"./exec/mutate\"\nexport {verifyUserSignatures} from \"./exec/verify\"\nexport {serialize} from \"./serialize\"\nexport {transaction as tx} from \"./transaction\"\nexport {events} from \"./events\"\n\nimport {currentUser} from \"./current-user\"\nexport {currentUser}\n\nimport {discovery} from \"./discovery\"\nexport {discovery}\n\nexport const authenticate = (opts = {}) => currentUser().authenticate(opts)\nexport const unauthenticate = () => currentUser().unauthenticate()\nexport const reauthenticate = (opts = {}) => {\n  currentUser().unauthenticate()\n  return currentUser().authenticate(opts)\n}\nexport const signUp = (opts = {}) => currentUser().authenticate(opts)\nexport const logIn = (opts = {}) => currentUser().authenticate(opts)\n\nexport const authz = currentUser().authorization\n\nimport * as types from \"@onflow/types\"\nexport const t = types\n\nimport * as WalletUtils from \"./wallet-utils\"\nexport {WalletUtils}\n\nimport * as AppUtils from \"./app-utils\"\nexport {AppUtils}\n\nexport {TestUtils} from \"@onflow/sdk\"\nexport {config} from \"@onflow/config\"\nexport {send} from \"@onflow/sdk\"\nexport {decode} from \"@onflow/sdk\"\nexport {account} from \"@onflow/sdk\"\nexport {block} from \"@onflow/sdk\"\nexport {isOk, isBad, why, pipe, build} from \"@onflow/sdk\"\nexport {withPrefix, sansPrefix, display} from \"@onflow/util-address\"\nexport {template as cadence} from \"@onflow/util-template\"\nexport {template as cdc} from \"@onflow/util-template\"\nexport {createSignableVoucher} from \"@onflow/sdk\"\nexport {voucherIntercept} from \"@onflow/sdk\"\nexport {voucherToTxId} from \"@onflow/sdk\"\n\n// builders\nexport {transaction} from \"@onflow/sdk\"\nexport {script} from \"@onflow/sdk\"\nexport {ping} from \"@onflow/sdk\"\nexport {atBlockHeight} from \"@onflow/sdk\"\nexport {atBlockId} from \"@onflow/sdk\"\nexport {getAccount} from \"@onflow/sdk\"\nexport {getEvents} from \"@onflow/sdk\"\nexport {getEventsAtBlockHeightRange} from \"@onflow/sdk\"\nexport {getEventsAtBlockIds} from \"@onflow/sdk\"\nexport {getBlock} from \"@onflow/sdk\"\nexport {getBlockHeader} from \"@onflow/sdk\"\nexport {getCollection} from \"@onflow/sdk\"\nexport {getTransactionStatus} from \"@onflow/sdk\"\nexport {getTransaction} from \"@onflow/sdk\"\nexport {authorizations, authorization} from \"@onflow/sdk\"\nexport {args, arg} from \"@onflow/sdk\"\nexport {proposer} from \"@onflow/sdk\"\nexport {payer} from \"@onflow/sdk\"\nexport {limit} from \"@onflow/sdk\"\nexport {ref} from \"@onflow/sdk\"\nexport {params, param} from \"@onflow/sdk\"\nexport {validator} from \"@onflow/sdk\"\nexport {invariant} from \"@onflow/sdk\"\n"],"names":["VERSION","getDiscoveryService","config","first","discoveryWallet","get","discoveryAuthnInclude","discoveryWalletMethod","type","endpoint","method","configLens","regex","where","Object","fromEntries","entries","map","key","value","replace","isServerSide","window","SESSION_STORAGE","can","JSON","parse","sessionStorage","getItem","put","setItem","stringify","STORAGE_DEFAULT","DISCOVERY_METHOD","is","d","isRequired","isObject","isString","isFunc","isNumber","normalizeArgs","ax","sdk","arg","t","preQuery","opts","invariant","cadence","query","send","script","args","limit","then","decode","fetchServices","servicesURL","code","url","URL","searchParams","append","fetch","headers","json","resp","Array","isArray","services","authorizations","service","push","keyId","provider","id","mergeServices","sx1","sx2","SERVICE_PRAGMA","f_type","f_vsn","IDENTITY_PRAGMA","USER_PRAGMA","POLLING_RESPONSE_PRAGMA","COMPOSITE_SIGNATURE_PRAGMA","normalizeAuthn","uid","authn","pid","address","withPrefix","addr","name","icon","normalizeAuthz","identity","params","data","normalizePreAuthz","normalizeFrame","old","normalizeBackChannelRpc","normalizeOpenId","normalizeUserSignature","Error","normalizeLocalView","normalizeAccountProof","normalizeAuthnRefresh","serviceNormalizers","authz","frame","normalizeService","normalized","error","console","deriveCompositeId","rlp","encode","toString","normalizeData","paddr","findService","find","buildUser","hks","cid","loggedIn","expiresAt","expires","serviceOfType","serviceEndpoint","location","origin","fetchService","body","undefined","normalizePollingResponse","status","reason","compositeSignature","updates","authorizationUpdates","local","poll","canContinue","serviceMethod","Promise","r","setTimeout","OPTIONS","FRAME","FRAME_STYLES","renderFrame","src","document","getElementById","$frame","createElement","allow","frameBorder","style","cssText","unmount","remove","contentWindow","POP","popup","previousUrl","popupWindow","windowName","win","w","h","y","top","outerHeight","screenY","x","outerWidth","screenX","open","renderPop","closed","focus","close","tab","renderTab","execLocal","VIEWS","execHttpPost","signable","fclVersion","_","serviceResponse","CLOSE_EVENT","READY_EVENT","RESPONSE_EVENT","e","toLowerCase","IGNORE","Set","deprecate","was","want","warn","buildMessageHandler","onReady","onResponse","onMessage","has","noop","onClose","addEventListener","removeEventListener","msg","postMessage","execIframeRPC","resolve","reject","includeOlderJsonRpcCall","deprecated","message","jsonrpc","result","pop","$pop","timer","setInterval","clearInterval","execPopRPC","redir","$tab","execTabRPC","extension","execExtRPC","recover","execService","fullConfig","app","client","fclLibrary","hostname","extensions","fcl_extensions","STRATEGIES","res","normalizeCompositeSignature","sansPrefix","signature","sig","pact","state","s","v","o","_settle","bind","observer","signUserMessage","spawnCurrentUser","authenticate","user","signingService","makeSignable","response","compSigs","_Pact","prototype","onFulfilled","onRejected","callback","_this","_isSettledPact","thenable","_for","test","update","stage","shouldContinue","updateValue","_resumeAfterTest","_resumeAfterBody","_resumeAfterUpdate","resolveArgument","Address","_catch","_finally","finalizer","authorization","account","tempId","preSignable","sequenceNum","signingFunction","preAuthz","resolvePreAuthz","_finallyRethrows","snapshot","discoveryService","accountProofData","NAME","SET_CURRENT_USER","refreshService","getAccountProofData","accountProofDataResolver","appIdentifier","nonce","UPDATED","SNAPSHOT","DEL_CURRENT_USER","DATA","getStoredUser","storage","fallback","stored","removeItem","HANDLERS","INIT","ctx","merge","notExpired","SUBSCRIBE","letter","subscribe","from","all","UNSUBSCRIBE","unsubscribe","reply","broadcast","spawn","Date","now","unauthenticate","normalizePreAuthzResponse","proposer","payer","axs","az","role","join","authorizer","EXIT","self","receive","tag","expectReply","timeout","currentUser","RATE","POLL","fetchTxStatus","transactionId","fclSend","getTransactionStatus","isExpired","tx","isSealed","isExecuted","isFinalized","isPending","isUnknown","isDiff","cur","next","sendSelf","scoped","spawnTransaction","transaction","snapshoter","subscriber","once","predicate","innerOnce","suppress","unsub","txStatus","statusCode","errorMessage","onceFinalized","onceExecuted","onceSealed","prepMutation","mutate","txid","onMessageFromFCL","messageType","cb","buildData","interaction","internal","sendMsgToFCL","parent","opener","ready","approve","decline","redirect","CompositeSignature","Number","rightPaddedHexBuffer","pad","Buffer","padEnd","leftPaddedHexBuffer","padStart","addressBuffer","nonceBuffer","encodeAccountProof","includeDomainTag","length","ACCOUNT_PROOF_DOMAIN_TAG","concat","rlpEncode","injectExtService","verifyUserSignatures","validateArgs","signaturesArr","keyIndices","el","getVerifySignaturesScript","USER_SIGNATURE","String","Int","verifyAccountProof","signatures","ACCOUNT_PROOF","every","i","arr","cs","verifyFunction","network","fclCryptoContract","promise","title","level","always","logger","verify","serialize","defaultResolve","resolveFunction","createSignableVoucher","pipe","TICK","HIGH_WATER_MARK","scheduleTick","hasSubs","hwm","block","getEventsAtBlockHeightRange","height","clearTimeout","spawnEvents","events","addServices","Boolean","include","asyncPipe","input","reduce","chain","fn","addExtensions","filterServicesByType","filter","getServices","RESULTS","fact","spawnProviders","discovery","reauthenticate","signUp","logIn","types"],"mappings":"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"}
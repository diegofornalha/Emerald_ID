{"version":3,"file":"fcl.modern.js","sources":["../src/VERSION.js","../src/config-utils.js","../src/default-config.js","../src/exec/utils/is.js","../src/exec/utils/normalize-args.js","../src/exec/query.js","../src/current-user/fetch-services.js","../src/current-user/merge-services.js","../src/current-user/normalize/__vsn.js","../src/current-user/normalize/authn.js","../src/current-user/normalize/authz.js","../src/current-user/normalize/pre-authz.js","../src/current-user/normalize/frame.js","../src/current-user/normalize/back-channel-rpc.js","../src/current-user/normalize/open-id.js","../src/current-user/normalize/user-signature.js","../src/current-user/normalize/local-view.js","../src/current-user/normalize/account-proof.js","../src/current-user/normalize/authn-refresh.js","../src/current-user/normalize/service.js","../src/current-user/build-user.js","../src/current-user/service-of-type.js","../src/current-user/exec-service/strategies/utils/service-endpoint.js","../src/current-user/exec-service/strategies/utils/fetch-service.js","../src/current-user/normalize/polling-response.js","../src/current-user/exec-service/strategies/utils/poll.js","../src/current-user/exec-service/strategies/utils/render-frame.js","../src/current-user/exec-service/strategies/utils/render-pop.js","../src/current-user/exec-service/strategies/utils/render-tab.js","../src/current-user/exec-service/exec-local.js","../src/current-user/exec-service/strategies/http-post.js","../src/current-user/exec-service/strategies/utils/buildMessageHandler.js","../src/current-user/exec-service/strategies/utils/frame.js","../src/current-user/exec-service/strategies/iframe-rpc.js","../src/current-user/exec-service/strategies/utils/pop.js","../src/current-user/exec-service/strategies/pop-rpc.js","../src/current-user/exec-service/strategies/utils/tab.js","../src/current-user/exec-service/strategies/tab-rpc.js","../src/current-user/exec-service/strategies/utils/extension.js","../src/current-user/exec-service/strategies/ext-rpc.js","../src/current-user/exec-service/index.js","../src/current-user/normalize/composite-signature.js","../src/current-user/index.js","../src/transaction/index.js","../src/exec/mutate.js","../src/wallet-utils/on-message-from-fcl.js","../src/wallet-utils/send-msg-to-fcl.js","../src/wallet-utils/CompositeSignature.js","../src/wallet-utils/encode-account-proof.js","../src/wallet-utils/inject-ext-service.js","../src/app-utils/verify-signatures.js","../../util-logger/dist/util-logger.module.js","../src/utils/deprecate.js","../src/exec/verify.js","../src/serialize/index.js","../src/events/index.js","../src/discovery/services.js","../src/discovery/services/authn.js","../src/discovery/index.js","../src/fcl.js"],"sourcesContent":["export const VERSION = MICROBUNDLE_CURRENT_VERSION || \"TESTVERSION\"\n","import {config} from \"@onflow/config\"\nimport {VERSION} from \"./VERSION\"\n\nconst isServerSide = () => typeof window === \"undefined\"\n\nconst SESSION_STORAGE = {\n  can: !isServerSide(),\n  get: async key => JSON.parse(sessionStorage.getItem(key)),\n  put: async (key, value) => sessionStorage.setItem(key, JSON.stringify(value)),\n}\n\nconst LOCAL_STORAGE = {\n  can: !isServerSide(),\n  get: async key => JSON.parse(localStorage.getItem(key)),\n  put: async (key, value) => localStorage.setItem(key, JSON.stringify(value)),\n}\n\nconst NO_STORAGE = {\n  can: false,\n}\n\nexport const STORAGE_DEFAULT = SESSION_STORAGE\nexport const DISCOVERY_METHOD = \"IFRAME/RPC\"\n\nexport async function configLens(regex) {\n  return Object.fromEntries(\n    Object.entries(await config().where(regex)).map(([key, value]) => [\n      key.replace(regex, \"\"),\n      value,\n    ])\n  )\n}\n\nexport async function getDiscoveryService() {\n  const discoveryWallet = await config.first([\n    \"discovery.wallet\",\n    \"challenge.handshake\",\n  ])\n\n  const discoveryAuthnInclude = await config.get(\"discovery.authn.include\", [])\n\n  const discoveryWalletMethod = await config.first([\n    \"discovery.wallet.method\",\n    \"discovery.wallet.method.default\",\n  ])\n\n  return {\n    type: \"authn\",\n    endpoint: discoveryWallet,\n    method: discoveryWalletMethod,\n    discoveryAuthnInclude\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {DISCOVERY_METHOD, STORAGE_DEFAULT} from \"./config-utils\"\n\nconfig({\n  \"discovery.wallet.method.default\": DISCOVERY_METHOD,\n  \"fcl.storage.default\": STORAGE_DEFAULT,\n})\n","const is = type => d => typeof d === type\n\nexport const isRequired = d => d != null\nexport const isObject = is(\"object\")\nexport const isString = is(\"string\")\nexport const isFunc = is(\"function\")\nexport const isNumber = is(\"number\")\n","import {isFunc} from \"./is\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\n\nexport function normalizeArgs(ax) {\n  if (isFunc(ax)) return ax(sdk.arg, t)\n  return []\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\nimport {isRequired, isObject, isString, isFunc} from \"./utils/is\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\n\n/** Query the Flow Blockchain\n *\n *  @arg {Object} opts         - Query Options and configuration\n *  @arg {string} opts.cadence - Cadence Script used to query Flow\n *  @arg {ArgsFn} opts.args    - Arguments passed to cadence script\n *  @arg {number} opts.limit   - Compute Limit for Query\n *  @returns {Promise<Response>}\n *\n *  Where:\n *    @callback ArgsFn\n *    @arg {ArgFn}  arg - Argument function to define a single argument\n *    @arg {Object} t   - Cadence Types object used to define the type\n *    @returns {args[]}\n *\n *    @callback ArgFn\n *    @arg {Any}  value - the value of the argument\n *    @arg {Type} type  - the cadence type of the value\n *    @returns {arg}\n *\n *  Example:\n *    const cadence = `\n *      cadence: `\n *        pub fun main(a: Int, b: Int, c: Address): Int {\n *          log(c)\n *          return a + b\n *        }\n *    `.trim()\n *\n *    const args = (arg, t) => [\n *      arg(5, t.Int),\n *      arg(7, t.Int),\n *      arg(\"0xb2db43ad6bc345fec9\", t.Address),\n *    ]\n *\n *    await query({ cadence, args })\n */\nexport async function query(opts = {}) {\n  await preQuery(opts)\n\n  // prettier-ignore\n  return sdk.send([\n    sdk.script(opts.cadence),\n    sdk.args(normalizeArgs(opts.args || [])),\n    opts.limit && typeof opts.limit === \"number\" && sdk.limit(opts.limit)\n  ]).then(sdk.decode)\n}\n\nasync function preQuery(opts) {\n  invariant(\n    isRequired(opts.cadence),\n    \"query({ cadence }) -- cadence is required\"\n  )\n\n  invariant(\n    isString(opts.cadence),\n    \"query({ cadence }) -- cadence must be a string\"\n  )\n\n  invariant(\n    await sdk.config.get(\"accessNode.api\"),\n    `Required value for \"accessNode.api\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`\n  )\n}\n","export async function fetchServices(servicesURL, code) {\n  if (servicesURL == null || code == null) return []\n\n  const url = new URL(servicesURL)\n  url.searchParams.append(\"code\", code)\n\n  const resp = await fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  }).then(d => d.json())\n\n  if (Array.isArray(resp)) return resp\n\n  // Backwards compatibility for First-Gen Wallet Providers\n  const services = []\n\n  // Convert authorizations into authz services\n  if (Array.isArray(resp.authorizations)) {\n    for (let service of resp.authorizations) {\n      services.push({\n        type: \"authz\",\n        keyId: resp.keyId,\n        ...service,\n      })\n    }\n  }\n\n  // Convert Provider info into an authn service\n  if (resp.provider != null) {\n    services.push({\n      type: \"authn\",\n      id: \"wallet-provider#authn\",\n      ...resp.provider,\n    })\n  }\n\n  return services\n}\n","import {withPrefix} from \"@onflow/util-address\"\n\nexport function mergeServices(sx1 = [], sx2 = []) {\n  // TODO: Make this smarter\n  return [...sx1, ...sx2]\n}\n","export const SERVICE_PRAGMA = {\n  f_type: \"Service\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const IDENTITY_PRAGMA = {\n  f_type: \"Identity\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const PROVIDER_PRAGMA = {\n  f_type: \"Provider\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const USER_PRAGMA = {\n  f_type: \"USER\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const POLLING_RESPONSE_PRAGMA = {\n  f_type: \"PollingResponse\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const COMPOSITE_SIGNATURE_PRAGMA = {\n  f_type: \"CompositeSignature\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const OPEN_ID_PRAGMA = {\n  f_type: \"OpenId\",\n  f_vsn: \"1.0.0\",\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"identity\": {\n//     \"address\": \"0x____\"\n//   },\n//   \"provider\": {\n//     \"address\": \"0x____\",\n//     \"name\": \"Best Wallet\",\n//     \"description\": \"The Best Wallet\"\n//     \"icon\": \"https://\",\n//   }\n// }\nexport function normalizeAuthn(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.authn,\n        id: service.pid,\n        provider: {\n          address: withPrefix(service.addr),\n          name: service.name,\n          icon: service.icon,\n        },\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"pre-authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of pre-authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizePreAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"frame\",\n//    \"endpoint\": \"https://rawr\",\n//    \"data\": {},   // Sent to frame when ready\n//    \"params\": {}, // include in query params on frame\n// }\nexport function normalizeFrame(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        old: service,\n        ...SERVICE_PRAGMA,\n        type: \"frame\",\n        endpoint: service.endpoint,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"back-channel-rpc\",\n//    \"endpoint\": \"https://rawr\",\n//    \"method\": \"HTTP/GET\", // HTTP/GET | HTTP/POST\n//    \"data\": {},           // included in body of rpc\n//    \"params\": {},         // included as query params on endpoint url\n// }\nexport function normalizeBackChannelRpc(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: \"back-channel-rpc\",\n        endpoint: service.endpoint,\n        method: service.method,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {SERVICE_PRAGMA, OPEN_ID_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"open-id\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"method: \"data\",\n//   \"data\": {\n//      \"profile\": {\n//        \"name\": \"Bob\",\n//        \"family_name\": \"Builder\",\n//        \"given_name\": \"Robert\",\n//        \"middle_name\": \"the\",\n//        \"nickname\": \"Bob the Builder\",\n//        \"perferred_username\": \"bob\",\n//        \"profile\": \"https://www.bobthebuilder.com/\",\n//        \"picture\": \"https://avatars.onflow.org/avatar/bob\",\n//        \"gender\": \"...\",\n//        \"birthday\": \"2001-01-18\",\n//        \"zoneinfo\": \"America/Vancouver\",\n//        \"locale\": \"en-us\",\n//        \"updated_at\": \"1614970797388\"\n//      },\n//      \"email\": {\n//        \"email\": \"bob@bob.bob\",\n//        \"email_verified\": true\n//      },\n//      \"address\": {\n//        \"address\": \"One Apple Park Way, Cupertino, CA 95014, USA\"\n//      },\n//      \"phone\": {\n//        \"phone_number\": \"+1 (xxx) yyy-zzzz\",\n//        \"phone_number_verified\": true\n//      },\n//      \"social\": {\n//        \"twitter\": \"@_qvvg\",\n//        \"twitter_verified\": true\n//      },\n//   }\n// }\nexport function normalizeOpenId(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"user-signature\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"IFRAME/RPC\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of user-signature request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeUserSignature(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(\"Invalid user-signature service\")\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    type: \"local-view\",\n//    method: \"VIEW/IFRAME\",\n//    endpoint: \"https://woot.org/authz/local\",\n//    data: {},\n//    params: {},\n// }\nexport function normalizeLocalView(resp) {\n  if (resp == null) return null\n  if (resp.method == null) {\n    resp = {...resp, type: \"local-view\", method: \"VIEW/IFRAME\"}\n  }\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: resp.type || \"local-view\",\n        method: resp.method,\n        endpoint: resp.endpoint,\n        data: resp.data || {},\n        params: resp.params || {},\n      }\n  }\n}\n","// {\n//   \"f_type\": \"Service\",                    // Its a service!\n//   \"f_vsn\": \"1.0.0\",                       // Follows the v1.0.0 spec for the service\n//   \"type\": \"account-proof\",                // the type of service it is\n//   \"method\": \"DATA\",                       // Its data!\n//   \"uid\": \"awesome-wallet#account-proof\",  // A unique identifier for the service\n//   \"data\": {\n//     \"f_type\": \"account-proof\",\n//     \"f_vsn\": \"1.0.0\",\n//     \"nonce\": \"0A1BC2FF\",                  // Nonce signed by the current account-proof (minimum 32 bytes in total, i.e 64 hex characters)\n//     \"address\": \"0xUSER\",                  // The user's address (8 bytes, i.e 16 hex characters)\n//     \"signature\": CompositeSignature,      // address (sans-prefix), keyId, signature (hex)\n// }\n\nexport function normalizeAccountProof(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(`FCL Normalizer Error: Invalid account-proof service`)\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn-refresh\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\",  // \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthnRefresh(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(\"Invalid authn-refresh service\")\n  }\n}\n","import {normalizeAuthn} from \"./authn\"\nimport {normalizeAuthz} from \"./authz\"\nimport {normalizePreAuthz} from \"./pre-authz\"\nimport {normalizeFrame} from \"./frame\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeOpenId} from \"./open-id\"\nimport {normalizeUserSignature} from \"./user-signature\"\nimport {normalizeLocalView} from \"./local-view\"\nimport {normalizeAccountProof} from \"./account-proof\"\nimport {normalizeAuthnRefresh} from \"./authn-refresh\"\n\nexport function normalizeServices(services, data) {\n  return services.map(service => normalizeService(service, data))\n}\n\nconst serviceNormalizers = {\n  \"back-channel-rpc\": normalizeBackChannelRpc,\n  \"pre-authz\": normalizePreAuthz,\n  authz: normalizeAuthz,\n  authn: normalizeAuthn,\n  frame: normalizeFrame,\n  \"open-id\": normalizeOpenId,\n  \"user-signature\": normalizeUserSignature,\n  \"local-view\": normalizeLocalView,\n  \"account-proof\": normalizeAccountProof,\n  \"authn-refresh\": normalizeAuthnRefresh,\n}\n\nexport function normalizeService(service, data) {\n  try {\n    var normalized = serviceNormalizers[service.type](service, data)\n    return normalized\n  } catch (error) {\n    console.error(\n      `Unrecognized FCL Service Type [${service.type}]`,\n      service,\n      error\n    )\n    return service\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport * as rlp from \"@onflow/rlp\"\nimport {fetchServices} from \"./fetch-services\"\nimport {mergeServices} from \"./merge-services\"\nimport {USER_PRAGMA} from \"./normalize/__vsn\"\nimport {normalizeService} from \"./normalize/service\"\n\nfunction deriveCompositeId(authn) {\n  return rlp\n    .encode([\n      authn.provider.address || authn.provider.name || \"UNSPECIFIED\",\n      authn.id,\n    ])\n    .toString(\"hex\")\n}\n\nfunction normalizeData(data) {\n  data.addr = data.addr ? withPrefix(data.addr) : null\n  data.paddr = data.paddr ? withPrefix(data.paddr) : null\n  return data\n}\n\nfunction findService(type, services) {\n  return services.find(d => d.type === type)\n}\n\nexport async function buildUser(data) {\n  data = normalizeData(data)\n\n  var services = mergeServices(\n    data.services || [],\n    await fetchServices(data.hks, data.code)\n  ).map(service => normalizeService(service, data))\n\n  const authn = findService(\"authn\", services)\n\n  return {\n    ...USER_PRAGMA,\n    addr: withPrefix(data.addr),\n    cid: deriveCompositeId(authn),\n    loggedIn: true,\n    services: services,\n    expiresAt: data.expires,\n  }\n}\n","export function serviceOfType(services = [], type) {\n  return services.find(service => service.type === type)\n}\n","export function serviceEndpoint(service) {\n  const url = new URL(service.endpoint)\n  url.searchParams.append(\"l6n\", window.location.origin)\n  if (service.params != null) {\n    for (let [key, value] of Object.entries(service.params || {})) {\n      url.searchParams.append(key, value)\n    }\n  }\n  return url\n}\n","import {serviceEndpoint} from \"./service-endpoint\"\n\nexport function fetchService(service, opts = {}) {\n  const method = opts.method || \"POST\"\n  const body =\n    method === \"GET\"\n      ? undefined\n      : JSON.stringify(opts.data || service.data || {})\n\n  return fetch(serviceEndpoint(service), {\n    method: method,\n    headers: {\n      ...(service.headers || {}),\n      ...(opts.headers || {}),\n      \"Content-Type\": \"application/json\",\n    },\n    body: body,\n  }).then((d) => d.json())\n}\n","import {POLLING_RESPONSE_PRAGMA} from \"./__vsn\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeFrame} from \"./frame\"\n\n// {\n//    \"f_type\": \"PollingResponse\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"status\": \"PENDING\", // PENDING | APPROVED | DECLINED | REDIRECT\n//    \"reason\": null,      // Reason for Declining Transaction\n//    \"data\": null,        // Return value for APPROVED\n//    \"updates\": BackChannelRpc,\n//    \"local\": Frame,\n// }\nexport function normalizePollingResponse(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...POLLING_RESPONSE_PRAGMA,\n        status: resp.status ?? \"APPROVED\",\n        reason: resp.reason ?? null,\n        data: resp.compositeSignature || resp.data || {...resp} || {},\n        updates: normalizeBackChannelRpc(resp.authorizationUpdates),\n        local: normalizeFrame((resp.local || [])[0]),\n      }\n  }\n}\n","import {normalizePollingResponse} from \"../../../normalize/polling-response\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {fetchService} from \"./fetch-service\"\n\nconst OPTIONS = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\",\n}\n\nconst serviceMethod = service => {\n  invariant(\n    OPTIONS[service.method],\n    \"Invalid Service Method for type back-channel-rpc\",\n    {service}\n  )\n  return OPTIONS[service.method]\n}\n\nconst serviceBody = service => {\n  if (service.method === \"HTTP/GET\") return undefined\n  if (service.method === \"HTTP/POST\" && service.data != null)\n    return JSON.stringify(service.data)\n  return undefined\n}\n\nexport async function poll(service, canContinue = () => true) {\n  invariant(service, \"Missing Polling Service\", {service})\n  if (!canContinue()) throw new Error(\"Externally Halted\")\n\n  const resp = await fetchService(service, {\n    method: serviceMethod(service),\n  }).then(normalizePollingResponse)\n\n  switch (resp.status) {\n    case \"APPROVED\":\n      return resp.data\n    case \"DECLINED\":\n      throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n    default:\n      await new Promise(r => setTimeout(r, 500))\n      return poll(resp.updates, canContinue)\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\n\nconst FRAME = \"FCL_IFRAME\"\n\nconst FRAME_STYLES = `\n  position:fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  height: 100%;\n  width: 100vw;\n  display:block;\n  background:rgba(0,0,0,0.25);\n  z-index: 2147483647;\n  box-sizing: border-box;\n`\n\nexport function renderFrame(src) {\n  invariant(\n    !document.getElementById(FRAME),\n    \"Attempt at triggering multiple Frames\",\n    {src}\n  )\n\n  const $frame = document.createElement(\"iframe\")\n  $frame.src = src\n  $frame.id = FRAME\n  $frame.allow = \"usb *; hid *\"\n  $frame.frameBorder = \"0\"\n  $frame.style.cssText = FRAME_STYLES\n  document.body.append($frame)\n\n  const unmount = () => {\n    if (document.getElementById(FRAME)) {\n      document.getElementById(FRAME).remove()\n    }\n  }\n\n  return [$frame.contentWindow, unmount]\n}\n","const POP = \"FCL_POP\"\n\nlet popup = null\nlet previousUrl = null\n\nfunction popupWindow(url, windowName, win, w, h) {\n  const y = win.top.outerHeight / 2 + win.top.screenY - h / 2\n  const x = win.top.outerWidth / 2 + win.top.screenX - w / 2\n  return win.open(\n    url,\n    windowName,\n    `toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${w}, height=${h}, top=${y}, left=${x}`\n  )\n}\n\nexport function renderPop(src) {\n  if (popup == null || popup?.closed) {\n    popup = popupWindow(src, POP, window, 640, 770)\n  } else if (previousUrl !== src) {\n    popup.location.replace(src)\n    popup.focus()\n  } else {\n    popup.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (popup && !popup.closed) {\n      popup.close()\n    }\n    popup = null\n  }\n\n  return [popup, unmount]\n}\n","const TAB = \"FCL_TAB\"\n\nlet tab = null\nlet previousUrl = null\n\nexport function renderTab(src) {\n  if (tab == null || tab?.closed) {\n    tab = window.open(src, \"_blank\")\n  } else if (previousUrl !== src) {\n    tab.location.replace(src)\n    tab.focus()\n  } else {\n    tab.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (tab && !tab.closed) {\n      tab.close()\n    }\n    tab = null\n  }\n\n  return [tab, unmount]\n}\n","import {renderFrame} from \"./strategies/utils/render-frame\"\nimport {renderPop} from \"./strategies/utils/render-pop\"\nimport {renderTab} from \"./strategies/utils/render-tab\"\nimport {serviceEndpoint} from \"./strategies/utils/service-endpoint\"\n\nconst VIEWS = {\n  \"VIEW/IFRAME\": renderFrame,\n  \"VIEW/POP\": renderPop,\n  \"VIEW/TAB\": renderTab,\n}\n\nexport async function execLocal(service, opts = {}) {\n  try {\n    return VIEWS[service.method](serviceEndpoint(service), opts)\n  } catch (error) {\n    console.error(\"execLocal({service, opts = {}})\", error, {service, opts})\n    throw error\n  }\n}\n","import {fetchService} from \"./utils/fetch-service\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {normalizeLocalView} from \"../../normalize/local-view\"\nimport {poll} from \"./utils/poll\"\nimport {execLocal} from \"../exec-local\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport async function execHttpPost(service, signable, opts, config) {\n  const resp = await fetchService(service, {\n    data: {\n      fclVersion: VERSION,\n      service: {\n        params: service.params,\n        data: service.data,\n        type: service.type,\n      },\n      config,\n      ...signable,\n    },\n  }).then(normalizePollingResponse)\n\n  if (resp.status === \"APPROVED\") {\n    return resp.data\n  } else if (resp.status === \"DECLINED\") {\n    throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n  } else if (resp.status === \"REDIRECT\") {\n    return resp\n  } else if (resp.status === \"PENDING\") {\n    var canContinue = true\n    const [_, unmount] = await execLocal(normalizeLocalView(resp.local))\n\n    const close = () => {\n      try {\n        unmount()\n        canContinue = false\n      } catch (error) {\n        console.error(\"Frame Close Error\", error)\n      }\n    }\n\n    return poll(resp.updates, () => canContinue)\n      .then(serviceResponse => {\n        close()\n        return serviceResponse\n      })\n      .catch(error => {\n        console.error(error)\n        close()\n        throw error\n      })\n  } else {\n    console.error(`Auto Decline: Invalid Response`, {service, resp})\n    throw new Error(`Auto Decline: Invalid Response`)\n  }\n}\n","const CLOSE_EVENT = \"FCL:VIEW:CLOSE\"\nconst READY_EVENT = \"FCL:VIEW:READY\"\nconst RESPONSE_EVENT = \"FCL:VIEW:RESPONSE\"\n\nconst _ = e => typeof e === \"string\" && e.toLowerCase()\n\nconst IGNORE = new Set([\n  \"monetizationstart\",\n  \"monetizationpending\",\n  \"monetizationprogress\",\n  \"monetizationstop\",\n])\n\nconst deprecate = (was, want) =>\n  console.warn(\n    \"DEPRECATION NOTICE\",\n    `Received ${was}, please use ${want} for this and future versions of FCL`\n  )\n\nexport const buildMessageHandler =\n  ({close, send, onReady, onResponse, onMessage}) =>\n  e => {\n    try {\n      if (typeof e.data !== \"object\") return\n      if (IGNORE.has(e.data.type)) return\n      if (_(e.data.type) === _(CLOSE_EVENT)) close()\n      if (_(e.data.type) === _(READY_EVENT)) onReady(e, {send, close})\n      if (_(e.data.type) === _(RESPONSE_EVENT)) onResponse(e, {send, close})\n      onMessage(e, {send, close})\n\n      // Backwards Compatible\n      if (_(e.data.type) === _(\"FCL:FRAME:READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:CLOSE\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      //\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::AUTHZ_READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      if (_(e.data.type) === _(\"FCL::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n    } catch (error) {\n      console.error(\"Frame Callback Error\", error)\n      close()\n    }\n  }\n","import {renderFrame} from \"./render-frame\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function frame(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n  const [$frame, unmount] = renderFrame(serviceEndpoint(service))\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Frame Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $frame.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Frame Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {frame} from \"./utils/frame\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execIframeRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const includeOlderJsonRpcCall = opts.includeOlderJsonRpcCall\n\n    frame(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            fclVersion: VERSION,\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n              deprecated: {\n                message:\n                  \"jsonrpc is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n              },\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderPop} from \"./render-pop\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function pop(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n  const [$pop, unmount] = renderPop(serviceEndpoint(service))\n  const timer = setInterval(function () {\n    if ($pop && $pop.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Popup Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $pop.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Popup Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {pop} from \"./utils/pop\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execPopRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    pop(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderTab} from \"./render-tab\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function tab(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n  const [$tab, unmount] = renderTab(serviceEndpoint(service))\n  const timer = setInterval(function () {\n    if ($tab && $tab.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Tab Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $tab.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Tab Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {tab} from \"./utils/tab\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execTabRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    tab(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function extension(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n\n  send({service})\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      onClose()\n    } catch (error) {\n      console.error(\"Ext Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      window && window.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Ext Send Error\", msg, error)\n    }\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {extension} from \"./utils/extension\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execExtRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    extension(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execExtRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {execHttpPost} from \"./strategies/http-post\"\nimport {execIframeRPC} from \"./strategies/iframe-rpc\"\nimport {execPopRPC} from \"./strategies/pop-rpc\"\nimport {execTabRPC} from \"./strategies/tab-rpc\"\nimport {execExtRPC} from \"./strategies/ext-rpc\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {configLens} from \"../../config-utils\"\nimport {VERSION} from \"../../VERSION\"\n\nconst STRATEGIES = {\n  \"HTTP/RPC\": execHttpPost,\n  \"HTTP/POST\": execHttpPost,\n  \"IFRAME/RPC\": execIframeRPC,\n  \"POP/RPC\": execPopRPC,\n  \"TAB/RPC\": execTabRPC,\n  \"EXT/RPC\": execExtRPC,\n}\n\nexport async function execService({service, msg = {}, opts = {}, config = {}}) {\n  msg.data = service.data\n  const fullConfig = {\n    ...config,\n    services: await configLens(/^service\\./),\n    app: await configLens(/^app\\.detail\\./),\n    client: {\n      fclVersion: VERSION,\n      fclLibrary: \"https://github.com/onflow/fcl-js\",\n      hostname: window?.location?.hostname ?? null,\n      extensions: window?.fcl_extensions || [],\n    },\n  }\n\n  try {\n    const res = await STRATEGIES[service.method](\n      service, \n      msg, \n      opts, \n      fullConfig\n    )\n    if (res.status === \"REDIRECT\") {\n      invariant(\n        service.type === res.data.type,\n        \"Cannot shift recursive service type in execService\"\n      )\n      return await execService({\n        service: res.data, \n        msg, \n        opts, \n        config: fullConfig\n      })\n    } else {\n      return res\n    }\n  } catch (error) {\n    console.error(\"execService({service, msg = {}, opts = {}, config = {}})\", error, {\n      service,\n      msg,\n      opts,\n      config\n    })\n    throw error\n  }\n}\n","import {COMPOSITE_SIGNATURE_PRAGMA} from \"./__vsn\"\nimport {sansPrefix} from \"@onflow/util-address\"\n\n// {\n//    \"f_type\": \"CompositeSignature\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"addr\": \"_____\",         // sans-prefix\n//    \"signature\": \"adfe1234\", // hex\n//    \"keyId\": 3,\n// }\nexport function normalizeCompositeSignature(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...COMPOSITE_SIGNATURE_PRAGMA,\n        addr: sansPrefix(resp.addr || resp.address),\n        signature: resp.signature || resp.sig,\n        keyId: resp.keyId,\n      }\n  }\n}\n","import \"../default-config\"\nimport * as t from \"@onflow/types\"\nimport {account, arg} from \"@onflow/sdk\"\nimport {config} from \"@onflow/config\"\nimport {spawn, send, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {withPrefix, sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {buildUser} from \"./build-user\"\nimport {serviceOfType} from \"./service-of-type\"\nimport {execService} from \"./exec-service\"\nimport {normalizeCompositeSignature} from \"./normalize/composite-signature\"\nimport {getDiscoveryService} from \"../config-utils\"\n\nconst NAME = \"CURRENT_USER\"\nconst UPDATED = \"CURRENT_USER/UPDATED\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst SET_CURRENT_USER = \"SET_CURRENT_USER\"\nconst DEL_CURRENT_USER = \"DEL_CURRENT_USER\"\n\nconst DATA = `{\n  \"f_type\": \"User\",\n  \"f_vsn\": \"1.0.0\",\n  \"addr\":null,\n  \"cid\":null,\n  \"loggedIn\":null,\n  \"expiresAt\":null,\n  \"services\":[]\n}`\n\nconst getStoredUser = async storage => {\n  const fallback = JSON.parse(DATA)\n  const stored = await storage.get(NAME)\n  if (stored != null && fallback[\"f_vsn\"] !== stored[\"f_vsn\"]) {\n    storage.removeItem(NAME)\n    return fallback\n  }\n  return stored || fallback\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    if (typeof window === \"undefined\") {\n      console.warn(\n        `\n        %cFCL Warning\n        ============================\n        \"currentUser\" is only available in the browser.\n        For more info, please see the docs: https://docs.onflow.org/fcl/\n        ============================\n        `,\n        \"font-weight:bold;font-family:monospace;\"\n      )\n    }\n\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) {\n      const user = await getStoredUser(storage)\n      if (notExpired(user)) ctx.merge(user)\n    }\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply({...ctx.all()})\n  },\n  [SET_CURRENT_USER]: async (ctx, letter, data) => {\n    ctx.merge(data)\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n  [DEL_CURRENT_USER]: async (ctx, letter) => {\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n}\n\nconst spawnCurrentUser = () => spawn(HANDLERS, NAME)\n\nfunction notExpired(user) {\n  return (\n    user.expiresAt == null ||\n    user.expiresAt === 0 ||\n    user.expiresAt > Date.now()\n  )\n}\n\nasync function getAccountProofData() {\n  const accountProofDataResolver = await config.get(\"fcl.accountProof.resolver\")\n  const accountProofData =\n    accountProofDataResolver ?? (await accountProofDataResolver())\n\n  if (accountProofData == null) return\n\n  invariant(\n    typeof accountProofData.appIdentifier === \"string\",\n    \"appIdentifier must be a string\"\n  )\n  invariant(\n    /^[0-9a-f]+$/i.test(accountProofData.nonce),\n    \"Nonce must be a hex string\"\n  )\n\n  return accountProofData\n}\n\nasync function authenticate({service, redir = false} = {}) {\n  return new Promise(async (resolve, reject) => {\n    spawnCurrentUser()\n    const opts = {redir}\n    const user = await snapshot()\n    const discoveryService = await getDiscoveryService()\n    const refreshService = serviceOfType(user.services, \"authn-refresh\")\n    let accountProofData\n\n    try {\n      accountProofData = await getAccountProofData()\n    } catch (error) {\n      console.error(\n        `Error During Authentication: Could not resolve account proof data.\n        ${error}`\n      )\n      return reject(error)\n    }\n\n    invariant(\n      service || discoveryService.endpoint,\n      `\n        If no service passed to \"authenticate,\" then \"discovery.wallet\" must be defined in config.\n        See: \"https://docs.onflow.org/fcl/reference/api/#setting-configuration-values\"\n      `\n    )\n\n    if (user.loggedIn) {\n      if (refreshService) {\n        try {\n          const response = await execService({\n            service: refreshService,\n            msg: accountProofData,\n            opts,\n          })\n          send(NAME, SET_CURRENT_USER, await buildUser(response))\n        } catch (e) {\n          console.error(\"Error: Could not refresh authentication.\", e)\n        } finally {\n          return resolve(await snapshot())\n        }\n      } else {\n        return resolve(user)\n      }\n    }\n\n    try {\n      const response = await execService({\n        service: {\n          ...(service || discoveryService),\n          method: discoveryService?.method || service.method || \"IFRAME/RPC\",\n        },\n        msg: accountProofData,\n        opts,\n        config: {\n          discoveryAuthnInclude: discoveryService.discoveryAuthnInclude,\n        },\n      })\n      send(NAME, SET_CURRENT_USER, await buildUser(response))\n    } catch (e) {\n      console.error(\"Error while authenticating\", e)\n    } finally {\n      resolve(await snapshot())\n    }\n  })\n}\n\nfunction unauthenticate() {\n  spawnCurrentUser()\n  send(NAME, DEL_CURRENT_USER)\n}\n\nconst normalizePreAuthzResponse = authz => ({\n  f_type: \"PreAuthzResponse\",\n  f_vsn: \"1.0.0\",\n  proposer: (authz || {}).proposer,\n  payer: (authz || {}).payer || [],\n  authorization: (authz || {}).authorization || [],\n})\n\nfunction resolvePreAuthz(authz) {\n  const resp = normalizePreAuthzResponse(authz)\n  const axs = []\n\n  if (resp.proposer != null) axs.push([\"PROPOSER\", resp.proposer])\n  for (let az of resp.payer || []) axs.push([\"PAYER\", az])\n  for (let az of resp.authorization || []) axs.push([\"AUTHORIZER\", az])\n\n  var result = axs.map(([role, az]) => ({\n    tempId: [az.identity.address, az.identity.keyId].join(\"|\"),\n    addr: az.identity.address,\n    keyId: az.identity.keyId,\n    signingFunction(signable) {\n      return execService({service: az, msg: signable})\n    },\n    role: {\n      proposer: role === \"PROPOSER\",\n      payer: role === \"PAYER\",\n      authorizer: role === \"AUTHORIZER\",\n    },\n  }))\n  return result\n}\n\nasync function authorization(account) {\n  spawnCurrentUser()\n\n  return {\n    ...account,\n    tempId: \"CURRENT_USER\",\n    async resolve(account, preSignable) {\n      const user = await authenticate({redir: true})\n      const authz = serviceOfType(user.services, \"authz\")\n      const preAuthz = serviceOfType(user.services, \"pre-authz\")\n\n      if (preAuthz)\n        return resolvePreAuthz(\n          await execService({\n            service: preAuthz,\n            msg: preSignable,\n          })\n        )\n      if (authz)\n        return {\n          ...account,\n          tempId: \"CURRENT_USER\",\n          resolve: null,\n          addr: sansPrefix(authz.identity.address),\n          keyId: authz.identity.keyId,\n          sequenceNum: null,\n          signature: null,\n          async signingFunction(signable) {\n            return normalizeCompositeSignature(\n              await execService({\n                service: authz,\n                msg: signable,\n                opts: {\n                  includeOlderJsonRpcCall: true,\n                },\n              })\n            )\n          },\n        }\n      throw new Error(\n        \"No Authz or PreAuthz Service configured for CURRENT_USER\"\n      )\n    },\n  }\n}\n\nfunction subscribe(callback) {\n  spawnCurrentUser()\n  const EXIT = \"@EXIT\"\n  const self = spawn(async ctx => {\n    ctx.send(NAME, SUBSCRIBE)\n    while (1) {\n      const letter = await ctx.receive()\n      if (letter.tag === EXIT) {\n        ctx.send(NAME, UNSUBSCRIBE)\n        return\n      }\n      callback(letter.data)\n    }\n  })\n  return () => send(self, EXIT)\n}\n\nfunction snapshot() {\n  spawnCurrentUser()\n  return send(NAME, SNAPSHOT, null, {expectReply: true, timeout: 0})\n}\n\nasync function info() {\n  spawnCurrentUser()\n  const {addr} = await snapshot()\n  if (addr == null) throw new Error(\"No Flow Address for Current User\")\n  return account(addr)\n}\n\nasync function resolveArgument() {\n  const {addr} = await authenticate()\n  return arg(withPrefix(addr), t.Address)\n}\n\nconst makeSignable = msg => {\n  invariant(/^[0-9a-f]+$/i.test(msg), \"Message must be a hex string\")\n\n  return {\n    message: msg,\n  }\n}\n\nasync function signUserMessage(msg) {\n  spawnCurrentUser()\n  const user = await authenticate({redir: true})\n\n  const signingService = serviceOfType(user.services, \"user-signature\")\n\n  invariant(\n    signingService,\n    \"Current user must have authorized a signing service.\"\n  )\n\n  try {\n    const response = await execService({\n      service: signingService,\n      msg: makeSignable(msg),\n    })\n    if (Array.isArray(response)) {\n      return response.map(compSigs => normalizeCompositeSignature(compSigs))\n    } else {\n      return [normalizeCompositeSignature(response)]\n    }\n  } catch (error) {\n    return error\n  }\n}\n\nlet currentUser = () => {\n  return {\n    authenticate,\n    unauthenticate,\n    authorization,\n    signUserMessage,\n    subscribe,\n    snapshot,\n    resolveArgument,\n  }\n}\n\ncurrentUser.authenticate = authenticate\ncurrentUser.unauthenticate = unauthenticate\ncurrentUser.authorization = authorization\ncurrentUser.signUserMessage = signUserMessage\ncurrentUser.subscribe = subscribe\ncurrentUser.snapshot = snapshot\ncurrentUser.resolveArgument = resolveArgument\n\nexport {currentUser}\n","import \"../default-config\"\nimport {\n  spawn,\n  send,\n  subscriber,\n  snapshoter,\n  UPDATED,\n  SNAPSHOT,\n  INIT,\n  SUBSCRIBE,\n  UNSUBSCRIBE,\n} from \"@onflow/util-actor\"\nimport {send as fclSend, decode, getTransactionStatus} from \"@onflow/sdk\"\n\nconst RATE = 2500\nconst POLL = \"POLL\"\n\nconst fetchTxStatus = async transactionId => {\n  return fclSend([getTransactionStatus(transactionId)]).then(decode)\n}\n\nconst isExpired = tx => tx.status === 5\nconst isSealed = tx => tx.status >= 4\nconst isExecuted = tx => tx.status >= 3\nconst isFinalized = tx => tx.status >= 2\nconst isPending = tx => tx.status >= 1\nconst isUnknown = tx => tx.status >= 0\n\nconst isDiff = (cur, next) => {\n  return JSON.stringify(cur) !== JSON.stringify(next)\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    const tx = await fetchTxStatus(ctx.self())\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    ctx.merge(tx)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, ctx.all())\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply(ctx.all())\n  },\n  [POLL]: async ctx => {\n    let tx\n    try {\n      tx = await fetchTxStatus(ctx.self())\n    } catch (e) {\n      console.error(e)\n      setTimeout(() => ctx.sendSelf(POLL), RATE)\n      return\n    }\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    if (isDiff(ctx.all(), tx)) ctx.broadcast(UPDATED, tx)\n    ctx.merge(tx)\n  },\n}\n\nconst scoped = transactionId => {\n  if (typeof transactionId === \"object\")\n    transactionId = transactionId.transactionId\n  if (transactionId == null) throw new Error(\"transactionId required\")\n  return transactionId\n}\n\nconst spawnTransaction = transactionId => {\n  return spawn(HANDLERS, scoped(transactionId))\n}\n\nexport function transaction(transactionId) {\n  function snapshot() {\n    return snapshoter(transactionId, spawnTransaction)\n  }\n\n  function subscribe(callback) {\n    return subscriber(scoped(transactionId), spawnTransaction, callback)\n  }\n\n  function once(predicate) {\n    return function innerOnce(opts = {}) {\n      const suppress = opts.suppress || false\n      return new Promise((resolve, reject) => {\n        const unsub = subscribe(txStatus => {\n          if (txStatus.statusCode && !suppress) {\n            reject(txStatus.errorMessage)\n            unsub()\n          } else if (predicate(txStatus)) {\n            resolve(txStatus)\n            unsub()\n          }\n        })\n      })\n    }\n  }\n\n  return {\n    snapshot,\n    subscribe,\n    onceFinalized: once(isFinalized),\n    onceExecuted: once(isExecuted),\n    onceSealed: once(isSealed),\n  }\n}\n\ntransaction.isUnknown = isUnknown\ntransaction.isPending = isPending\ntransaction.isFinalized = isFinalized\ntransaction.isExecuted = isExecuted\ntransaction.isSealed = isSealed\ntransaction.isExpired = isExpired\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport {isRequired, isObject, isString, isFunc, isNumber} from \"./utils/is\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\nimport {currentUser} from \"../current-user\"\nimport {transaction} from \"../transaction\"\n\n/** As the current user Mutate the Flow Blockchain\n *\n *  @arg {Object} opts - Mutation Options and configuration\n *  @arg {string} opts.cadence - Cadence Transaction used to mutate Flow\n *  @arg {ArgsFn} opts.args - Arguments passed to cadence transaction\n *  @arg {number} opts.limit - Compute Limit for transaction\n *  @returns {string} Transaction Id\n *\n *  Where:\n *    @callback ArgsFn\n *    @arg {ArgFn}  arg - Argument function to define a single argument\n *    @arg {Object} t   - Cadence Types object used to define the type\n *    @returns {args[]}\n *\n *    @callback ArgFn\n *    @arg {Any}  value - the value of the argument\n *    @arg {Type} type  - the cadence type of the value\n *    @returns {arg}\n *\n *  Example:\n *    fcl.mutate({\n *      cadence: `\n *        transaction(a: Int, b: Int, c: Address) {\n *          prepare(acct: AuthAccount) {\n *            log(acct)\n *            log(a)\n *            log(b)\n *            log(c)\n *          }\n *        }\n *      `,\n *      args: (arg, t) => [\n *        arg(6, t.Int),\n *        arg(7, t.Int),\n *        arg(\"0xba1132bc08f82fe2\", t.Address),\n *      ],\n *    })\n *\n *\n *  Options:\n *    type Options = {\n *      cadence: String!,\n *      args: (arg, t) => Array<Arg>,\n *      limit: Number,\n *      authz: AuthzFn, // will overload the trinity of signatory roles\n *      proposer: AuthzFn, // will overload the proposer signatory role\n *      payer: AuthzFn, // will overload the payer signatory role\n *      authorizations: [AuthzFn], // an array of authorization functions used as authorizations signatory roles\n *    }\n */\n\nconst noop = () => {}\n\nexport async function mutate(opts = {}) {\n  var txid\n  try {\n    await prepMutation(opts)\n\n    // Allow for a config to overwrite the authorization function.\n    // prettier-ignore\n    const authz = await sdk.config().get(\"fcl.authz\", currentUser().authorization)\n\n    // prettier-ignore\n    txid = sdk.send([\n      sdk.transaction(opts.cadence),\n\n      sdk.args(normalizeArgs(opts.args || [])),\n\n      opts.limit && isNumber(opts.limit) && sdk.limit(opts.limit),\n\n      // opts.proposer > opts.authz > authz\n      sdk.proposer(opts.proposer || opts.authz || authz),\n\n      // opts.payer > opts.authz > authz\n      sdk.payer(opts.payer || opts.authz || authz),\n\n      // opts.authorizations > [opts.authz > authz]\n      sdk.authorizations(opts.authorizations || [opts.authz || authz]),\n    ]).then(sdk.decode)\n\n    return txid\n  } catch (error) {\n    throw error\n  }\n}\n\nasync function prepMutation(opts) {\n  // prettier-ignore\n  invariant(isRequired(opts), \"mutate(opts) -- opts is required\")\n  // prettier-ignore\n  invariant(isObject(opts), \"mutate(opts) -- opts must be an object\")\n  // prettier-ignore\n  invariant(isRequired(opts.cadence), \"mutate({ cadence }) -- cadence is required\")\n  // prettier-ignore\n  invariant(isString(opts.cadence), \"mutate({ cadence }) -- cadence must be a string\")\n  // prettier-ignore\n  invariant(\n    await sdk.config.get(\"accessNode.api\"),\n    `Required value for \"accessNode.api\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`\n  )\n}\n","export const onMessageFromFCL = (messageType, cb = () => {}) => {\n  const buildData = data => {\n    if (data.deprecated)\n      console.warn(\"DEPRECATION NOTICE\", data.deprecated.message)\n    delete data?.body?.interaction\n\n    return data\n  }\n\n  const internal = e => {\n    const {data} = e\n    if (typeof data !== \"object\") return\n    if (typeof data == null) return\n    if (data.type !== messageType) return\n\n    cb(buildData(data))\n  }\n\n  window.addEventListener(\"message\", internal)\n  return () => window.removeEventListener(\"message\", internal)\n}\n","import {onMessageFromFCL} from \"./on-message-from-fcl\"\n\nexport const sendMsgToFCL = (type, msg = {}) => {\n  if (window.location !== window.parent.location) {\n    window.parent.postMessage({...msg, type}, \"*\")\n  } else {\n    window.opener.postMessage({...msg, type}, \"*\")\n  }\n}\n\nexport const ready = (cb, msg = {}) => {\n  onMessageFromFCL(\"FCL:VIEW:READY:RESPONSE\", cb)\n  sendMsgToFCL(\"FCL:VIEW:READY\")\n}\n\nexport const close = () => {\n  sendMsgToFCL(\"FCL:VIEW:CLOSE\")\n}\n\nexport const approve = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"APPROVED\",\n    reason: null,\n    data: data,\n  })\n}\n\nexport const decline = reason => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"DECLINED\",\n    reason: reason,\n    data: null,\n  })\n}\n\nexport const redirect = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"REDIRECT\",\n    reason: null,\n    data: data,\n  })\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {COMPOSITE_SIGNATURE_PRAGMA} from \"../current-user/normalize/__vsn\"\n\nexport function CompositeSignature(addr, keyId, signature) {\n  this.f_type = COMPOSITE_SIGNATURE_PRAGMA.f_type\n  this.f_vsn = COMPOSITE_SIGNATURE_PRAGMA.f_vsn\n  this.addr = withPrefix(addr)\n  this.keyId = Number(keyId)\n  this.signature = signature\n}\n","import {sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {Buffer, encode as rlpEncode} from \"@onflow/rlp\"\n\nconst rightPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padEnd(pad * 2, \"0\"), \"hex\")\n\nconst leftPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padStart(pad * 2, \"0\"), \"hex\")\n\nconst addressBuffer = addr => leftPaddedHexBuffer(addr, 8)\n\nconst nonceBuffer = nonce => Buffer.from(nonce, \"hex\")\n\nexport const encodeAccountProof = (\n  {address, nonce, appIdentifier},\n  includeDomainTag = true\n) => {\n  invariant(\n    address,\n    \"Encode Message For Provable Authn Error: address must be defined\"\n  )\n  invariant(\n    nonce,\n    \"Encode Message For Provable Authn Error: nonce must be defined\"\n  )\n  invariant(\n    appIdentifier,\n    \"Encode Message For Provable Authn Error: appIdentifier must be defined\"\n  )\n\n  invariant(\n    nonce.length >= 64,\n    \"Encode Message For Provable Authn Error: nonce must be minimum of 32 bytes\"\n  )\n\n  const ACCOUNT_PROOF_DOMAIN_TAG = rightPaddedHexBuffer(\n    Buffer.from(\"FCL-ACCOUNT-PROOF-V0.0\").toString(\"hex\"),\n    32\n  )\n\n  if (includeDomainTag) {\n    return Buffer.concat([\n      ACCOUNT_PROOF_DOMAIN_TAG,\n      rlpEncode([\n        appIdentifier,\n        addressBuffer(sansPrefix(address)),\n        nonceBuffer(nonce),\n      ]),\n    ]).toString(\"hex\")\n  }\n\n  return rlpEncode([\n    appIdentifier,\n    addressBuffer(sansPrefix(address)),\n    nonceBuffer(nonce),\n  ]).toString(\"hex\")\n}\n","export function injectExtService(service) {\n  if (service.type === \"authn\" && service.endpoint != null) {\n    if (!Array.isArray(window.fcl_extensions)) {\n      window.fcl_extensions = []\n    }\n    window.fcl_extensions.push(service)\n  } else {\n    console.warn(\"Authn service is required\")\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {sansPrefix} from \"@onflow/util-address\"\nimport {query} from \"../exec/query\"\nimport {encodeAccountProof} from \"../wallet-utils\"\nimport {isString} from \"../exec/utils/is\"\n\nconst ACCOUNT_PROOF = \"ACCOUNT_PROOF\"\nconst USER_SIGNATURE = \"USER_SIGNATURE\"\n\nexport const validateArgs = args => {\n  if (args.appIdentifier) {\n    const {appIdentifier, address, nonce, signatures} = args\n    invariant(\n      isString(appIdentifier),\n      \"verifyAccountProof({ appIdentifier }) -- appIdentifier must be a string\"\n    )\n    invariant(\n      isString(address) && sansPrefix(address).length === 16,\n      \"verifyAccountProof({ address }) -- address must be a valid address\"\n    )\n    invariant(/^[0-9a-f]+$/i.test(nonce), \"nonce must be a hex string\")\n    invariant(\n      Array.isArray(signatures) &&\n        signatures.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      signatures.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  } else {\n    const {message, compSigs} = args\n    invariant(\n      /^[0-9a-f]+$/i.test(message),\n      \"Signed message must be a hex string\"\n    )\n    invariant(\n      Array.isArray(compSigs) &&\n        compSigs.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      compSigs.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  }\n}\n\nconst getVerifySignaturesScript = async (sig, opts) => {\n  const verifyFunction =\n    sig === \"ACCOUNT_PROOF\"\n      ? \"verifyAccountProofSignatures\"\n      : \"verifyUserSignatures\"\n\n  const network = await config.first([\"env\", \"flow.network\"])\n  let fclCryptoContract\n\n  invariant(\n    opts.fclCryptoContract || network === \"testnet\" || network === \"mainnet\",\n    \"${verifyFunction}({ fclCryptoContract }) -- config.flow.network must be specified (testnet || mainnet) or contract address provided via opts.fclCryptoContract\"\n  )\n\n  if (opts.fclCryptoContract) {\n    fclCryptoContract = opts.fclCryptoContract\n  } else {\n    fclCryptoContract =\n      network === \"testnet\" ? \"0x74daa6f9c7ef24b1\" : \"0xb4b82a1c9d21d284\"\n  }\n\n  return `\n      import FCLCrypto from ${fclCryptoContract}\n\n      pub fun main(\n          address: Address, \n          message: String, \n          keyIndices: [Int], \n          signatures: [String]\n      ): Bool {\n        return FCLCrypto.${verifyFunction}(address: address, message: message, keyIndices: keyIndices, signatures: signatures)\n      }\n    `\n}\n\n/**\n * Verify a valid account proof signature or signatures for an account on Flow.\n *\n * @param {string} appIdentifier - A message string in hexadecimal format\n * @param {Object} accountProofData - An object consisting of address, nonce, and signatures\n * @param {string} accountProofData.address - A Flow account address\n * @param {string} accountProofData.nonce - A random string in hexadecimal format (minimum 32 bytes in total, i.e 64 hex characters)\n * @param {Object[]} accountProofData.signatures - An array of composite signatures to verify\n * @param {Object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override Flow account address where the FCLCrypto contract is deployed\n * @return {bool}\n *\n * @example\n *\n *  const accountProofData = {\n *   address: \"0x123\",\n *   nonce: \"F0123\"\n *   signatures: [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *  }\n *\n *  const isValid = await fcl.AppUtils.verifyAccountProof(\n *    \"AwesomeAppId\",\n *    accountProofData,\n *    {fclCryptoContract}\n *  )\n */\n\nexport async function verifyAccountProof(\n  appIdentifier,\n  {address, nonce, signatures},\n  opts = {}\n) {\n  validateArgs({appIdentifier, address, nonce, signatures})\n\n  const message = encodeAccountProof({address, nonce, appIdentifier}, false)\n\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of signatures) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId)\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(ACCOUNT_PROOF, opts),\n    args: (arg, t) => [\n      arg(address, t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array([t.Int])),\n      arg(signaturesArr, t.Array([t.String])),\n    ],\n  })\n}\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @param {string} msg - A message string in hexadecimal format\n * @param {Array} compSigs - An array of Composite Signatures\n * @param {string} compSigs[].addr - The account address\n * @param {number} compSigs[].keyId - The account keyId\n * @param {string} compSigs[].signature - The signature to verify\n * @param {Object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override of Flow account address where the FCLCrypto contract is deployed\n * @return {bool}\n *\n * @example\n *\n *  const isValid = await fcl.AppUtils.verifyUserSignatures(\n *    Buffer.from('FOO').toString(\"hex\"),\n *    [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *    {fclCryptoContract}\n *  )\n */\nexport async function verifyUserSignatures(message, compSigs, opts = {}) {\n  validateArgs({message, compSigs})\n\n  const address = compSigs[0].addr\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of compSigs) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId)\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(USER_SIGNATURE, opts),\n    args: (arg, t) => [\n      arg(address, t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array([t.Int])),\n      arg(signaturesArr, t.Array([t.String])),\n    ],\n  })\n}\n","var promise;\nvar queueMicrotask_1 = typeof queueMicrotask === 'function' ? queueMicrotask : function (cb) {\n  return (promise || (promise = Promise.resolve())).then(cb)[\"catch\"](function (err) {\n    return setTimeout(function () {\n      throw err;\n    }, 0);\n  });\n};\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar mailbox = function mailbox() {\n  var queue = [];\n  var next;\n  return {\n    deliver: function deliver(msg) {\n      try {\n        queue.push(msg);\n\n        if (next) {\n          next(queue.shift());\n          next = undefined;\n        }\n\n        return Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    },\n    receive: function receive() {\n      return new Promise(function innerReceive(resolve) {\n        var msg = queue.shift();\n        if (msg) return resolve(msg);\n        next = resolve;\n      });\n    }\n  };\n};\n\nfunction _catch(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n\n  return result;\n}\n\nfunction _finallyRethrows(body, finalizer) {\n  try {\n    var result = body();\n  } catch (e) {\n    return finalizer(true, e);\n  }\n\n  if (result && result.then) {\n    return result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n  }\n\n  return finalizer(false, result);\n}\n\nfunction _settle(pact, state, value) {\n  if (!pact.s) {\n    if (value instanceof _Pact) {\n      if (value.s) {\n        if (state & 1) {\n          state = value.s;\n        }\n\n        value = value.v;\n      } else {\n        value.o = _settle.bind(null, pact, state);\n        return;\n      }\n    }\n\n    if (value && value.then) {\n      value.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n      return;\n    }\n\n    pact.s = state;\n    pact.v = value;\n    var observer = pact.o;\n\n    if (observer) {\n      observer(pact);\n    }\n  }\n}\n\nvar _Pact = /*#__PURE__*/function () {\n  function _Pact() {}\n\n  _Pact.prototype.then = function (onFulfilled, onRejected) {\n    var result = new _Pact();\n    var state = this.s;\n\n    if (state) {\n      var callback = state & 1 ? onFulfilled : onRejected;\n\n      if (callback) {\n        try {\n          _settle(result, 1, callback(this.v));\n        } catch (e) {\n          _settle(result, 2, e);\n        }\n\n        return result;\n      } else {\n        return this;\n      }\n    }\n\n    this.o = function (_this) {\n      try {\n        var value = _this.v;\n\n        if (_this.s & 1) {\n          _settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n        } else if (onRejected) {\n          _settle(result, 1, onRejected(value));\n        } else {\n          _settle(result, 2, value);\n        }\n      } catch (e) {\n        _settle(result, 2, e);\n      }\n    };\n\n    return result;\n  };\n\n  return _Pact;\n}();\n\nfunction _isSettledPact(thenable) {\n  return thenable instanceof _Pact && thenable.s & 1;\n}\n\nfunction _for(test, update, body) {\n  var stage;\n\n  for (;;) {\n    var shouldContinue = test();\n\n    if (_isSettledPact(shouldContinue)) {\n      shouldContinue = shouldContinue.v;\n    }\n\n    if (!shouldContinue) {\n      return result;\n    }\n\n    if (shouldContinue.then) {\n      stage = 0;\n      break;\n    }\n\n    var result = body();\n\n    if (result && result.then) {\n      if (_isSettledPact(result)) {\n        result = result.s;\n      } else {\n        stage = 1;\n        break;\n      }\n    }\n\n    if (update) {\n      var updateValue = update();\n\n      if (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n        stage = 2;\n        break;\n      }\n    }\n  }\n\n  var pact = new _Pact();\n\n  var reject = _settle.bind(null, pact, 2);\n\n  (stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n  return pact;\n\n  function _resumeAfterBody(value) {\n    result = value;\n\n    do {\n      if (update) {\n        updateValue = update();\n\n        if (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n          updateValue.then(_resumeAfterUpdate).then(void 0, reject);\n          return;\n        }\n      }\n\n      shouldContinue = test();\n\n      if (!shouldContinue || _isSettledPact(shouldContinue) && !shouldContinue.v) {\n        _settle(pact, 1, result);\n\n        return;\n      }\n\n      if (shouldContinue.then) {\n        shouldContinue.then(_resumeAfterTest).then(void 0, reject);\n        return;\n      }\n\n      result = body();\n\n      if (_isSettledPact(result)) {\n        result = result.v;\n      }\n    } while (!result || !result.then);\n\n    result.then(_resumeAfterBody).then(void 0, reject);\n  }\n\n  function _resumeAfterTest(shouldContinue) {\n    if (shouldContinue) {\n      result = body();\n\n      if (result && result.then) {\n        result.then(_resumeAfterBody).then(void 0, reject);\n      } else {\n        _resumeAfterBody(result);\n      }\n    } else {\n      _settle(pact, 1, result);\n    }\n  }\n\n  function _resumeAfterUpdate() {\n    if (shouldContinue = test()) {\n      if (shouldContinue.then) {\n        shouldContinue.then(_resumeAfterTest).then(void 0, reject);\n      } else {\n        _resumeAfterTest(shouldContinue);\n      }\n    } else {\n      _settle(pact, 1, result);\n    }\n  }\n}\n\nvar INIT = \"INIT\";\nvar SUBSCRIBE = \"SUBSCRIBE\";\nvar UNSUBSCRIBE = \"UNSUBSCRIBE\";\nvar EXIT = \"EXIT\";\nvar TERMINATE = \"TERMINATE\";\nvar root = typeof self === \"object\" && self.self === self && self || typeof global === \"object\" && global.global === global && global || typeof window === \"object\" && window.window === window && window;\nroot.FCL_REGISTRY = root.FCL_REGISTRY == null ? {} : root.FCL_REGISTRY;\nvar pid = 0;\nvar DEFAULT_TIMEOUT = 5000;\n\nvar _send = function send(addr, tag, data, opts) {\n  if (opts === void 0) {\n    opts = {};\n  }\n\n  return new Promise(function (reply, reject) {\n    var expectReply = opts.expectReply || false;\n    var timeout = opts.timeout != null ? opts.timeout : DEFAULT_TIMEOUT;\n\n    if (expectReply && timeout) {\n      setTimeout(function () {\n        return reject(new Error(\"Timeout: \" + timeout + \"ms passed without a response.\"));\n      }, timeout);\n    }\n\n    var payload = {\n      to: addr,\n      from: opts.from,\n      tag: tag,\n      data: data,\n      timeout: timeout,\n      reply: reply,\n      reject: reject\n    };\n\n    try {\n      root.FCL_REGISTRY[addr] && root.FCL_REGISTRY[addr].mailbox.deliver(payload);\n      if (!expectReply) reply(true);\n    } catch (error) {\n      console.error(\"FCL.Actor -- Could Not Deliver Message\", payload, root.FCL_REGISTRY[addr], error);\n    }\n  });\n};\n\nvar kill = function kill(addr) {\n  delete root.FCL_REGISTRY[addr];\n};\n\nvar fromHandlers = function fromHandlers(handlers) {\n  if (handlers === void 0) {\n    handlers = {};\n  }\n\n  return function (ctx) {\n    try {\n      var _temp12 = function _temp12() {\n        var _loopInterrupt;\n\n        var _temp6 = _for(function () {\n          return !_loopInterrupt && 1;\n        }, void 0, function () {\n          return Promise.resolve(ctx.receive()).then(function (letter) {\n            var _temp5 = _finallyRethrows(function () {\n              return _catch(function () {\n                function _temp4() {\n                  return Promise.resolve(handlers[letter.tag](ctx, letter, letter.data || {})).then(function () {});\n                }\n\n                var _temp3 = function () {\n                  if (letter.tag === EXIT) {\n                    var _temp10 = function _temp10() {\n                      _loopInterrupt = 1;\n                    };\n\n                    var _temp11 = function () {\n                      if (typeof handlers[TERMINATE] === \"function\") {\n                        return Promise.resolve(handlers[TERMINATE](ctx, letter, letter.data || {})).then(function () {});\n                      }\n                    }();\n\n                    return _temp11 && _temp11.then ? _temp11.then(_temp10) : _temp10(_temp11);\n                  }\n                }();\n\n                return _temp3 && _temp3.then ? _temp3.then(_temp4) : _temp4(_temp3);\n              }, function (error) {\n                console.error(ctx.self() + \" Error\", letter, error);\n              });\n            }, function (_wasThrown, _result) {\n              return;\n              if (_wasThrown) throw _result;\n              return _result;\n            });\n\n            if (_temp5 && _temp5.then) return _temp5.then(function () {});\n          });\n        });\n\n        var _temp7 = function () {\n          if (_temp6 && _temp6.then) return _temp6.then(function () {});\n        }();\n\n        if (_temp7 && _temp7.then) return _temp7.then(function () {});\n      };\n\n      var _temp13 = function () {\n        if (typeof handlers[INIT] === \"function\") return Promise.resolve(handlers[INIT](ctx)).then(function () {});\n      }();\n\n      return Promise.resolve(_temp13 && _temp13.then ? _temp13.then(_temp12) : _temp12(_temp13));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n};\n\nvar spawn = function spawn(fn, addr) {\n  if (addr === void 0) {\n    addr = null;\n  }\n\n  if (addr == null) addr = ++pid;\n  if (root.FCL_REGISTRY[addr] != null) return addr;\n  root.FCL_REGISTRY[addr] = {\n    addr: addr,\n    mailbox: mailbox(),\n    subs: new Set(),\n    kvs: {}\n  };\n  var ctx = {\n    self: function self() {\n      return addr;\n    },\n    receive: function receive() {\n      return root.FCL_REGISTRY[addr].mailbox.receive();\n    },\n    send: function send(to, tag, data, opts) {\n      if (opts === void 0) {\n        opts = {};\n      }\n\n      opts.from = addr;\n      return _send(to, tag, data, opts);\n    },\n    sendSelf: function sendSelf(tag, data, opts) {\n      if (root.FCL_REGISTRY[addr]) _send(addr, tag, data, opts);\n    },\n    broadcast: function broadcast(tag, data, opts) {\n      if (opts === void 0) {\n        opts = {};\n      }\n\n      opts.from = addr;\n\n      for (var _iterator = _createForOfIteratorHelperLoose(root.FCL_REGISTRY[addr].subs), _step; !(_step = _iterator()).done;) {\n        var to = _step.value;\n\n        _send(to, tag, data, opts);\n      }\n    },\n    subscribe: function subscribe(sub) {\n      return sub != null && root.FCL_REGISTRY[addr].subs.add(sub);\n    },\n    unsubscribe: function unsubscribe(sub) {\n      return sub != null && root.FCL_REGISTRY[addr].subs[\"delete\"](sub);\n    },\n    subscriberCount: function subscriberCount() {\n      return root.FCL_REGISTRY[addr].subs.size;\n    },\n    hasSubs: function hasSubs() {\n      return !!root.FCL_REGISTRY[addr].subs.size;\n    },\n    put: function put(key, value) {\n      if (key != null) root.FCL_REGISTRY[addr].kvs[key] = value;\n    },\n    get: function get(key, fallback) {\n      var value = root.FCL_REGISTRY[addr].kvs[key];\n      return value == null ? fallback : value;\n    },\n    \"delete\": function _delete(key) {\n      delete root.FCL_REGISTRY[addr].kvs[key];\n    },\n    update: function update(key, fn) {\n      if (key != null) root.FCL_REGISTRY[addr].kvs[key] = fn(root.FCL_REGISTRY[addr].kvs[key]);\n    },\n    keys: function keys() {\n      return Object.keys(root.FCL_REGISTRY[addr].kvs);\n    },\n    all: function all() {\n      return root.FCL_REGISTRY[addr].kvs;\n    },\n    where: function where(pattern) {\n      return Object.keys(root.FCL_REGISTRY[addr].kvs).reduce(function (acc, key) {\n        var _extends2;\n\n        return pattern.test(key) ? _extends({}, acc, (_extends2 = {}, _extends2[key] = root.FCL_REGISTRY[addr].kvs[key], _extends2)) : acc;\n      }, {});\n    },\n    merge: function merge(data) {\n      if (data === void 0) {\n        data = {};\n      }\n\n      Object.keys(data).forEach(function (key) {\n        return root.FCL_REGISTRY[addr].kvs[key] = data[key];\n      });\n    }\n  };\n  if (typeof fn === \"object\") fn = fromHandlers(fn);\n  queueMicrotask_1(function () {\n    try {\n      return Promise.resolve(fn(ctx)).then(function () {\n        kill(addr);\n      });\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n  return addr;\n};\n\nfunction subscriber(address, spawnFn, callback) {\n  spawnFn(address);\n  var EXIT = \"@EXIT\";\n  var self = spawn(function (ctx) {\n    try {\n      var _exit2;\n\n      ctx.send(address, SUBSCRIBE);\n      return Promise.resolve(_for(function () {\n        return !_exit2 && 1;\n      }, void 0, function () {\n        return Promise.resolve(ctx.receive()).then(function (letter) {\n          if (letter.tag === EXIT) {\n            ctx.send(address, UNSUBSCRIBE);\n            _exit2 = 1;\n            return;\n          }\n\n          callback(letter.data);\n        });\n      }));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n  return function () {\n    return _send(self, EXIT);\n  };\n}\n\nfunction _extends$1() {\n  _extends$1 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends$1.apply(this, arguments);\n}\n\nvar _iteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\")) : \"@@iterator\";\n\nvar _asyncIteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\")) : \"@@asyncIterator\";\n\nfunction _catch$1(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n\n  return result;\n}\n\nvar _HANDLERS;\n\nvar first = function first(wants, fallback) {\n  if (wants === void 0) {\n    wants = [];\n  }\n\n  try {\n    if (!wants.length) return Promise.resolve(fallback);\n\n    var _wants = wants,\n        head = _wants[0],\n        rest = _wants.slice(1);\n\n    return Promise.resolve(get(head)).then(function (ret) {\n      return ret == null ? first(rest, fallback) : ret;\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nvar NAME = \"config\";\nvar PUT = \"PUT_CONFIG\";\nvar GET = \"GET_CONFIG\";\nvar GET_ALL = \"GET_ALL_CONFIG\";\nvar UPDATE = \"UPDATE_CONFIG\";\nvar DELETE = \"DELETE_CONFIG\";\nvar CLEAR = \"CLEAR_CONFIG\";\nvar WHERE = \"WHERE_CONFIG\";\nvar UPDATED = \"CONFIG/UPDATED\";\n\nvar identity = function identity(v) {\n  return v;\n};\n\nvar HANDLERS = (_HANDLERS = {}, _HANDLERS[PUT] = function (ctx, _letter, _ref) {\n  var key = _ref.key,\n      value = _ref.value;\n  if (key == null) throw new Error(\"Missing 'key' for config/put.\");\n  ctx.put(key, value);\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[GET] = function (ctx, letter, _ref2) {\n  var key = _ref2.key,\n      fallback = _ref2.fallback;\n  if (key == null) throw new Error(\"Missing 'key' for config/get\");\n  letter.reply(ctx.get(key, fallback));\n}, _HANDLERS[GET_ALL] = function (ctx, letter) {\n  letter.reply(_extends$1({}, ctx.all()));\n}, _HANDLERS[UPDATE] = function (ctx, letter, _ref3) {\n  var key = _ref3.key,\n      fn = _ref3.fn;\n  if (key == null) throw new Error(\"Missing 'key' for config/update\");\n  ctx.update(key, fn || identity);\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[DELETE] = function (ctx, letter, _ref4) {\n  var key = _ref4.key;\n  if (key == null) throw new Error(\"Missing 'key' for config/delete\");\n  ctx[\"delete\"](key);\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[CLEAR] = function (ctx, letter) {\n  var keys = Object.keys(ctx.all());\n\n  for (var _i = 0, _keys = keys; _i < _keys.length; _i++) {\n    var key = _keys[_i];\n    ctx[\"delete\"](key);\n  }\n\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[WHERE] = function (ctx, letter, _ref5) {\n  var pattern = _ref5.pattern;\n  if (pattern == null) throw new Error(\"Missing 'pattern' for config/where\");\n  letter.reply(ctx.where(pattern));\n}, _HANDLERS[SUBSCRIBE] = function (ctx, letter) {\n  ctx.subscribe(letter.from);\n  ctx.send(letter.from, UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[UNSUBSCRIBE] = function (ctx, letter) {\n  ctx.unsubscribe(letter.from);\n}, _HANDLERS);\nspawn(HANDLERS, NAME);\n\nfunction put(key, value) {\n  _send(NAME, PUT, {\n    key: key,\n    value: value\n  });\n  return config();\n}\n\nfunction get(key, fallback) {\n  return _send(NAME, GET, {\n    key: key,\n    fallback: fallback\n  }, {\n    expectReply: true,\n    timeout: 10\n  });\n}\n\nfunction all() {\n  return _send(NAME, GET_ALL, null, {\n    expectReply: true,\n    timeout: 10\n  });\n}\n\nfunction update(key, fn) {\n  if (fn === void 0) {\n    fn = identity;\n  }\n\n  _send(NAME, UPDATE, {\n    key: key,\n    fn: fn\n  });\n  return config();\n}\n\nfunction _delete(key) {\n  _send(NAME, DELETE, {\n    key: key\n  });\n  return config();\n}\n\nfunction where(pattern) {\n  return _send(NAME, WHERE, {\n    pattern: pattern\n  }, {\n    expectReply: true,\n    timeout: 10\n  });\n}\n\nfunction subscribe(callback) {\n  return subscriber(NAME, function () {\n    return spawn(HANDLERS, NAME);\n  }, callback);\n}\n\nfunction clearConfig() {\n  return _send(NAME, CLEAR);\n}\n\nfunction config(values) {\n  if (values != null && typeof values === \"object\") {\n    Object.keys(values).map(function (d) {\n      return put(d, values[d]);\n    });\n  }\n\n  return {\n    put: put,\n    get: get,\n    all: all,\n    first: first,\n    update: update,\n    \"delete\": _delete,\n    where: where,\n    subscribe: subscribe,\n    overload: overload\n  };\n}\n\nconfig.put = put;\nconfig.get = get;\nconfig.all = all;\nconfig.first = first;\nconfig.update = update;\nconfig[\"delete\"] = _delete;\nconfig.where = where;\nconfig.subscribe = subscribe;\nconfig.overload = overload;\n\nvar noop = function noop(v) {\n  return v;\n};\n\nfunction overload(opts, callback) {\n  if (opts === void 0) {\n    opts = {};\n  }\n\n  if (callback === void 0) {\n    callback = noop;\n  }\n\n  return new Promise(function (resolve, reject) {\n    try {\n      return Promise.resolve(all()).then(function (oldConfig) {\n        var _temp = _catch$1(function () {\n          config(opts);\n          var _callback = callback;\n          return Promise.resolve(all()).then(function (_all) {\n            return Promise.resolve(_callback(_all)).then(function (result) {\n              return Promise.resolve(clearConfig()).then(function () {\n                return Promise.resolve(config(oldConfig)).then(function () {\n                  resolve(result);\n                });\n              });\n            });\n          });\n        }, function (error) {\n          return Promise.resolve(clearConfig()).then(function () {\n            return Promise.resolve(config(oldConfig)).then(function () {\n              reject(error);\n            });\n          });\n        });\n\n        if (_temp && _temp.then) return _temp.then(function () {});\n      });\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n}\n\nvar LEVELS = Object.freeze({\n  \"debug\": 5,\n  \"info\": 4,\n  \"log\": 3,\n  \"warn\": 2,\n  \"error\": 1\n});\n\nvar buildLoggerMessageArgs = function buildLoggerMessageArgs(_ref) {\n  var title = _ref.title,\n      message = _ref.message;\n  return [\"\\n    %c\" + title + \"\\n    ============================\\n    \" + message + \"\\n    ============================\\n    \", \"font-weight:bold;font-family:monospace;\"];\n};\n\nvar log = function log(_ref2) {\n  var title = _ref2.title,\n      message = _ref2.message,\n      level = _ref2.level,\n      _ref2$always = _ref2.always,\n      always = _ref2$always === void 0 ? false : _ref2$always;\n\n  try {\n    return Promise.resolve(config.get(\"logger.level\", 0)).then(function (configLoggerLevel) {\n      var _console, _console2, _console3, _console4, _console5;\n\n      if (!always && configLoggerLevel < level) return;\n      var loggerMessageArgs = buildLoggerMessageArgs({\n        title: title,\n        message: message\n      });\n\n      switch (level) {\n        case LEVELS.debug:\n          (_console = console).debug.apply(_console, loggerMessageArgs);\n\n          break;\n\n        case LEVELS.info:\n          (_console2 = console).info.apply(_console2, loggerMessageArgs);\n\n          break;\n\n        case LEVELS.warn:\n          (_console3 = console).warn.apply(_console3, loggerMessageArgs);\n\n          break;\n\n        case LEVELS.error:\n          (_console4 = console).error.apply(_console4, loggerMessageArgs);\n\n          break;\n\n        default:\n          (_console5 = console).log.apply(_console5, loggerMessageArgs);\n\n      }\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nexport { LEVELS, log };\n//# sourceMappingURL=util-logger.module.js.map\n","import * as logger from \"@onflow/util-logger\"\n\nexport const deprecate = async ({title, message, level, always}) => {\n  await logger.log({title, message, level, always})\n}\n","import {verifyUserSignatures as verify} from \"../app-utils\"\nimport {deprecate} from \"../utils/deprecate\"\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @deprecated since version '1.0.0-alpha.0', use AppUtils.verifyUserSignatures instead\n *\n */\nexport async function verifyUserSignatures(message, compSigs) {\n  deprecate({\n    title: \"FCL Deprecation Notice\",\n    message: `\n    fcl.verifyUserSignatures() is deprecated and will be removed in a future release\n    Please use fcl.AppUtils.verifyUserSignatures()`,\n    level: 2,\n    always: true,\n  })\n  return verify(message, compSigs)\n}\n","import {interaction, pipe} from \"@onflow/sdk\"\nimport {resolve as defaultResolve} from \"@onflow/sdk\"\nimport {config, createSignableVoucher} from \"@onflow/sdk\"\n\nexport const serialize = async (args = [], opts = {}) => {\n  const resolveFunction = await config.first(\n    [\"sdk.resolve\"],\n    opts.resolve || defaultResolve\n  )\n\n  if (Array.isArray(args)) args = await pipe(interaction(), args)\n\n  return JSON.stringify(\n    createSignableVoucher(await resolveFunction(args)),\n    null,\n    2\n  )\n}\n","import {spawn, subscriber, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {\n  config,\n  block,\n  getEventsAtBlockHeightRange,\n  send,\n  decode\n} from \"@onflow/sdk\"\n\nconst RATE = 10000\nconst UPDATED = \"UPDATED\"\nconst TICK = \"TICK\"\nconst HIGH_WATER_MARK = \"hwm\"\n\nconst scheduleTick = async ctx => {\n  return setTimeout(\n    () => ctx.sendSelf(TICK),\n    await config().get(\"fcl.eventPollRate\", RATE)\n  )\n}\n\nconst HANDLERS = {\n  [TICK]: async ctx => {\n    if (!ctx.hasSubs()) return\n    let hwm = ctx.get(HIGH_WATER_MARK)\n    if (hwm == null) {\n      ctx.put(HIGH_WATER_MARK, await block())\n      ctx.put(TICK, await scheduleTick(ctx))\n    } else {\n      let next = await block()\n      ctx.put(HIGH_WATER_MARK, next)\n      const data = await send([\n        getEventsAtBlockHeightRange(ctx.self(), hwm.height, next.height - 1),\n      ]).then(decode)\n      for (let d of data) ctx.broadcast(UPDATED, d.data)\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n  },\n  [SUBSCRIBE]: async (ctx, letter) => {\n    if (!ctx.hasSubs()) {\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n    ctx.subscribe(letter.from)\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n    if (!ctx.hasSubs()) {\n      clearTimeout(ctx.get(TICK))\n      ctx.delete(TICK)\n      ctx.delete(HIGH_WATER_MARK)\n    }\n  },\n}\n\nconst spawnEvents = key => spawn(HANDLERS, key)\n\nexport function events(key) {\n  return {\n    subscribe: callback => subscriber(key, spawnEvents, callback),\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {VERSION} from \"../VERSION\"\n\nconst asyncPipe = (...fns) => input => fns.reduce((chain, fn) => chain.then(fn), Promise.resolve(input))\n\nasync function addServices(services = []) {\n  const endpoint = await config.get(\"discovery.authn.endpoint\")\n  invariant(Boolean(endpoint), `\"discovery.authn.endpoint\" in config must be defined.`)\n\n  const include = await config.get(\"discovery.authn.include\", [])\n  const url = new URL(endpoint)\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      fclVersion: VERSION,\n      include\n    })\n  }).then(d => d.json())\n  .then(json => [...services, ...json])\n}\n\nfunction addExtensions(services = []) {\n  const extensions = window.fcl_extensions || []\n  return [...extensions, ...services]\n}\n\nfunction filterServicesByType(services = [], type) {\n  return services.filter(service => service.type === type)\n}\n\nexport const getServices = ({ type }) => asyncPipe(\n  addServices,\n  addExtensions,\n  s => filterServicesByType(s, type)\n)([])","import {spawn, subscriber, snapshoter, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {getServices} from \"../services\"\n\nconst NAME = \"authn\"\nconst RESULTS = \"results\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst UPDATED = \"UPDATED\"\n\nconst warn = (fact, msg) => {\n  if (fact) {\n    console.warn(\n      `\n      %cFCL Warning\n      ============================\n      ${msg}\n      For more info, please see the docs: https://docs.onflow.org/fcl/\n      ============================\n      `,\n      \"font-weight:bold;font-family:monospace;\"\n    )\n  }\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    warn(typeof window === \"undefined\", '\"fcl.discovery\" is only available in the browser.')\n    const services = await getServices({ type: NAME })\n    ctx.put(RESULTS, services)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => ctx.unsubscribe(letter.from),\n  [SNAPSHOT]: async (ctx, letter) => letter.reply({...ctx.all()}),\n}\n\nconst spawnProviders = () => spawn(HANDLERS, NAME)\n\nconst authn = {\n  subscribe: cb => subscriber(NAME, spawnProviders, cb),\n  snapshot: () => snapshoter(NAME, spawnProviders)\n}\n\nexport default authn\n","import authn from \"./services/authn\"\n\nconst discovery = {\n  authn\n}\n\nexport {discovery}","import \"./default-config\"\nexport {VERSION} from \"./VERSION\"\nexport {query} from \"./exec/query\"\nexport {mutate} from \"./exec/mutate\"\nexport {verifyUserSignatures} from \"./exec/verify\"\nexport {serialize} from \"./serialize\"\nexport {transaction as tx} from \"./transaction\"\nexport {events} from \"./events\"\n\nimport {currentUser} from \"./current-user\"\nexport {currentUser}\n\nimport {discovery} from \"./discovery\"\nexport {discovery}\n\nexport const authenticate = (opts = {}) => currentUser().authenticate(opts)\nexport const unauthenticate = () => currentUser().unauthenticate()\nexport const reauthenticate = (opts = {}) => {\n  currentUser().unauthenticate()\n  return currentUser().authenticate(opts)\n}\nexport const signUp = (opts = {}) => currentUser().authenticate(opts)\nexport const logIn = (opts = {}) => currentUser().authenticate(opts)\n\nexport const authz = currentUser().authorization\n\nimport * as types from \"@onflow/types\"\nexport const t = types\n\nimport * as WalletUtils from \"./wallet-utils\"\nexport {WalletUtils}\n\nimport * as AppUtils from \"./app-utils\"\nexport {AppUtils}\n\nexport {TestUtils} from \"@onflow/sdk\"\nexport {config} from \"@onflow/config\"\nexport {send} from \"@onflow/sdk\"\nexport {decode} from \"@onflow/sdk\"\nexport {account} from \"@onflow/sdk\"\nexport {block} from \"@onflow/sdk\"\nexport {isOk, isBad, why, pipe, build} from \"@onflow/sdk\"\nexport {withPrefix, sansPrefix, display} from \"@onflow/util-address\"\nexport {template as cadence} from \"@onflow/util-template\"\nexport {template as cdc} from \"@onflow/util-template\"\nexport {createSignableVoucher} from \"@onflow/sdk\"\nexport {voucherIntercept} from \"@onflow/sdk\"\nexport {voucherToTxId} from \"@onflow/sdk\"\n\n// builders\nexport {transaction} from \"@onflow/sdk\"\nexport {script} from \"@onflow/sdk\"\nexport {ping} from \"@onflow/sdk\"\nexport {atBlockHeight} from \"@onflow/sdk\"\nexport {atBlockId} from \"@onflow/sdk\"\nexport {getAccount} from \"@onflow/sdk\"\nexport {getEvents} from \"@onflow/sdk\"\nexport {getEventsAtBlockHeightRange} from \"@onflow/sdk\"\nexport {getEventsAtBlockIds} from \"@onflow/sdk\"\nexport {getBlock} from \"@onflow/sdk\"\nexport {getBlockHeader} from \"@onflow/sdk\"\nexport {getCollection} from \"@onflow/sdk\"\nexport {getTransactionStatus} from \"@onflow/sdk\"\nexport {getTransaction} from \"@onflow/sdk\"\nexport {authorizations, authorization} from \"@onflow/sdk\"\nexport {args, arg} from \"@onflow/sdk\"\nexport {proposer} from \"@onflow/sdk\"\nexport {payer} from \"@onflow/sdk\"\nexport {limit} from \"@onflow/sdk\"\nexport {ref} from \"@onflow/sdk\"\nexport {params, param} from \"@onflow/sdk\"\nexport {validator} from \"@onflow/sdk\"\nexport {invariant} from \"@onflow/sdk\"\n"],"names":["VERSION","isServerSide","window","SESSION_STORAGE","can","get","key","JSON","parse","sessionStorage","getItem","put","value","setItem","stringify","STORAGE_DEFAULT","DISCOVERY_METHOD","configLens","regex","Object","fromEntries","entries","config","where","map","replace","getDiscoveryService","discoveryWallet","first","discoveryAuthnInclude","discoveryWalletMethod","type","endpoint","method","is","d","isRequired","isObject","isString","isFunc","isNumber","normalizeArgs","ax","sdk","arg","t","query","opts","preQuery","send","script","cadence","args","limit","then","decode","invariant","fetchServices","servicesURL","code","url","URL","searchParams","append","resp","fetch","headers","json","Array","isArray","services","authorizations","service","push","keyId","provider","id","mergeServices","sx1","sx2","SERVICE_PRAGMA","f_type","f_vsn","IDENTITY_PRAGMA","USER_PRAGMA","POLLING_RESPONSE_PRAGMA","COMPOSITE_SIGNATURE_PRAGMA","normalizeAuthn","uid","authn","pid","address","withPrefix","addr","name","icon","normalizeAuthz","identity","params","data","normalizePreAuthz","normalizeFrame","old","normalizeBackChannelRpc","normalizeOpenId","normalizeUserSignature","Error","normalizeLocalView","normalizeAccountProof","normalizeAuthnRefresh","serviceNormalizers","authz","frame","normalizeService","normalized","error","console","deriveCompositeId","rlp","encode","toString","normalizeData","paddr","findService","find","buildUser","hks","cid","loggedIn","expiresAt","expires","serviceOfType","serviceEndpoint","location","origin","fetchService","body","undefined","normalizePollingResponse","status","reason","compositeSignature","updates","authorizationUpdates","local","OPTIONS","serviceMethod","poll","canContinue","Promise","r","setTimeout","FRAME","FRAME_STYLES","renderFrame","src","document","getElementById","$frame","createElement","allow","frameBorder","style","cssText","unmount","remove","contentWindow","POP","popup","previousUrl","popupWindow","windowName","win","w","h","y","top","outerHeight","screenY","x","outerWidth","screenX","open","renderPop","closed","focus","close","tab","renderTab","VIEWS","execLocal","execHttpPost","signable","fclVersion","_","serviceResponse","catch","CLOSE_EVENT","READY_EVENT","RESPONSE_EVENT","e","toLowerCase","IGNORE","Set","deprecate","was","want","warn","buildMessageHandler","onReady","onResponse","onMessage","has","noop","onClose","addEventListener","removeEventListener","msg","postMessage","execIframeRPC","resolve","reject","includeOlderJsonRpcCall","deprecated","message","jsonrpc","result","pop","$pop","timer","setInterval","clearInterval","execPopRPC","redir","$tab","execTabRPC","extension","execExtRPC","STRATEGIES","execService","fullConfig","app","client","fclLibrary","hostname","extensions","fcl_extensions","res","normalizeCompositeSignature","sansPrefix","signature","sig","NAME","UPDATED","SNAPSHOT","SET_CURRENT_USER","DEL_CURRENT_USER","DATA","getStoredUser","storage","fallback","stored","removeItem","HANDLERS","INIT","ctx","merge","user","notExpired","SUBSCRIBE","letter","subscribe","from","all","UNSUBSCRIBE","unsubscribe","reply","broadcast","spawnCurrentUser","spawn","Date","now","getAccountProofData","accountProofDataResolver","accountProofData","appIdentifier","test","nonce","authenticate","snapshot","discoveryService","refreshService","response","unauthenticate","normalizePreAuthzResponse","proposer","payer","authorization","resolvePreAuthz","axs","az","role","tempId","join","signingFunction","authorizer","account","preSignable","preAuthz","sequenceNum","callback","EXIT","self","receive","tag","expectReply","timeout","resolveArgument","Address","makeSignable","signUserMessage","signingService","compSigs","currentUser","RATE","POLL","fetchTxStatus","transactionId","fclSend","getTransactionStatus","isExpired","tx","isSealed","isExecuted","isFinalized","isPending","isUnknown","isDiff","cur","next","sendSelf","scoped","spawnTransaction","transaction","snapshoter","subscriber","once","predicate","innerOnce","suppress","unsub","txStatus","statusCode","errorMessage","onceFinalized","onceExecuted","onceSealed","mutate","txid","prepMutation","onMessageFromFCL","messageType","cb","buildData","interaction","internal","sendMsgToFCL","parent","opener","ready","approve","decline","redirect","CompositeSignature","Number","rightPaddedHexBuffer","pad","Buffer","padEnd","leftPaddedHexBuffer","padStart","addressBuffer","nonceBuffer","encodeAccountProof","includeDomainTag","length","ACCOUNT_PROOF_DOMAIN_TAG","concat","rlpEncode","injectExtService","ACCOUNT_PROOF","USER_SIGNATURE","validateArgs","signatures","every","i","arr","cs","getVerifySignaturesScript","verifyFunction","network","fclCryptoContract","verifyAccountProof","signaturesArr","keyIndices","el","String","Int","verifyUserSignatures","promise","title","level","always","logger","verify","serialize","resolveFunction","defaultResolve","pipe","createSignableVoucher","TICK","HIGH_WATER_MARK","scheduleTick","hasSubs","hwm","block","getEventsAtBlockHeightRange","height","clearTimeout","delete","spawnEvents","events","asyncPipe","fns","input","reduce","chain","fn","addServices","Boolean","include","addExtensions","filterServicesByType","filter","getServices","s","RESULTS","fact","spawnProviders","discovery","reauthenticate","signUp","logIn","types"],"mappings":"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"}
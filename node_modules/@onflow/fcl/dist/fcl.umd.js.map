{"version":3,"file":"fcl.umd.js","sources":["../src/VERSION.js","../src/config-utils.js","../src/default-config.js","../src/exec/utils/is.js","../src/exec/utils/normalize-args.js","../src/exec/query.js","../src/current-user/fetch-services.js","../src/current-user/merge-services.js","../src/current-user/normalize/__vsn.js","../src/current-user/normalize/authn.js","../src/current-user/normalize/authz.js","../src/current-user/normalize/pre-authz.js","../src/current-user/normalize/frame.js","../src/current-user/normalize/back-channel-rpc.js","../src/current-user/normalize/open-id.js","../src/current-user/normalize/user-signature.js","../src/current-user/normalize/local-view.js","../src/current-user/normalize/account-proof.js","../src/current-user/normalize/authn-refresh.js","../src/current-user/normalize/service.js","../src/current-user/build-user.js","../src/current-user/service-of-type.js","../src/current-user/exec-service/strategies/utils/service-endpoint.js","../src/current-user/exec-service/strategies/utils/fetch-service.js","../src/current-user/normalize/polling-response.js","../src/current-user/exec-service/strategies/utils/poll.js","../src/current-user/exec-service/strategies/utils/render-frame.js","../src/current-user/exec-service/strategies/utils/render-pop.js","../src/current-user/exec-service/strategies/utils/render-tab.js","../src/current-user/exec-service/exec-local.js","../src/current-user/exec-service/strategies/http-post.js","../src/current-user/exec-service/strategies/utils/buildMessageHandler.js","../src/current-user/exec-service/strategies/utils/frame.js","../src/current-user/exec-service/strategies/iframe-rpc.js","../src/current-user/exec-service/strategies/utils/pop.js","../src/current-user/exec-service/strategies/pop-rpc.js","../src/current-user/exec-service/strategies/utils/tab.js","../src/current-user/exec-service/strategies/tab-rpc.js","../src/current-user/exec-service/strategies/utils/extension.js","../src/current-user/exec-service/strategies/ext-rpc.js","../src/current-user/exec-service/index.js","../src/current-user/normalize/composite-signature.js","../src/current-user/index.js","../src/transaction/index.js","../src/exec/mutate.js","../src/wallet-utils/on-message-from-fcl.js","../src/wallet-utils/send-msg-to-fcl.js","../src/wallet-utils/CompositeSignature.js","../src/wallet-utils/encode-account-proof.js","../src/wallet-utils/inject-ext-service.js","../src/app-utils/verify-signatures.js","../../util-logger/dist/util-logger.module.js","../src/utils/deprecate.js","../src/exec/verify.js","../src/serialize/index.js","../src/events/index.js","../src/discovery/services.js","../src/discovery/services/authn.js","../src/discovery/index.js","../src/fcl.js"],"sourcesContent":["export const VERSION = MICROBUNDLE_CURRENT_VERSION || \"TESTVERSION\"\n","import {config} from \"@onflow/config\"\nimport {VERSION} from \"./VERSION\"\n\nconst isServerSide = () => typeof window === \"undefined\"\n\nconst SESSION_STORAGE = {\n  can: !isServerSide(),\n  get: async key => JSON.parse(sessionStorage.getItem(key)),\n  put: async (key, value) => sessionStorage.setItem(key, JSON.stringify(value)),\n}\n\nconst LOCAL_STORAGE = {\n  can: !isServerSide(),\n  get: async key => JSON.parse(localStorage.getItem(key)),\n  put: async (key, value) => localStorage.setItem(key, JSON.stringify(value)),\n}\n\nconst NO_STORAGE = {\n  can: false,\n}\n\nexport const STORAGE_DEFAULT = SESSION_STORAGE\nexport const DISCOVERY_METHOD = \"IFRAME/RPC\"\n\nexport async function configLens(regex) {\n  return Object.fromEntries(\n    Object.entries(await config().where(regex)).map(([key, value]) => [\n      key.replace(regex, \"\"),\n      value,\n    ])\n  )\n}\n\nexport async function getDiscoveryService() {\n  const discoveryWallet = await config.first([\n    \"discovery.wallet\",\n    \"challenge.handshake\",\n  ])\n\n  const discoveryAuthnInclude = await config.get(\"discovery.authn.include\", [])\n\n  const discoveryWalletMethod = await config.first([\n    \"discovery.wallet.method\",\n    \"discovery.wallet.method.default\",\n  ])\n\n  return {\n    type: \"authn\",\n    endpoint: discoveryWallet,\n    method: discoveryWalletMethod,\n    discoveryAuthnInclude\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {DISCOVERY_METHOD, STORAGE_DEFAULT} from \"./config-utils\"\n\nconfig({\n  \"discovery.wallet.method.default\": DISCOVERY_METHOD,\n  \"fcl.storage.default\": STORAGE_DEFAULT,\n})\n","const is = type => d => typeof d === type\n\nexport const isRequired = d => d != null\nexport const isObject = is(\"object\")\nexport const isString = is(\"string\")\nexport const isFunc = is(\"function\")\nexport const isNumber = is(\"number\")\n","import {isFunc} from \"./is\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\n\nexport function normalizeArgs(ax) {\n  if (isFunc(ax)) return ax(sdk.arg, t)\n  return []\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport * as t from \"@onflow/types\"\nimport {isRequired, isObject, isString, isFunc} from \"./utils/is\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\n\n/** Query the Flow Blockchain\n *\n *  @arg {Object} opts         - Query Options and configuration\n *  @arg {string} opts.cadence - Cadence Script used to query Flow\n *  @arg {ArgsFn} opts.args    - Arguments passed to cadence script\n *  @arg {number} opts.limit   - Compute Limit for Query\n *  @returns {Promise<Response>}\n *\n *  Where:\n *    @callback ArgsFn\n *    @arg {ArgFn}  arg - Argument function to define a single argument\n *    @arg {Object} t   - Cadence Types object used to define the type\n *    @returns {args[]}\n *\n *    @callback ArgFn\n *    @arg {Any}  value - the value of the argument\n *    @arg {Type} type  - the cadence type of the value\n *    @returns {arg}\n *\n *  Example:\n *    const cadence = `\n *      cadence: `\n *        pub fun main(a: Int, b: Int, c: Address): Int {\n *          log(c)\n *          return a + b\n *        }\n *    `.trim()\n *\n *    const args = (arg, t) => [\n *      arg(5, t.Int),\n *      arg(7, t.Int),\n *      arg(\"0xb2db43ad6bc345fec9\", t.Address),\n *    ]\n *\n *    await query({ cadence, args })\n */\nexport async function query(opts = {}) {\n  await preQuery(opts)\n\n  // prettier-ignore\n  return sdk.send([\n    sdk.script(opts.cadence),\n    sdk.args(normalizeArgs(opts.args || [])),\n    opts.limit && typeof opts.limit === \"number\" && sdk.limit(opts.limit)\n  ]).then(sdk.decode)\n}\n\nasync function preQuery(opts) {\n  invariant(\n    isRequired(opts.cadence),\n    \"query({ cadence }) -- cadence is required\"\n  )\n\n  invariant(\n    isString(opts.cadence),\n    \"query({ cadence }) -- cadence must be a string\"\n  )\n\n  invariant(\n    await sdk.config.get(\"accessNode.api\"),\n    `Required value for \"accessNode.api\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`\n  )\n}\n","export async function fetchServices(servicesURL, code) {\n  if (servicesURL == null || code == null) return []\n\n  const url = new URL(servicesURL)\n  url.searchParams.append(\"code\", code)\n\n  const resp = await fetch(url, {\n    method: \"GET\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  }).then(d => d.json())\n\n  if (Array.isArray(resp)) return resp\n\n  // Backwards compatibility for First-Gen Wallet Providers\n  const services = []\n\n  // Convert authorizations into authz services\n  if (Array.isArray(resp.authorizations)) {\n    for (let service of resp.authorizations) {\n      services.push({\n        type: \"authz\",\n        keyId: resp.keyId,\n        ...service,\n      })\n    }\n  }\n\n  // Convert Provider info into an authn service\n  if (resp.provider != null) {\n    services.push({\n      type: \"authn\",\n      id: \"wallet-provider#authn\",\n      ...resp.provider,\n    })\n  }\n\n  return services\n}\n","import {withPrefix} from \"@onflow/util-address\"\n\nexport function mergeServices(sx1 = [], sx2 = []) {\n  // TODO: Make this smarter\n  return [...sx1, ...sx2]\n}\n","export const SERVICE_PRAGMA = {\n  f_type: \"Service\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const IDENTITY_PRAGMA = {\n  f_type: \"Identity\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const PROVIDER_PRAGMA = {\n  f_type: \"Provider\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const USER_PRAGMA = {\n  f_type: \"USER\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const POLLING_RESPONSE_PRAGMA = {\n  f_type: \"PollingResponse\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const COMPOSITE_SIGNATURE_PRAGMA = {\n  f_type: \"CompositeSignature\",\n  f_vsn: \"1.0.0\",\n}\n\nexport const OPEN_ID_PRAGMA = {\n  f_type: \"OpenId\",\n  f_vsn: \"1.0.0\",\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"identity\": {\n//     \"address\": \"0x____\"\n//   },\n//   \"provider\": {\n//     \"address\": \"0x____\",\n//     \"name\": \"Best Wallet\",\n//     \"description\": \"The Best Wallet\"\n//     \"icon\": \"https://\",\n//   }\n// }\nexport function normalizeAuthn(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.authn,\n        id: service.pid,\n        provider: {\n          address: withPrefix(service.addr),\n          name: service.name,\n          icon: service.icon,\n        },\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {SERVICE_PRAGMA, IDENTITY_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"pre-authz\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"identity\": {\n//      \"address\": \"0x______\",\n//      \"keyId\": 0,\n//   },\n//   \"data\": {}, // included in body of pre-authz request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizePreAuthz(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: service.type,\n        uid: service.id,\n        endpoint: service.endpoint,\n        method: service.method,\n        identity: {\n          ...IDENTITY_PRAGMA,\n          address: withPrefix(service.addr),\n          keyId: service.keyId,\n        },\n        params: service.params,\n        data: service.data,\n      }\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"frame\",\n//    \"endpoint\": \"https://rawr\",\n//    \"data\": {},   // Sent to frame when ready\n//    \"params\": {}, // include in query params on frame\n// }\nexport function normalizeFrame(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        old: service,\n        ...SERVICE_PRAGMA,\n        type: \"frame\",\n        endpoint: service.endpoint,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"type\": \"back-channel-rpc\",\n//    \"endpoint\": \"https://rawr\",\n//    \"method\": \"HTTP/GET\", // HTTP/GET | HTTP/POST\n//    \"data\": {},           // included in body of rpc\n//    \"params\": {},         // included as query params on endpoint url\n// }\nexport function normalizeBackChannelRpc(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: \"back-channel-rpc\",\n        endpoint: service.endpoint,\n        method: service.method,\n        params: service.params || {},\n        data: service.data || {},\n      }\n  }\n}\n","import {SERVICE_PRAGMA, OPEN_ID_PRAGMA} from \"./__vsn\"\n\n// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"open-id\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"method: \"data\",\n//   \"data\": {\n//      \"profile\": {\n//        \"name\": \"Bob\",\n//        \"family_name\": \"Builder\",\n//        \"given_name\": \"Robert\",\n//        \"middle_name\": \"the\",\n//        \"nickname\": \"Bob the Builder\",\n//        \"perferred_username\": \"bob\",\n//        \"profile\": \"https://www.bobthebuilder.com/\",\n//        \"picture\": \"https://avatars.onflow.org/avatar/bob\",\n//        \"gender\": \"...\",\n//        \"birthday\": \"2001-01-18\",\n//        \"zoneinfo\": \"America/Vancouver\",\n//        \"locale\": \"en-us\",\n//        \"updated_at\": \"1614970797388\"\n//      },\n//      \"email\": {\n//        \"email\": \"bob@bob.bob\",\n//        \"email_verified\": true\n//      },\n//      \"address\": {\n//        \"address\": \"One Apple Park Way, Cupertino, CA 95014, USA\"\n//      },\n//      \"phone\": {\n//        \"phone_number\": \"+1 (xxx) yyy-zzzz\",\n//        \"phone_number_verified\": true\n//      },\n//      \"social\": {\n//        \"twitter\": \"@_qvvg\",\n//        \"twitter_verified\": true\n//      },\n//   }\n// }\nexport function normalizeOpenId(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      return null\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"user-signature\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"IFRAME/RPC\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of user-signature request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeUserSignature(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(\"Invalid user-signature service\")\n  }\n}\n","import {SERVICE_PRAGMA} from \"./__vsn\"\n\n// {\n//    \"f_type\": \"Service\",\n//    \"f_vsn\": \"1.0.0\",\n//    type: \"local-view\",\n//    method: \"VIEW/IFRAME\",\n//    endpoint: \"https://woot.org/authz/local\",\n//    data: {},\n//    params: {},\n// }\nexport function normalizeLocalView(resp) {\n  if (resp == null) return null\n  if (resp.method == null) {\n    resp = {...resp, type: \"local-view\", method: \"VIEW/IFRAME\"}\n  }\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...SERVICE_PRAGMA,\n        type: resp.type || \"local-view\",\n        method: resp.method,\n        endpoint: resp.endpoint,\n        data: resp.data || {},\n        params: resp.params || {},\n      }\n  }\n}\n","// {\n//   \"f_type\": \"Service\",                    // Its a service!\n//   \"f_vsn\": \"1.0.0\",                       // Follows the v1.0.0 spec for the service\n//   \"type\": \"account-proof\",                // the type of service it is\n//   \"method\": \"DATA\",                       // Its data!\n//   \"uid\": \"awesome-wallet#account-proof\",  // A unique identifier for the service\n//   \"data\": {\n//     \"f_type\": \"account-proof\",\n//     \"f_vsn\": \"1.0.0\",\n//     \"nonce\": \"0A1BC2FF\",                  // Nonce signed by the current account-proof (minimum 32 bytes in total, i.e 64 hex characters)\n//     \"address\": \"0xUSER\",                  // The user's address (8 bytes, i.e 16 hex characters)\n//     \"signature\": CompositeSignature,      // address (sans-prefix), keyId, signature (hex)\n// }\n\nexport function normalizeAccountProof(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(`FCL Normalizer Error: Invalid account-proof service`)\n  }\n}\n","// {\n//   \"f_type\": \"Service\",\n//   \"f_vsn\": \"1.0.0\",\n//   \"type\": \"authn-refresh\",\n//   \"uid\": \"uniqueDedupeKey\",\n//   \"endpoint\": \"https://rawr\",\n//   \"method\": \"HTTP/POST\",  // \"HTTP/POST\", // HTTP/POST | IFRAME/RPC | HTTP/RPC\n//   \"id\": \"xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx\", // wallets internal id for the user\n//   \"data\": {}, // included in body of request\n//   \"params\": {}, // included as query params on endpoint url\n// }\nexport function normalizeAuthnRefresh(service) {\n  if (service == null) return null\n\n  switch (service[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return service\n\n    default:\n      throw new Error(\"Invalid authn-refresh service\")\n  }\n}\n","import {normalizeAuthn} from \"./authn\"\nimport {normalizeAuthz} from \"./authz\"\nimport {normalizePreAuthz} from \"./pre-authz\"\nimport {normalizeFrame} from \"./frame\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeOpenId} from \"./open-id\"\nimport {normalizeUserSignature} from \"./user-signature\"\nimport {normalizeLocalView} from \"./local-view\"\nimport {normalizeAccountProof} from \"./account-proof\"\nimport {normalizeAuthnRefresh} from \"./authn-refresh\"\n\nexport function normalizeServices(services, data) {\n  return services.map(service => normalizeService(service, data))\n}\n\nconst serviceNormalizers = {\n  \"back-channel-rpc\": normalizeBackChannelRpc,\n  \"pre-authz\": normalizePreAuthz,\n  authz: normalizeAuthz,\n  authn: normalizeAuthn,\n  frame: normalizeFrame,\n  \"open-id\": normalizeOpenId,\n  \"user-signature\": normalizeUserSignature,\n  \"local-view\": normalizeLocalView,\n  \"account-proof\": normalizeAccountProof,\n  \"authn-refresh\": normalizeAuthnRefresh,\n}\n\nexport function normalizeService(service, data) {\n  try {\n    var normalized = serviceNormalizers[service.type](service, data)\n    return normalized\n  } catch (error) {\n    console.error(\n      `Unrecognized FCL Service Type [${service.type}]`,\n      service,\n      error\n    )\n    return service\n  }\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport * as rlp from \"@onflow/rlp\"\nimport {fetchServices} from \"./fetch-services\"\nimport {mergeServices} from \"./merge-services\"\nimport {USER_PRAGMA} from \"./normalize/__vsn\"\nimport {normalizeService} from \"./normalize/service\"\n\nfunction deriveCompositeId(authn) {\n  return rlp\n    .encode([\n      authn.provider.address || authn.provider.name || \"UNSPECIFIED\",\n      authn.id,\n    ])\n    .toString(\"hex\")\n}\n\nfunction normalizeData(data) {\n  data.addr = data.addr ? withPrefix(data.addr) : null\n  data.paddr = data.paddr ? withPrefix(data.paddr) : null\n  return data\n}\n\nfunction findService(type, services) {\n  return services.find(d => d.type === type)\n}\n\nexport async function buildUser(data) {\n  data = normalizeData(data)\n\n  var services = mergeServices(\n    data.services || [],\n    await fetchServices(data.hks, data.code)\n  ).map(service => normalizeService(service, data))\n\n  const authn = findService(\"authn\", services)\n\n  return {\n    ...USER_PRAGMA,\n    addr: withPrefix(data.addr),\n    cid: deriveCompositeId(authn),\n    loggedIn: true,\n    services: services,\n    expiresAt: data.expires,\n  }\n}\n","export function serviceOfType(services = [], type) {\n  return services.find(service => service.type === type)\n}\n","export function serviceEndpoint(service) {\n  const url = new URL(service.endpoint)\n  url.searchParams.append(\"l6n\", window.location.origin)\n  if (service.params != null) {\n    for (let [key, value] of Object.entries(service.params || {})) {\n      url.searchParams.append(key, value)\n    }\n  }\n  return url\n}\n","import {serviceEndpoint} from \"./service-endpoint\"\n\nexport function fetchService(service, opts = {}) {\n  const method = opts.method || \"POST\"\n  const body =\n    method === \"GET\"\n      ? undefined\n      : JSON.stringify(opts.data || service.data || {})\n\n  return fetch(serviceEndpoint(service), {\n    method: method,\n    headers: {\n      ...(service.headers || {}),\n      ...(opts.headers || {}),\n      \"Content-Type\": \"application/json\",\n    },\n    body: body,\n  }).then((d) => d.json())\n}\n","import {POLLING_RESPONSE_PRAGMA} from \"./__vsn\"\nimport {normalizeBackChannelRpc} from \"./back-channel-rpc\"\nimport {normalizeFrame} from \"./frame\"\n\n// {\n//    \"f_type\": \"PollingResponse\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"status\": \"PENDING\", // PENDING | APPROVED | DECLINED | REDIRECT\n//    \"reason\": null,      // Reason for Declining Transaction\n//    \"data\": null,        // Return value for APPROVED\n//    \"updates\": BackChannelRpc,\n//    \"local\": Frame,\n// }\nexport function normalizePollingResponse(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...POLLING_RESPONSE_PRAGMA,\n        status: resp.status ?? \"APPROVED\",\n        reason: resp.reason ?? null,\n        data: resp.compositeSignature || resp.data || {...resp} || {},\n        updates: normalizeBackChannelRpc(resp.authorizationUpdates),\n        local: normalizeFrame((resp.local || [])[0]),\n      }\n  }\n}\n","import {normalizePollingResponse} from \"../../../normalize/polling-response\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {fetchService} from \"./fetch-service\"\n\nconst OPTIONS = {\n  \"HTTP/GET\": \"GET\",\n  \"HTTP/POST\": \"POST\",\n}\n\nconst serviceMethod = service => {\n  invariant(\n    OPTIONS[service.method],\n    \"Invalid Service Method for type back-channel-rpc\",\n    {service}\n  )\n  return OPTIONS[service.method]\n}\n\nconst serviceBody = service => {\n  if (service.method === \"HTTP/GET\") return undefined\n  if (service.method === \"HTTP/POST\" && service.data != null)\n    return JSON.stringify(service.data)\n  return undefined\n}\n\nexport async function poll(service, canContinue = () => true) {\n  invariant(service, \"Missing Polling Service\", {service})\n  if (!canContinue()) throw new Error(\"Externally Halted\")\n\n  const resp = await fetchService(service, {\n    method: serviceMethod(service),\n  }).then(normalizePollingResponse)\n\n  switch (resp.status) {\n    case \"APPROVED\":\n      return resp.data\n    case \"DECLINED\":\n      throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n    default:\n      await new Promise(r => setTimeout(r, 500))\n      return poll(resp.updates, canContinue)\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\n\nconst FRAME = \"FCL_IFRAME\"\n\nconst FRAME_STYLES = `\n  position:fixed;\n  top: 0px;\n  right: 0px;\n  bottom: 0px;\n  left: 0px;\n  height: 100%;\n  width: 100vw;\n  display:block;\n  background:rgba(0,0,0,0.25);\n  z-index: 2147483647;\n  box-sizing: border-box;\n`\n\nexport function renderFrame(src) {\n  invariant(\n    !document.getElementById(FRAME),\n    \"Attempt at triggering multiple Frames\",\n    {src}\n  )\n\n  const $frame = document.createElement(\"iframe\")\n  $frame.src = src\n  $frame.id = FRAME\n  $frame.allow = \"usb *; hid *\"\n  $frame.frameBorder = \"0\"\n  $frame.style.cssText = FRAME_STYLES\n  document.body.append($frame)\n\n  const unmount = () => {\n    if (document.getElementById(FRAME)) {\n      document.getElementById(FRAME).remove()\n    }\n  }\n\n  return [$frame.contentWindow, unmount]\n}\n","const POP = \"FCL_POP\"\n\nlet popup = null\nlet previousUrl = null\n\nfunction popupWindow(url, windowName, win, w, h) {\n  const y = win.top.outerHeight / 2 + win.top.screenY - h / 2\n  const x = win.top.outerWidth / 2 + win.top.screenX - w / 2\n  return win.open(\n    url,\n    windowName,\n    `toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=no, resizable=no, copyhistory=no, width=${w}, height=${h}, top=${y}, left=${x}`\n  )\n}\n\nexport function renderPop(src) {\n  if (popup == null || popup?.closed) {\n    popup = popupWindow(src, POP, window, 640, 770)\n  } else if (previousUrl !== src) {\n    popup.location.replace(src)\n    popup.focus()\n  } else {\n    popup.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (popup && !popup.closed) {\n      popup.close()\n    }\n    popup = null\n  }\n\n  return [popup, unmount]\n}\n","const TAB = \"FCL_TAB\"\n\nlet tab = null\nlet previousUrl = null\n\nexport function renderTab(src) {\n  if (tab == null || tab?.closed) {\n    tab = window.open(src, \"_blank\")\n  } else if (previousUrl !== src) {\n    tab.location.replace(src)\n    tab.focus()\n  } else {\n    tab.focus()\n  }\n\n  previousUrl = src\n\n  const unmount = () => {\n    if (tab && !tab.closed) {\n      tab.close()\n    }\n    tab = null\n  }\n\n  return [tab, unmount]\n}\n","import {renderFrame} from \"./strategies/utils/render-frame\"\nimport {renderPop} from \"./strategies/utils/render-pop\"\nimport {renderTab} from \"./strategies/utils/render-tab\"\nimport {serviceEndpoint} from \"./strategies/utils/service-endpoint\"\n\nconst VIEWS = {\n  \"VIEW/IFRAME\": renderFrame,\n  \"VIEW/POP\": renderPop,\n  \"VIEW/TAB\": renderTab,\n}\n\nexport async function execLocal(service, opts = {}) {\n  try {\n    return VIEWS[service.method](serviceEndpoint(service), opts)\n  } catch (error) {\n    console.error(\"execLocal({service, opts = {}})\", error, {service, opts})\n    throw error\n  }\n}\n","import {fetchService} from \"./utils/fetch-service\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {normalizeLocalView} from \"../../normalize/local-view\"\nimport {poll} from \"./utils/poll\"\nimport {execLocal} from \"../exec-local\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport async function execHttpPost(service, signable, opts, config) {\n  const resp = await fetchService(service, {\n    data: {\n      fclVersion: VERSION,\n      service: {\n        params: service.params,\n        data: service.data,\n        type: service.type,\n      },\n      config,\n      ...signable,\n    },\n  }).then(normalizePollingResponse)\n\n  if (resp.status === \"APPROVED\") {\n    return resp.data\n  } else if (resp.status === \"DECLINED\") {\n    throw new Error(`Declined: ${resp.reason || \"No reason supplied.\"}`)\n  } else if (resp.status === \"REDIRECT\") {\n    return resp\n  } else if (resp.status === \"PENDING\") {\n    var canContinue = true\n    const [_, unmount] = await execLocal(normalizeLocalView(resp.local))\n\n    const close = () => {\n      try {\n        unmount()\n        canContinue = false\n      } catch (error) {\n        console.error(\"Frame Close Error\", error)\n      }\n    }\n\n    return poll(resp.updates, () => canContinue)\n      .then(serviceResponse => {\n        close()\n        return serviceResponse\n      })\n      .catch(error => {\n        console.error(error)\n        close()\n        throw error\n      })\n  } else {\n    console.error(`Auto Decline: Invalid Response`, {service, resp})\n    throw new Error(`Auto Decline: Invalid Response`)\n  }\n}\n","const CLOSE_EVENT = \"FCL:VIEW:CLOSE\"\nconst READY_EVENT = \"FCL:VIEW:READY\"\nconst RESPONSE_EVENT = \"FCL:VIEW:RESPONSE\"\n\nconst _ = e => typeof e === \"string\" && e.toLowerCase()\n\nconst IGNORE = new Set([\n  \"monetizationstart\",\n  \"monetizationpending\",\n  \"monetizationprogress\",\n  \"monetizationstop\",\n])\n\nconst deprecate = (was, want) =>\n  console.warn(\n    \"DEPRECATION NOTICE\",\n    `Received ${was}, please use ${want} for this and future versions of FCL`\n  )\n\nexport const buildMessageHandler =\n  ({close, send, onReady, onResponse, onMessage}) =>\n  e => {\n    try {\n      if (typeof e.data !== \"object\") return\n      if (IGNORE.has(e.data.type)) return\n      if (_(e.data.type) === _(CLOSE_EVENT)) close()\n      if (_(e.data.type) === _(READY_EVENT)) onReady(e, {send, close})\n      if (_(e.data.type) === _(RESPONSE_EVENT)) onResponse(e, {send, close})\n      onMessage(e, {send, close})\n\n      // Backwards Compatible\n      if (_(e.data.type) === _(\"FCL:FRAME:READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL:FRAME:CLOSE\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      //\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::RESPONSE\")) {\n        deprecate(e.data.type, RESPONSE_EVENT)\n        onResponse(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::AUTHZ_READY\")) {\n        deprecate(e.data.type, READY_EVENT)\n        onReady(e, {send, close})\n      }\n      if (_(e.data.type) === _(\"FCL::CHALLENGE::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n      if (_(e.data.type) === _(\"FCL::CANCEL\")) {\n        deprecate(e.data.type, CLOSE_EVENT)\n        close()\n      }\n    } catch (error) {\n      console.error(\"Frame Callback Error\", error)\n      close()\n    }\n  }\n","import {renderFrame} from \"./render-frame\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function frame(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n  const [$frame, unmount] = renderFrame(serviceEndpoint(service))\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Frame Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $frame.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Frame Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {frame} from \"./utils/frame\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execIframeRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const includeOlderJsonRpcCall = opts.includeOlderJsonRpcCall\n\n    frame(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            fclVersion: VERSION,\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n              deprecated: {\n                message:\n                  \"jsonrpc is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n              },\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execIframeRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderPop} from \"./render-pop\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function pop(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n  const [$pop, unmount] = renderPop(serviceEndpoint(service))\n  const timer = setInterval(function () {\n    if ($pop && $pop.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Popup Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $pop.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Popup Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {pop} from \"./utils/pop\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execPopRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    pop(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {renderTab} from \"./render-tab\"\nimport {serviceEndpoint} from \"./service-endpoint\"\nimport {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function tab(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n  const [$tab, unmount] = renderTab(serviceEndpoint(service))\n  const timer = setInterval(function () {\n    if ($tab && $tab.closed) {\n      close()\n    }\n  }, 500)\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      clearInterval(timer)\n      unmount()\n      onClose()\n    } catch (error) {\n      console.error(\"Tab Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      $tab.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Tab Send Error\", msg, error)\n    }\n  }\n}\n","import {uid} from \"@onflow/util-uid\"\nimport {tab} from \"./utils/tab\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execTabRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    const id = uid()\n    const {redir, includeOlderJsonRpcCall} = opts\n\n    tab(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:FRAME:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n            deprecated: {\n              message:\n                \"FCL:FRAME:READY:RESPONSE is deprecated and replaced with type: FCL:VIEW:READY:RESPONSE\",\n            },\n          })\n          if (includeOlderJsonRpcCall) {\n            send({\n              jsonrpc: \"2.0\",\n              id: id,\n              method: \"fcl:sign\",\n              params: [body, service.params],\n            })\n          }\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onMessage(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          if (e.data.jsonrpc !== \"2.0\") return\n          if (e.data.id !== id) return\n          const resp = normalizePollingResponse(e.data.result)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              !redir && close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execPopRPC onMessage error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {buildMessageHandler} from \"./buildMessageHandler\"\n\nconst noop = () => {}\n\nexport function extension(service, opts = {}) {\n  if (service == null) return {send: noop, close: noop}\n\n  const onClose = opts.onClose || noop\n  const onMessage = opts.onMessage || noop\n  const onReady = opts.onReady || noop\n  const onResponse = opts.onResponse || noop\n\n  window.addEventListener(\n    \"message\",\n    buildMessageHandler({close, send, onReady, onResponse, onMessage})\n  )\n\n  send({service})\n\n  return {send, close}\n\n  function close() {\n    try {\n      window.removeEventListener(\"message\", buildMessageHandler)\n      onClose()\n    } catch (error) {\n      console.error(\"Ext Close Error\", error)\n    }\n  }\n\n  function send(msg) {\n    try {\n      window && window.postMessage(JSON.parse(JSON.stringify(msg || {})), \"*\")\n    } catch (error) {\n      console.error(\"Ext Send Error\", msg, error)\n    }\n  }\n}\n","import {invariant} from \"@onflow/util-invariant\"\nimport {extension} from \"./utils/extension\"\nimport {normalizePollingResponse} from \"../../normalize/polling-response\"\nimport {VERSION} from \"../../../VERSION\"\n\nexport function execExtRPC(service, body, opts, config) {\n  return new Promise((resolve, reject) => {\n    extension(service, {\n      async onReady(_, {send}) {\n        try {\n          send({\n            fclVersion: VERSION,\n            type: \"FCL:VIEW:READY:RESPONSE\",\n            body,\n            service: {\n              params: service.params,\n              data: service.data,\n              type: service.type,\n            },\n            config,\n          })\n        } catch (error) {\n          throw error\n        }\n      },\n\n      onResponse(e, {close}) {\n        try {\n          if (typeof e.data !== \"object\") return\n          const resp = normalizePollingResponse(e.data)\n\n          switch (resp.status) {\n            case \"APPROVED\":\n              resolve(resp.data)\n              close()\n              break\n\n            case \"DECLINED\":\n              reject(`Declined: ${resp.reason || \"No reason supplied\"}`)\n              close()\n              break\n\n            case \"REDIRECT\":\n              resolve(resp)\n              close()\n              break\n\n            default:\n              reject(`Declined: No reason supplied`)\n              close()\n              break\n          }\n        } catch (error) {\n          console.error(\"execExtRPC onResponse error\", error)\n          throw error\n        }\n      },\n\n      onClose() {\n        reject(`Declined: Externally Halted`)\n      },\n    })\n  })\n}\n","import {execHttpPost} from \"./strategies/http-post\"\nimport {execIframeRPC} from \"./strategies/iframe-rpc\"\nimport {execPopRPC} from \"./strategies/pop-rpc\"\nimport {execTabRPC} from \"./strategies/tab-rpc\"\nimport {execExtRPC} from \"./strategies/ext-rpc\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {configLens} from \"../../config-utils\"\nimport {VERSION} from \"../../VERSION\"\n\nconst STRATEGIES = {\n  \"HTTP/RPC\": execHttpPost,\n  \"HTTP/POST\": execHttpPost,\n  \"IFRAME/RPC\": execIframeRPC,\n  \"POP/RPC\": execPopRPC,\n  \"TAB/RPC\": execTabRPC,\n  \"EXT/RPC\": execExtRPC,\n}\n\nexport async function execService({service, msg = {}, opts = {}, config = {}}) {\n  msg.data = service.data\n  const fullConfig = {\n    ...config,\n    services: await configLens(/^service\\./),\n    app: await configLens(/^app\\.detail\\./),\n    client: {\n      fclVersion: VERSION,\n      fclLibrary: \"https://github.com/onflow/fcl-js\",\n      hostname: window?.location?.hostname ?? null,\n      extensions: window?.fcl_extensions || [],\n    },\n  }\n\n  try {\n    const res = await STRATEGIES[service.method](\n      service, \n      msg, \n      opts, \n      fullConfig\n    )\n    if (res.status === \"REDIRECT\") {\n      invariant(\n        service.type === res.data.type,\n        \"Cannot shift recursive service type in execService\"\n      )\n      return await execService({\n        service: res.data, \n        msg, \n        opts, \n        config: fullConfig\n      })\n    } else {\n      return res\n    }\n  } catch (error) {\n    console.error(\"execService({service, msg = {}, opts = {}, config = {}})\", error, {\n      service,\n      msg,\n      opts,\n      config\n    })\n    throw error\n  }\n}\n","import {COMPOSITE_SIGNATURE_PRAGMA} from \"./__vsn\"\nimport {sansPrefix} from \"@onflow/util-address\"\n\n// {\n//    \"f_type\": \"CompositeSignature\",\n//    \"f_vsn\": \"1.0.0\",\n//    \"addr\": \"_____\",         // sans-prefix\n//    \"signature\": \"adfe1234\", // hex\n//    \"keyId\": 3,\n// }\nexport function normalizeCompositeSignature(resp) {\n  if (resp == null) return null\n\n  switch (resp[\"f_vsn\"]) {\n    case \"1.0.0\":\n      return resp\n\n    default:\n      return {\n        ...COMPOSITE_SIGNATURE_PRAGMA,\n        addr: sansPrefix(resp.addr || resp.address),\n        signature: resp.signature || resp.sig,\n        keyId: resp.keyId,\n      }\n  }\n}\n","import \"../default-config\"\nimport * as t from \"@onflow/types\"\nimport {account, arg} from \"@onflow/sdk\"\nimport {config} from \"@onflow/config\"\nimport {spawn, send, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {withPrefix, sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {buildUser} from \"./build-user\"\nimport {serviceOfType} from \"./service-of-type\"\nimport {execService} from \"./exec-service\"\nimport {normalizeCompositeSignature} from \"./normalize/composite-signature\"\nimport {getDiscoveryService} from \"../config-utils\"\n\nconst NAME = \"CURRENT_USER\"\nconst UPDATED = \"CURRENT_USER/UPDATED\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst SET_CURRENT_USER = \"SET_CURRENT_USER\"\nconst DEL_CURRENT_USER = \"DEL_CURRENT_USER\"\n\nconst DATA = `{\n  \"f_type\": \"User\",\n  \"f_vsn\": \"1.0.0\",\n  \"addr\":null,\n  \"cid\":null,\n  \"loggedIn\":null,\n  \"expiresAt\":null,\n  \"services\":[]\n}`\n\nconst getStoredUser = async storage => {\n  const fallback = JSON.parse(DATA)\n  const stored = await storage.get(NAME)\n  if (stored != null && fallback[\"f_vsn\"] !== stored[\"f_vsn\"]) {\n    storage.removeItem(NAME)\n    return fallback\n  }\n  return stored || fallback\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    if (typeof window === \"undefined\") {\n      console.warn(\n        `\n        %cFCL Warning\n        ============================\n        \"currentUser\" is only available in the browser.\n        For more info, please see the docs: https://docs.onflow.org/fcl/\n        ============================\n        `,\n        \"font-weight:bold;font-family:monospace;\"\n      )\n    }\n\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) {\n      const user = await getStoredUser(storage)\n      if (notExpired(user)) ctx.merge(user)\n    }\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply({...ctx.all()})\n  },\n  [SET_CURRENT_USER]: async (ctx, letter, data) => {\n    ctx.merge(data)\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n  [DEL_CURRENT_USER]: async (ctx, letter) => {\n    ctx.merge(JSON.parse(DATA))\n    const storage = await config.first([\"fcl.storage\", \"fcl.storage.default\"])\n    if (storage.can) storage.put(NAME, ctx.all())\n    ctx.broadcast(UPDATED, {...ctx.all()})\n  },\n}\n\nconst spawnCurrentUser = () => spawn(HANDLERS, NAME)\n\nfunction notExpired(user) {\n  return (\n    user.expiresAt == null ||\n    user.expiresAt === 0 ||\n    user.expiresAt > Date.now()\n  )\n}\n\nasync function getAccountProofData() {\n  const accountProofDataResolver = await config.get(\"fcl.accountProof.resolver\")\n  const accountProofData =\n    accountProofDataResolver ?? (await accountProofDataResolver())\n\n  if (accountProofData == null) return\n\n  invariant(\n    typeof accountProofData.appIdentifier === \"string\",\n    \"appIdentifier must be a string\"\n  )\n  invariant(\n    /^[0-9a-f]+$/i.test(accountProofData.nonce),\n    \"Nonce must be a hex string\"\n  )\n\n  return accountProofData\n}\n\nasync function authenticate({service, redir = false} = {}) {\n  return new Promise(async (resolve, reject) => {\n    spawnCurrentUser()\n    const opts = {redir}\n    const user = await snapshot()\n    const discoveryService = await getDiscoveryService()\n    const refreshService = serviceOfType(user.services, \"authn-refresh\")\n    let accountProofData\n\n    try {\n      accountProofData = await getAccountProofData()\n    } catch (error) {\n      console.error(\n        `Error During Authentication: Could not resolve account proof data.\n        ${error}`\n      )\n      return reject(error)\n    }\n\n    invariant(\n      service || discoveryService.endpoint,\n      `\n        If no service passed to \"authenticate,\" then \"discovery.wallet\" must be defined in config.\n        See: \"https://docs.onflow.org/fcl/reference/api/#setting-configuration-values\"\n      `\n    )\n\n    if (user.loggedIn) {\n      if (refreshService) {\n        try {\n          const response = await execService({\n            service: refreshService,\n            msg: accountProofData,\n            opts,\n          })\n          send(NAME, SET_CURRENT_USER, await buildUser(response))\n        } catch (e) {\n          console.error(\"Error: Could not refresh authentication.\", e)\n        } finally {\n          return resolve(await snapshot())\n        }\n      } else {\n        return resolve(user)\n      }\n    }\n\n    try {\n      const response = await execService({\n        service: {\n          ...(service || discoveryService),\n          method: discoveryService?.method || service.method || \"IFRAME/RPC\",\n        },\n        msg: accountProofData,\n        opts,\n        config: {\n          discoveryAuthnInclude: discoveryService.discoveryAuthnInclude,\n        },\n      })\n      send(NAME, SET_CURRENT_USER, await buildUser(response))\n    } catch (e) {\n      console.error(\"Error while authenticating\", e)\n    } finally {\n      resolve(await snapshot())\n    }\n  })\n}\n\nfunction unauthenticate() {\n  spawnCurrentUser()\n  send(NAME, DEL_CURRENT_USER)\n}\n\nconst normalizePreAuthzResponse = authz => ({\n  f_type: \"PreAuthzResponse\",\n  f_vsn: \"1.0.0\",\n  proposer: (authz || {}).proposer,\n  payer: (authz || {}).payer || [],\n  authorization: (authz || {}).authorization || [],\n})\n\nfunction resolvePreAuthz(authz) {\n  const resp = normalizePreAuthzResponse(authz)\n  const axs = []\n\n  if (resp.proposer != null) axs.push([\"PROPOSER\", resp.proposer])\n  for (let az of resp.payer || []) axs.push([\"PAYER\", az])\n  for (let az of resp.authorization || []) axs.push([\"AUTHORIZER\", az])\n\n  var result = axs.map(([role, az]) => ({\n    tempId: [az.identity.address, az.identity.keyId].join(\"|\"),\n    addr: az.identity.address,\n    keyId: az.identity.keyId,\n    signingFunction(signable) {\n      return execService({service: az, msg: signable})\n    },\n    role: {\n      proposer: role === \"PROPOSER\",\n      payer: role === \"PAYER\",\n      authorizer: role === \"AUTHORIZER\",\n    },\n  }))\n  return result\n}\n\nasync function authorization(account) {\n  spawnCurrentUser()\n\n  return {\n    ...account,\n    tempId: \"CURRENT_USER\",\n    async resolve(account, preSignable) {\n      const user = await authenticate({redir: true})\n      const authz = serviceOfType(user.services, \"authz\")\n      const preAuthz = serviceOfType(user.services, \"pre-authz\")\n\n      if (preAuthz)\n        return resolvePreAuthz(\n          await execService({\n            service: preAuthz,\n            msg: preSignable,\n          })\n        )\n      if (authz)\n        return {\n          ...account,\n          tempId: \"CURRENT_USER\",\n          resolve: null,\n          addr: sansPrefix(authz.identity.address),\n          keyId: authz.identity.keyId,\n          sequenceNum: null,\n          signature: null,\n          async signingFunction(signable) {\n            return normalizeCompositeSignature(\n              await execService({\n                service: authz,\n                msg: signable,\n                opts: {\n                  includeOlderJsonRpcCall: true,\n                },\n              })\n            )\n          },\n        }\n      throw new Error(\n        \"No Authz or PreAuthz Service configured for CURRENT_USER\"\n      )\n    },\n  }\n}\n\nfunction subscribe(callback) {\n  spawnCurrentUser()\n  const EXIT = \"@EXIT\"\n  const self = spawn(async ctx => {\n    ctx.send(NAME, SUBSCRIBE)\n    while (1) {\n      const letter = await ctx.receive()\n      if (letter.tag === EXIT) {\n        ctx.send(NAME, UNSUBSCRIBE)\n        return\n      }\n      callback(letter.data)\n    }\n  })\n  return () => send(self, EXIT)\n}\n\nfunction snapshot() {\n  spawnCurrentUser()\n  return send(NAME, SNAPSHOT, null, {expectReply: true, timeout: 0})\n}\n\nasync function info() {\n  spawnCurrentUser()\n  const {addr} = await snapshot()\n  if (addr == null) throw new Error(\"No Flow Address for Current User\")\n  return account(addr)\n}\n\nasync function resolveArgument() {\n  const {addr} = await authenticate()\n  return arg(withPrefix(addr), t.Address)\n}\n\nconst makeSignable = msg => {\n  invariant(/^[0-9a-f]+$/i.test(msg), \"Message must be a hex string\")\n\n  return {\n    message: msg,\n  }\n}\n\nasync function signUserMessage(msg) {\n  spawnCurrentUser()\n  const user = await authenticate({redir: true})\n\n  const signingService = serviceOfType(user.services, \"user-signature\")\n\n  invariant(\n    signingService,\n    \"Current user must have authorized a signing service.\"\n  )\n\n  try {\n    const response = await execService({\n      service: signingService,\n      msg: makeSignable(msg),\n    })\n    if (Array.isArray(response)) {\n      return response.map(compSigs => normalizeCompositeSignature(compSigs))\n    } else {\n      return [normalizeCompositeSignature(response)]\n    }\n  } catch (error) {\n    return error\n  }\n}\n\nlet currentUser = () => {\n  return {\n    authenticate,\n    unauthenticate,\n    authorization,\n    signUserMessage,\n    subscribe,\n    snapshot,\n    resolveArgument,\n  }\n}\n\ncurrentUser.authenticate = authenticate\ncurrentUser.unauthenticate = unauthenticate\ncurrentUser.authorization = authorization\ncurrentUser.signUserMessage = signUserMessage\ncurrentUser.subscribe = subscribe\ncurrentUser.snapshot = snapshot\ncurrentUser.resolveArgument = resolveArgument\n\nexport {currentUser}\n","import \"../default-config\"\nimport {\n  spawn,\n  send,\n  subscriber,\n  snapshoter,\n  UPDATED,\n  SNAPSHOT,\n  INIT,\n  SUBSCRIBE,\n  UNSUBSCRIBE,\n} from \"@onflow/util-actor\"\nimport {send as fclSend, decode, getTransactionStatus} from \"@onflow/sdk\"\n\nconst RATE = 2500\nconst POLL = \"POLL\"\n\nconst fetchTxStatus = async transactionId => {\n  return fclSend([getTransactionStatus(transactionId)]).then(decode)\n}\n\nconst isExpired = tx => tx.status === 5\nconst isSealed = tx => tx.status >= 4\nconst isExecuted = tx => tx.status >= 3\nconst isFinalized = tx => tx.status >= 2\nconst isPending = tx => tx.status >= 1\nconst isUnknown = tx => tx.status >= 0\n\nconst isDiff = (cur, next) => {\n  return JSON.stringify(cur) !== JSON.stringify(next)\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    const tx = await fetchTxStatus(ctx.self())\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    ctx.merge(tx)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, ctx.all())\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n  },\n  [SNAPSHOT]: async (ctx, letter) => {\n    letter.reply(ctx.all())\n  },\n  [POLL]: async ctx => {\n    let tx\n    try {\n      tx = await fetchTxStatus(ctx.self())\n    } catch (e) {\n      console.error(e)\n      setTimeout(() => ctx.sendSelf(POLL), RATE)\n      return\n    }\n    if (!isSealed(tx)) setTimeout(() => ctx.sendSelf(POLL), RATE)\n    if (isDiff(ctx.all(), tx)) ctx.broadcast(UPDATED, tx)\n    ctx.merge(tx)\n  },\n}\n\nconst scoped = transactionId => {\n  if (typeof transactionId === \"object\")\n    transactionId = transactionId.transactionId\n  if (transactionId == null) throw new Error(\"transactionId required\")\n  return transactionId\n}\n\nconst spawnTransaction = transactionId => {\n  return spawn(HANDLERS, scoped(transactionId))\n}\n\nexport function transaction(transactionId) {\n  function snapshot() {\n    return snapshoter(transactionId, spawnTransaction)\n  }\n\n  function subscribe(callback) {\n    return subscriber(scoped(transactionId), spawnTransaction, callback)\n  }\n\n  function once(predicate) {\n    return function innerOnce(opts = {}) {\n      const suppress = opts.suppress || false\n      return new Promise((resolve, reject) => {\n        const unsub = subscribe(txStatus => {\n          if (txStatus.statusCode && !suppress) {\n            reject(txStatus.errorMessage)\n            unsub()\n          } else if (predicate(txStatus)) {\n            resolve(txStatus)\n            unsub()\n          }\n        })\n      })\n    }\n  }\n\n  return {\n    snapshot,\n    subscribe,\n    onceFinalized: once(isFinalized),\n    onceExecuted: once(isExecuted),\n    onceSealed: once(isSealed),\n  }\n}\n\ntransaction.isUnknown = isUnknown\ntransaction.isPending = isPending\ntransaction.isFinalized = isFinalized\ntransaction.isExecuted = isExecuted\ntransaction.isSealed = isSealed\ntransaction.isExpired = isExpired\n","import {invariant} from \"@onflow/util-invariant\"\nimport * as sdk from \"@onflow/sdk\"\nimport {isRequired, isObject, isString, isFunc, isNumber} from \"./utils/is\"\nimport {normalizeArgs} from \"./utils/normalize-args\"\nimport {currentUser} from \"../current-user\"\nimport {transaction} from \"../transaction\"\n\n/** As the current user Mutate the Flow Blockchain\n *\n *  @arg {Object} opts - Mutation Options and configuration\n *  @arg {string} opts.cadence - Cadence Transaction used to mutate Flow\n *  @arg {ArgsFn} opts.args - Arguments passed to cadence transaction\n *  @arg {number} opts.limit - Compute Limit for transaction\n *  @returns {string} Transaction Id\n *\n *  Where:\n *    @callback ArgsFn\n *    @arg {ArgFn}  arg - Argument function to define a single argument\n *    @arg {Object} t   - Cadence Types object used to define the type\n *    @returns {args[]}\n *\n *    @callback ArgFn\n *    @arg {Any}  value - the value of the argument\n *    @arg {Type} type  - the cadence type of the value\n *    @returns {arg}\n *\n *  Example:\n *    fcl.mutate({\n *      cadence: `\n *        transaction(a: Int, b: Int, c: Address) {\n *          prepare(acct: AuthAccount) {\n *            log(acct)\n *            log(a)\n *            log(b)\n *            log(c)\n *          }\n *        }\n *      `,\n *      args: (arg, t) => [\n *        arg(6, t.Int),\n *        arg(7, t.Int),\n *        arg(\"0xba1132bc08f82fe2\", t.Address),\n *      ],\n *    })\n *\n *\n *  Options:\n *    type Options = {\n *      cadence: String!,\n *      args: (arg, t) => Array<Arg>,\n *      limit: Number,\n *      authz: AuthzFn, // will overload the trinity of signatory roles\n *      proposer: AuthzFn, // will overload the proposer signatory role\n *      payer: AuthzFn, // will overload the payer signatory role\n *      authorizations: [AuthzFn], // an array of authorization functions used as authorizations signatory roles\n *    }\n */\n\nconst noop = () => {}\n\nexport async function mutate(opts = {}) {\n  var txid\n  try {\n    await prepMutation(opts)\n\n    // Allow for a config to overwrite the authorization function.\n    // prettier-ignore\n    const authz = await sdk.config().get(\"fcl.authz\", currentUser().authorization)\n\n    // prettier-ignore\n    txid = sdk.send([\n      sdk.transaction(opts.cadence),\n\n      sdk.args(normalizeArgs(opts.args || [])),\n\n      opts.limit && isNumber(opts.limit) && sdk.limit(opts.limit),\n\n      // opts.proposer > opts.authz > authz\n      sdk.proposer(opts.proposer || opts.authz || authz),\n\n      // opts.payer > opts.authz > authz\n      sdk.payer(opts.payer || opts.authz || authz),\n\n      // opts.authorizations > [opts.authz > authz]\n      sdk.authorizations(opts.authorizations || [opts.authz || authz]),\n    ]).then(sdk.decode)\n\n    return txid\n  } catch (error) {\n    throw error\n  }\n}\n\nasync function prepMutation(opts) {\n  // prettier-ignore\n  invariant(isRequired(opts), \"mutate(opts) -- opts is required\")\n  // prettier-ignore\n  invariant(isObject(opts), \"mutate(opts) -- opts must be an object\")\n  // prettier-ignore\n  invariant(isRequired(opts.cadence), \"mutate({ cadence }) -- cadence is required\")\n  // prettier-ignore\n  invariant(isString(opts.cadence), \"mutate({ cadence }) -- cadence must be a string\")\n  // prettier-ignore\n  invariant(\n    await sdk.config.get(\"accessNode.api\"),\n    `Required value for \"accessNode.api\" not defined in config. See: ${\"https://github.com/onflow/flow-js-sdk/blob/master/packages/fcl/src/exec/query.md#configuration\"}`\n  )\n}\n","export const onMessageFromFCL = (messageType, cb = () => {}) => {\n  const buildData = data => {\n    if (data.deprecated)\n      console.warn(\"DEPRECATION NOTICE\", data.deprecated.message)\n    delete data?.body?.interaction\n\n    return data\n  }\n\n  const internal = e => {\n    const {data} = e\n    if (typeof data !== \"object\") return\n    if (typeof data == null) return\n    if (data.type !== messageType) return\n\n    cb(buildData(data))\n  }\n\n  window.addEventListener(\"message\", internal)\n  return () => window.removeEventListener(\"message\", internal)\n}\n","import {onMessageFromFCL} from \"./on-message-from-fcl\"\n\nexport const sendMsgToFCL = (type, msg = {}) => {\n  if (window.location !== window.parent.location) {\n    window.parent.postMessage({...msg, type}, \"*\")\n  } else {\n    window.opener.postMessage({...msg, type}, \"*\")\n  }\n}\n\nexport const ready = (cb, msg = {}) => {\n  onMessageFromFCL(\"FCL:VIEW:READY:RESPONSE\", cb)\n  sendMsgToFCL(\"FCL:VIEW:READY\")\n}\n\nexport const close = () => {\n  sendMsgToFCL(\"FCL:VIEW:CLOSE\")\n}\n\nexport const approve = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"APPROVED\",\n    reason: null,\n    data: data,\n  })\n}\n\nexport const decline = reason => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"DECLINED\",\n    reason: reason,\n    data: null,\n  })\n}\n\nexport const redirect = data => {\n  sendMsgToFCL(\"FCL:VIEW:RESPONSE\", {\n    f_type: \"PollingResponse\",\n    f_vsn: \"1.0.0\",\n    status: \"REDIRECT\",\n    reason: null,\n    data: data,\n  })\n}\n","import {withPrefix} from \"@onflow/util-address\"\nimport {COMPOSITE_SIGNATURE_PRAGMA} from \"../current-user/normalize/__vsn\"\n\nexport function CompositeSignature(addr, keyId, signature) {\n  this.f_type = COMPOSITE_SIGNATURE_PRAGMA.f_type\n  this.f_vsn = COMPOSITE_SIGNATURE_PRAGMA.f_vsn\n  this.addr = withPrefix(addr)\n  this.keyId = Number(keyId)\n  this.signature = signature\n}\n","import {sansPrefix} from \"@onflow/util-address\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {Buffer, encode as rlpEncode} from \"@onflow/rlp\"\n\nconst rightPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padEnd(pad * 2, \"0\"), \"hex\")\n\nconst leftPaddedHexBuffer = (value, pad) =>\n  Buffer.from(value.padStart(pad * 2, \"0\"), \"hex\")\n\nconst addressBuffer = addr => leftPaddedHexBuffer(addr, 8)\n\nconst nonceBuffer = nonce => Buffer.from(nonce, \"hex\")\n\nexport const encodeAccountProof = (\n  {address, nonce, appIdentifier},\n  includeDomainTag = true\n) => {\n  invariant(\n    address,\n    \"Encode Message For Provable Authn Error: address must be defined\"\n  )\n  invariant(\n    nonce,\n    \"Encode Message For Provable Authn Error: nonce must be defined\"\n  )\n  invariant(\n    appIdentifier,\n    \"Encode Message For Provable Authn Error: appIdentifier must be defined\"\n  )\n\n  invariant(\n    nonce.length >= 64,\n    \"Encode Message For Provable Authn Error: nonce must be minimum of 32 bytes\"\n  )\n\n  const ACCOUNT_PROOF_DOMAIN_TAG = rightPaddedHexBuffer(\n    Buffer.from(\"FCL-ACCOUNT-PROOF-V0.0\").toString(\"hex\"),\n    32\n  )\n\n  if (includeDomainTag) {\n    return Buffer.concat([\n      ACCOUNT_PROOF_DOMAIN_TAG,\n      rlpEncode([\n        appIdentifier,\n        addressBuffer(sansPrefix(address)),\n        nonceBuffer(nonce),\n      ]),\n    ]).toString(\"hex\")\n  }\n\n  return rlpEncode([\n    appIdentifier,\n    addressBuffer(sansPrefix(address)),\n    nonceBuffer(nonce),\n  ]).toString(\"hex\")\n}\n","export function injectExtService(service) {\n  if (service.type === \"authn\" && service.endpoint != null) {\n    if (!Array.isArray(window.fcl_extensions)) {\n      window.fcl_extensions = []\n    }\n    window.fcl_extensions.push(service)\n  } else {\n    console.warn(\"Authn service is required\")\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {sansPrefix} from \"@onflow/util-address\"\nimport {query} from \"../exec/query\"\nimport {encodeAccountProof} from \"../wallet-utils\"\nimport {isString} from \"../exec/utils/is\"\n\nconst ACCOUNT_PROOF = \"ACCOUNT_PROOF\"\nconst USER_SIGNATURE = \"USER_SIGNATURE\"\n\nexport const validateArgs = args => {\n  if (args.appIdentifier) {\n    const {appIdentifier, address, nonce, signatures} = args\n    invariant(\n      isString(appIdentifier),\n      \"verifyAccountProof({ appIdentifier }) -- appIdentifier must be a string\"\n    )\n    invariant(\n      isString(address) && sansPrefix(address).length === 16,\n      \"verifyAccountProof({ address }) -- address must be a valid address\"\n    )\n    invariant(/^[0-9a-f]+$/i.test(nonce), \"nonce must be a hex string\")\n    invariant(\n      Array.isArray(signatures) &&\n        signatures.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      signatures.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  } else {\n    const {message, compSigs} = args\n    invariant(\n      /^[0-9a-f]+$/i.test(message),\n      \"Signed message must be a hex string\"\n    )\n    invariant(\n      Array.isArray(compSigs) &&\n        compSigs.every((sig, i, arr) => sig.f_type === \"CompositeSignature\"),\n      \"Must include an Array of CompositeSignatures to verify\"\n    )\n    invariant(\n      compSigs.map(cs => cs.addr).every((addr, i, arr) => addr === arr[0]),\n      \"User signatures to be verified must be from a single account address\"\n    )\n    return true\n  }\n}\n\nconst getVerifySignaturesScript = async (sig, opts) => {\n  const verifyFunction =\n    sig === \"ACCOUNT_PROOF\"\n      ? \"verifyAccountProofSignatures\"\n      : \"verifyUserSignatures\"\n\n  const network = await config.first([\"env\", \"flow.network\"])\n  let fclCryptoContract\n\n  invariant(\n    opts.fclCryptoContract || network === \"testnet\" || network === \"mainnet\",\n    \"${verifyFunction}({ fclCryptoContract }) -- config.flow.network must be specified (testnet || mainnet) or contract address provided via opts.fclCryptoContract\"\n  )\n\n  if (opts.fclCryptoContract) {\n    fclCryptoContract = opts.fclCryptoContract\n  } else {\n    fclCryptoContract =\n      network === \"testnet\" ? \"0x74daa6f9c7ef24b1\" : \"0xb4b82a1c9d21d284\"\n  }\n\n  return `\n      import FCLCrypto from ${fclCryptoContract}\n\n      pub fun main(\n          address: Address, \n          message: String, \n          keyIndices: [Int], \n          signatures: [String]\n      ): Bool {\n        return FCLCrypto.${verifyFunction}(address: address, message: message, keyIndices: keyIndices, signatures: signatures)\n      }\n    `\n}\n\n/**\n * Verify a valid account proof signature or signatures for an account on Flow.\n *\n * @param {string} appIdentifier - A message string in hexadecimal format\n * @param {Object} accountProofData - An object consisting of address, nonce, and signatures\n * @param {string} accountProofData.address - A Flow account address\n * @param {string} accountProofData.nonce - A random string in hexadecimal format (minimum 32 bytes in total, i.e 64 hex characters)\n * @param {Object[]} accountProofData.signatures - An array of composite signatures to verify\n * @param {Object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override Flow account address where the FCLCrypto contract is deployed\n * @return {bool}\n *\n * @example\n *\n *  const accountProofData = {\n *   address: \"0x123\",\n *   nonce: \"F0123\"\n *   signatures: [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *  }\n *\n *  const isValid = await fcl.AppUtils.verifyAccountProof(\n *    \"AwesomeAppId\",\n *    accountProofData,\n *    {fclCryptoContract}\n *  )\n */\n\nexport async function verifyAccountProof(\n  appIdentifier,\n  {address, nonce, signatures},\n  opts = {}\n) {\n  validateArgs({appIdentifier, address, nonce, signatures})\n\n  const message = encodeAccountProof({address, nonce, appIdentifier}, false)\n\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of signatures) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId)\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(ACCOUNT_PROOF, opts),\n    args: (arg, t) => [\n      arg(address, t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array([t.Int])),\n      arg(signaturesArr, t.Array([t.String])),\n    ],\n  })\n}\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @param {string} msg - A message string in hexadecimal format\n * @param {Array} compSigs - An array of Composite Signatures\n * @param {string} compSigs[].addr - The account address\n * @param {number} compSigs[].keyId - The account keyId\n * @param {string} compSigs[].signature - The signature to verify\n * @param {Object} [opts={}] - Options object\n * @param {string} opts.fclCryptoContract - An optional override of Flow account address where the FCLCrypto contract is deployed\n * @return {bool}\n *\n * @example\n *\n *  const isValid = await fcl.AppUtils.verifyUserSignatures(\n *    Buffer.from('FOO').toString(\"hex\"),\n *    [{f_type: \"CompositeSignature\", f_vsn: \"1.0.0\", addr: \"0x123\", keyId: 0, signature: \"abc123\"}],\n *    {fclCryptoContract}\n *  )\n */\nexport async function verifyUserSignatures(message, compSigs, opts = {}) {\n  validateArgs({message, compSigs})\n\n  const address = compSigs[0].addr\n  let signaturesArr = []\n  let keyIndices = []\n\n  for (const el of compSigs) {\n    signaturesArr.push(el.signature)\n    keyIndices.push(el.keyId)\n  }\n\n  return query({\n    cadence: await getVerifySignaturesScript(USER_SIGNATURE, opts),\n    args: (arg, t) => [\n      arg(address, t.Address),\n      arg(message, t.String),\n      arg(keyIndices, t.Array([t.Int])),\n      arg(signaturesArr, t.Array([t.String])),\n    ],\n  })\n}\n","var promise;\nvar queueMicrotask_1 = typeof queueMicrotask === 'function' ? queueMicrotask : function (cb) {\n  return (promise || (promise = Promise.resolve())).then(cb)[\"catch\"](function (err) {\n    return setTimeout(function () {\n      throw err;\n    }, 0);\n  });\n};\n\nfunction _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}\n\nfunction _unsupportedIterableToArray(o, minLen) {\n  if (!o) return;\n  if (typeof o === \"string\") return _arrayLikeToArray(o, minLen);\n  var n = Object.prototype.toString.call(o).slice(8, -1);\n  if (n === \"Object\" && o.constructor) n = o.constructor.name;\n  if (n === \"Map\" || n === \"Set\") return Array.from(o);\n  if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);\n}\n\nfunction _arrayLikeToArray(arr, len) {\n  if (len == null || len > arr.length) len = arr.length;\n\n  for (var i = 0, arr2 = new Array(len); i < len; i++) {\n    arr2[i] = arr[i];\n  }\n\n  return arr2;\n}\n\nfunction _createForOfIteratorHelperLoose(o, allowArrayLike) {\n  var it = typeof Symbol !== \"undefined\" && o[Symbol.iterator] || o[\"@@iterator\"];\n  if (it) return (it = it.call(o)).next.bind(it);\n\n  if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === \"number\") {\n    if (it) o = it;\n    var i = 0;\n    return function () {\n      if (i >= o.length) return {\n        done: true\n      };\n      return {\n        done: false,\n        value: o[i++]\n      };\n    };\n  }\n\n  throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\");\n}\n\nvar mailbox = function mailbox() {\n  var queue = [];\n  var next;\n  return {\n    deliver: function deliver(msg) {\n      try {\n        queue.push(msg);\n\n        if (next) {\n          next(queue.shift());\n          next = undefined;\n        }\n\n        return Promise.resolve();\n      } catch (e) {\n        return Promise.reject(e);\n      }\n    },\n    receive: function receive() {\n      return new Promise(function innerReceive(resolve) {\n        var msg = queue.shift();\n        if (msg) return resolve(msg);\n        next = resolve;\n      });\n    }\n  };\n};\n\nfunction _catch(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n\n  return result;\n}\n\nfunction _finallyRethrows(body, finalizer) {\n  try {\n    var result = body();\n  } catch (e) {\n    return finalizer(true, e);\n  }\n\n  if (result && result.then) {\n    return result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n  }\n\n  return finalizer(false, result);\n}\n\nfunction _settle(pact, state, value) {\n  if (!pact.s) {\n    if (value instanceof _Pact) {\n      if (value.s) {\n        if (state & 1) {\n          state = value.s;\n        }\n\n        value = value.v;\n      } else {\n        value.o = _settle.bind(null, pact, state);\n        return;\n      }\n    }\n\n    if (value && value.then) {\n      value.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n      return;\n    }\n\n    pact.s = state;\n    pact.v = value;\n    var observer = pact.o;\n\n    if (observer) {\n      observer(pact);\n    }\n  }\n}\n\nvar _Pact = /*#__PURE__*/function () {\n  function _Pact() {}\n\n  _Pact.prototype.then = function (onFulfilled, onRejected) {\n    var result = new _Pact();\n    var state = this.s;\n\n    if (state) {\n      var callback = state & 1 ? onFulfilled : onRejected;\n\n      if (callback) {\n        try {\n          _settle(result, 1, callback(this.v));\n        } catch (e) {\n          _settle(result, 2, e);\n        }\n\n        return result;\n      } else {\n        return this;\n      }\n    }\n\n    this.o = function (_this) {\n      try {\n        var value = _this.v;\n\n        if (_this.s & 1) {\n          _settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n        } else if (onRejected) {\n          _settle(result, 1, onRejected(value));\n        } else {\n          _settle(result, 2, value);\n        }\n      } catch (e) {\n        _settle(result, 2, e);\n      }\n    };\n\n    return result;\n  };\n\n  return _Pact;\n}();\n\nfunction _isSettledPact(thenable) {\n  return thenable instanceof _Pact && thenable.s & 1;\n}\n\nfunction _for(test, update, body) {\n  var stage;\n\n  for (;;) {\n    var shouldContinue = test();\n\n    if (_isSettledPact(shouldContinue)) {\n      shouldContinue = shouldContinue.v;\n    }\n\n    if (!shouldContinue) {\n      return result;\n    }\n\n    if (shouldContinue.then) {\n      stage = 0;\n      break;\n    }\n\n    var result = body();\n\n    if (result && result.then) {\n      if (_isSettledPact(result)) {\n        result = result.s;\n      } else {\n        stage = 1;\n        break;\n      }\n    }\n\n    if (update) {\n      var updateValue = update();\n\n      if (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n        stage = 2;\n        break;\n      }\n    }\n  }\n\n  var pact = new _Pact();\n\n  var reject = _settle.bind(null, pact, 2);\n\n  (stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n  return pact;\n\n  function _resumeAfterBody(value) {\n    result = value;\n\n    do {\n      if (update) {\n        updateValue = update();\n\n        if (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n          updateValue.then(_resumeAfterUpdate).then(void 0, reject);\n          return;\n        }\n      }\n\n      shouldContinue = test();\n\n      if (!shouldContinue || _isSettledPact(shouldContinue) && !shouldContinue.v) {\n        _settle(pact, 1, result);\n\n        return;\n      }\n\n      if (shouldContinue.then) {\n        shouldContinue.then(_resumeAfterTest).then(void 0, reject);\n        return;\n      }\n\n      result = body();\n\n      if (_isSettledPact(result)) {\n        result = result.v;\n      }\n    } while (!result || !result.then);\n\n    result.then(_resumeAfterBody).then(void 0, reject);\n  }\n\n  function _resumeAfterTest(shouldContinue) {\n    if (shouldContinue) {\n      result = body();\n\n      if (result && result.then) {\n        result.then(_resumeAfterBody).then(void 0, reject);\n      } else {\n        _resumeAfterBody(result);\n      }\n    } else {\n      _settle(pact, 1, result);\n    }\n  }\n\n  function _resumeAfterUpdate() {\n    if (shouldContinue = test()) {\n      if (shouldContinue.then) {\n        shouldContinue.then(_resumeAfterTest).then(void 0, reject);\n      } else {\n        _resumeAfterTest(shouldContinue);\n      }\n    } else {\n      _settle(pact, 1, result);\n    }\n  }\n}\n\nvar INIT = \"INIT\";\nvar SUBSCRIBE = \"SUBSCRIBE\";\nvar UNSUBSCRIBE = \"UNSUBSCRIBE\";\nvar EXIT = \"EXIT\";\nvar TERMINATE = \"TERMINATE\";\nvar root = typeof self === \"object\" && self.self === self && self || typeof global === \"object\" && global.global === global && global || typeof window === \"object\" && window.window === window && window;\nroot.FCL_REGISTRY = root.FCL_REGISTRY == null ? {} : root.FCL_REGISTRY;\nvar pid = 0;\nvar DEFAULT_TIMEOUT = 5000;\n\nvar _send = function send(addr, tag, data, opts) {\n  if (opts === void 0) {\n    opts = {};\n  }\n\n  return new Promise(function (reply, reject) {\n    var expectReply = opts.expectReply || false;\n    var timeout = opts.timeout != null ? opts.timeout : DEFAULT_TIMEOUT;\n\n    if (expectReply && timeout) {\n      setTimeout(function () {\n        return reject(new Error(\"Timeout: \" + timeout + \"ms passed without a response.\"));\n      }, timeout);\n    }\n\n    var payload = {\n      to: addr,\n      from: opts.from,\n      tag: tag,\n      data: data,\n      timeout: timeout,\n      reply: reply,\n      reject: reject\n    };\n\n    try {\n      root.FCL_REGISTRY[addr] && root.FCL_REGISTRY[addr].mailbox.deliver(payload);\n      if (!expectReply) reply(true);\n    } catch (error) {\n      console.error(\"FCL.Actor -- Could Not Deliver Message\", payload, root.FCL_REGISTRY[addr], error);\n    }\n  });\n};\n\nvar kill = function kill(addr) {\n  delete root.FCL_REGISTRY[addr];\n};\n\nvar fromHandlers = function fromHandlers(handlers) {\n  if (handlers === void 0) {\n    handlers = {};\n  }\n\n  return function (ctx) {\n    try {\n      var _temp12 = function _temp12() {\n        var _loopInterrupt;\n\n        var _temp6 = _for(function () {\n          return !_loopInterrupt && 1;\n        }, void 0, function () {\n          return Promise.resolve(ctx.receive()).then(function (letter) {\n            var _temp5 = _finallyRethrows(function () {\n              return _catch(function () {\n                function _temp4() {\n                  return Promise.resolve(handlers[letter.tag](ctx, letter, letter.data || {})).then(function () {});\n                }\n\n                var _temp3 = function () {\n                  if (letter.tag === EXIT) {\n                    var _temp10 = function _temp10() {\n                      _loopInterrupt = 1;\n                    };\n\n                    var _temp11 = function () {\n                      if (typeof handlers[TERMINATE] === \"function\") {\n                        return Promise.resolve(handlers[TERMINATE](ctx, letter, letter.data || {})).then(function () {});\n                      }\n                    }();\n\n                    return _temp11 && _temp11.then ? _temp11.then(_temp10) : _temp10(_temp11);\n                  }\n                }();\n\n                return _temp3 && _temp3.then ? _temp3.then(_temp4) : _temp4(_temp3);\n              }, function (error) {\n                console.error(ctx.self() + \" Error\", letter, error);\n              });\n            }, function (_wasThrown, _result) {\n              return;\n              if (_wasThrown) throw _result;\n              return _result;\n            });\n\n            if (_temp5 && _temp5.then) return _temp5.then(function () {});\n          });\n        });\n\n        var _temp7 = function () {\n          if (_temp6 && _temp6.then) return _temp6.then(function () {});\n        }();\n\n        if (_temp7 && _temp7.then) return _temp7.then(function () {});\n      };\n\n      var _temp13 = function () {\n        if (typeof handlers[INIT] === \"function\") return Promise.resolve(handlers[INIT](ctx)).then(function () {});\n      }();\n\n      return Promise.resolve(_temp13 && _temp13.then ? _temp13.then(_temp12) : _temp12(_temp13));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  };\n};\n\nvar spawn = function spawn(fn, addr) {\n  if (addr === void 0) {\n    addr = null;\n  }\n\n  if (addr == null) addr = ++pid;\n  if (root.FCL_REGISTRY[addr] != null) return addr;\n  root.FCL_REGISTRY[addr] = {\n    addr: addr,\n    mailbox: mailbox(),\n    subs: new Set(),\n    kvs: {}\n  };\n  var ctx = {\n    self: function self() {\n      return addr;\n    },\n    receive: function receive() {\n      return root.FCL_REGISTRY[addr].mailbox.receive();\n    },\n    send: function send(to, tag, data, opts) {\n      if (opts === void 0) {\n        opts = {};\n      }\n\n      opts.from = addr;\n      return _send(to, tag, data, opts);\n    },\n    sendSelf: function sendSelf(tag, data, opts) {\n      if (root.FCL_REGISTRY[addr]) _send(addr, tag, data, opts);\n    },\n    broadcast: function broadcast(tag, data, opts) {\n      if (opts === void 0) {\n        opts = {};\n      }\n\n      opts.from = addr;\n\n      for (var _iterator = _createForOfIteratorHelperLoose(root.FCL_REGISTRY[addr].subs), _step; !(_step = _iterator()).done;) {\n        var to = _step.value;\n\n        _send(to, tag, data, opts);\n      }\n    },\n    subscribe: function subscribe(sub) {\n      return sub != null && root.FCL_REGISTRY[addr].subs.add(sub);\n    },\n    unsubscribe: function unsubscribe(sub) {\n      return sub != null && root.FCL_REGISTRY[addr].subs[\"delete\"](sub);\n    },\n    subscriberCount: function subscriberCount() {\n      return root.FCL_REGISTRY[addr].subs.size;\n    },\n    hasSubs: function hasSubs() {\n      return !!root.FCL_REGISTRY[addr].subs.size;\n    },\n    put: function put(key, value) {\n      if (key != null) root.FCL_REGISTRY[addr].kvs[key] = value;\n    },\n    get: function get(key, fallback) {\n      var value = root.FCL_REGISTRY[addr].kvs[key];\n      return value == null ? fallback : value;\n    },\n    \"delete\": function _delete(key) {\n      delete root.FCL_REGISTRY[addr].kvs[key];\n    },\n    update: function update(key, fn) {\n      if (key != null) root.FCL_REGISTRY[addr].kvs[key] = fn(root.FCL_REGISTRY[addr].kvs[key]);\n    },\n    keys: function keys() {\n      return Object.keys(root.FCL_REGISTRY[addr].kvs);\n    },\n    all: function all() {\n      return root.FCL_REGISTRY[addr].kvs;\n    },\n    where: function where(pattern) {\n      return Object.keys(root.FCL_REGISTRY[addr].kvs).reduce(function (acc, key) {\n        var _extends2;\n\n        return pattern.test(key) ? _extends({}, acc, (_extends2 = {}, _extends2[key] = root.FCL_REGISTRY[addr].kvs[key], _extends2)) : acc;\n      }, {});\n    },\n    merge: function merge(data) {\n      if (data === void 0) {\n        data = {};\n      }\n\n      Object.keys(data).forEach(function (key) {\n        return root.FCL_REGISTRY[addr].kvs[key] = data[key];\n      });\n    }\n  };\n  if (typeof fn === \"object\") fn = fromHandlers(fn);\n  queueMicrotask_1(function () {\n    try {\n      return Promise.resolve(fn(ctx)).then(function () {\n        kill(addr);\n      });\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n  return addr;\n};\n\nfunction subscriber(address, spawnFn, callback) {\n  spawnFn(address);\n  var EXIT = \"@EXIT\";\n  var self = spawn(function (ctx) {\n    try {\n      var _exit2;\n\n      ctx.send(address, SUBSCRIBE);\n      return Promise.resolve(_for(function () {\n        return !_exit2 && 1;\n      }, void 0, function () {\n        return Promise.resolve(ctx.receive()).then(function (letter) {\n          if (letter.tag === EXIT) {\n            ctx.send(address, UNSUBSCRIBE);\n            _exit2 = 1;\n            return;\n          }\n\n          callback(letter.data);\n        });\n      }));\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n  return function () {\n    return _send(self, EXIT);\n  };\n}\n\nfunction _extends$1() {\n  _extends$1 = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends$1.apply(this, arguments);\n}\n\nvar _iteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\")) : \"@@iterator\";\n\nvar _asyncIteratorSymbol = /*#__PURE__*/typeof Symbol !== \"undefined\" ? Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\")) : \"@@asyncIterator\";\n\nfunction _catch$1(body, recover) {\n  try {\n    var result = body();\n  } catch (e) {\n    return recover(e);\n  }\n\n  if (result && result.then) {\n    return result.then(void 0, recover);\n  }\n\n  return result;\n}\n\nvar _HANDLERS;\n\nvar first = function first(wants, fallback) {\n  if (wants === void 0) {\n    wants = [];\n  }\n\n  try {\n    if (!wants.length) return Promise.resolve(fallback);\n\n    var _wants = wants,\n        head = _wants[0],\n        rest = _wants.slice(1);\n\n    return Promise.resolve(get(head)).then(function (ret) {\n      return ret == null ? first(rest, fallback) : ret;\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nvar NAME = \"config\";\nvar PUT = \"PUT_CONFIG\";\nvar GET = \"GET_CONFIG\";\nvar GET_ALL = \"GET_ALL_CONFIG\";\nvar UPDATE = \"UPDATE_CONFIG\";\nvar DELETE = \"DELETE_CONFIG\";\nvar CLEAR = \"CLEAR_CONFIG\";\nvar WHERE = \"WHERE_CONFIG\";\nvar UPDATED = \"CONFIG/UPDATED\";\n\nvar identity = function identity(v) {\n  return v;\n};\n\nvar HANDLERS = (_HANDLERS = {}, _HANDLERS[PUT] = function (ctx, _letter, _ref) {\n  var key = _ref.key,\n      value = _ref.value;\n  if (key == null) throw new Error(\"Missing 'key' for config/put.\");\n  ctx.put(key, value);\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[GET] = function (ctx, letter, _ref2) {\n  var key = _ref2.key,\n      fallback = _ref2.fallback;\n  if (key == null) throw new Error(\"Missing 'key' for config/get\");\n  letter.reply(ctx.get(key, fallback));\n}, _HANDLERS[GET_ALL] = function (ctx, letter) {\n  letter.reply(_extends$1({}, ctx.all()));\n}, _HANDLERS[UPDATE] = function (ctx, letter, _ref3) {\n  var key = _ref3.key,\n      fn = _ref3.fn;\n  if (key == null) throw new Error(\"Missing 'key' for config/update\");\n  ctx.update(key, fn || identity);\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[DELETE] = function (ctx, letter, _ref4) {\n  var key = _ref4.key;\n  if (key == null) throw new Error(\"Missing 'key' for config/delete\");\n  ctx[\"delete\"](key);\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[CLEAR] = function (ctx, letter) {\n  var keys = Object.keys(ctx.all());\n\n  for (var _i = 0, _keys = keys; _i < _keys.length; _i++) {\n    var key = _keys[_i];\n    ctx[\"delete\"](key);\n  }\n\n  ctx.broadcast(UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[WHERE] = function (ctx, letter, _ref5) {\n  var pattern = _ref5.pattern;\n  if (pattern == null) throw new Error(\"Missing 'pattern' for config/where\");\n  letter.reply(ctx.where(pattern));\n}, _HANDLERS[SUBSCRIBE] = function (ctx, letter) {\n  ctx.subscribe(letter.from);\n  ctx.send(letter.from, UPDATED, _extends$1({}, ctx.all()));\n}, _HANDLERS[UNSUBSCRIBE] = function (ctx, letter) {\n  ctx.unsubscribe(letter.from);\n}, _HANDLERS);\nspawn(HANDLERS, NAME);\n\nfunction put(key, value) {\n  _send(NAME, PUT, {\n    key: key,\n    value: value\n  });\n  return config();\n}\n\nfunction get(key, fallback) {\n  return _send(NAME, GET, {\n    key: key,\n    fallback: fallback\n  }, {\n    expectReply: true,\n    timeout: 10\n  });\n}\n\nfunction all() {\n  return _send(NAME, GET_ALL, null, {\n    expectReply: true,\n    timeout: 10\n  });\n}\n\nfunction update(key, fn) {\n  if (fn === void 0) {\n    fn = identity;\n  }\n\n  _send(NAME, UPDATE, {\n    key: key,\n    fn: fn\n  });\n  return config();\n}\n\nfunction _delete(key) {\n  _send(NAME, DELETE, {\n    key: key\n  });\n  return config();\n}\n\nfunction where(pattern) {\n  return _send(NAME, WHERE, {\n    pattern: pattern\n  }, {\n    expectReply: true,\n    timeout: 10\n  });\n}\n\nfunction subscribe(callback) {\n  return subscriber(NAME, function () {\n    return spawn(HANDLERS, NAME);\n  }, callback);\n}\n\nfunction clearConfig() {\n  return _send(NAME, CLEAR);\n}\n\nfunction config(values) {\n  if (values != null && typeof values === \"object\") {\n    Object.keys(values).map(function (d) {\n      return put(d, values[d]);\n    });\n  }\n\n  return {\n    put: put,\n    get: get,\n    all: all,\n    first: first,\n    update: update,\n    \"delete\": _delete,\n    where: where,\n    subscribe: subscribe,\n    overload: overload\n  };\n}\n\nconfig.put = put;\nconfig.get = get;\nconfig.all = all;\nconfig.first = first;\nconfig.update = update;\nconfig[\"delete\"] = _delete;\nconfig.where = where;\nconfig.subscribe = subscribe;\nconfig.overload = overload;\n\nvar noop = function noop(v) {\n  return v;\n};\n\nfunction overload(opts, callback) {\n  if (opts === void 0) {\n    opts = {};\n  }\n\n  if (callback === void 0) {\n    callback = noop;\n  }\n\n  return new Promise(function (resolve, reject) {\n    try {\n      return Promise.resolve(all()).then(function (oldConfig) {\n        var _temp = _catch$1(function () {\n          config(opts);\n          var _callback = callback;\n          return Promise.resolve(all()).then(function (_all) {\n            return Promise.resolve(_callback(_all)).then(function (result) {\n              return Promise.resolve(clearConfig()).then(function () {\n                return Promise.resolve(config(oldConfig)).then(function () {\n                  resolve(result);\n                });\n              });\n            });\n          });\n        }, function (error) {\n          return Promise.resolve(clearConfig()).then(function () {\n            return Promise.resolve(config(oldConfig)).then(function () {\n              reject(error);\n            });\n          });\n        });\n\n        if (_temp && _temp.then) return _temp.then(function () {});\n      });\n    } catch (e) {\n      return Promise.reject(e);\n    }\n  });\n}\n\nvar LEVELS = Object.freeze({\n  \"debug\": 5,\n  \"info\": 4,\n  \"log\": 3,\n  \"warn\": 2,\n  \"error\": 1\n});\n\nvar buildLoggerMessageArgs = function buildLoggerMessageArgs(_ref) {\n  var title = _ref.title,\n      message = _ref.message;\n  return [\"\\n    %c\" + title + \"\\n    ============================\\n    \" + message + \"\\n    ============================\\n    \", \"font-weight:bold;font-family:monospace;\"];\n};\n\nvar log = function log(_ref2) {\n  var title = _ref2.title,\n      message = _ref2.message,\n      level = _ref2.level,\n      _ref2$always = _ref2.always,\n      always = _ref2$always === void 0 ? false : _ref2$always;\n\n  try {\n    return Promise.resolve(config.get(\"logger.level\", 0)).then(function (configLoggerLevel) {\n      var _console, _console2, _console3, _console4, _console5;\n\n      if (!always && configLoggerLevel < level) return;\n      var loggerMessageArgs = buildLoggerMessageArgs({\n        title: title,\n        message: message\n      });\n\n      switch (level) {\n        case LEVELS.debug:\n          (_console = console).debug.apply(_console, loggerMessageArgs);\n\n          break;\n\n        case LEVELS.info:\n          (_console2 = console).info.apply(_console2, loggerMessageArgs);\n\n          break;\n\n        case LEVELS.warn:\n          (_console3 = console).warn.apply(_console3, loggerMessageArgs);\n\n          break;\n\n        case LEVELS.error:\n          (_console4 = console).error.apply(_console4, loggerMessageArgs);\n\n          break;\n\n        default:\n          (_console5 = console).log.apply(_console5, loggerMessageArgs);\n\n      }\n    });\n  } catch (e) {\n    return Promise.reject(e);\n  }\n};\n\nexport { LEVELS, log };\n//# sourceMappingURL=util-logger.module.js.map\n","import * as logger from \"@onflow/util-logger\"\n\nexport const deprecate = async ({title, message, level, always}) => {\n  await logger.log({title, message, level, always})\n}\n","import {verifyUserSignatures as verify} from \"../app-utils\"\nimport {deprecate} from \"../utils/deprecate\"\n\n/**\n * Verify a valid signature/s for an account on Flow.\n *\n * @deprecated since version '1.0.0-alpha.0', use AppUtils.verifyUserSignatures instead\n *\n */\nexport async function verifyUserSignatures(message, compSigs) {\n  deprecate({\n    title: \"FCL Deprecation Notice\",\n    message: `\n    fcl.verifyUserSignatures() is deprecated and will be removed in a future release\n    Please use fcl.AppUtils.verifyUserSignatures()`,\n    level: 2,\n    always: true,\n  })\n  return verify(message, compSigs)\n}\n","import {interaction, pipe} from \"@onflow/sdk\"\nimport {resolve as defaultResolve} from \"@onflow/sdk\"\nimport {config, createSignableVoucher} from \"@onflow/sdk\"\n\nexport const serialize = async (args = [], opts = {}) => {\n  const resolveFunction = await config.first(\n    [\"sdk.resolve\"],\n    opts.resolve || defaultResolve\n  )\n\n  if (Array.isArray(args)) args = await pipe(interaction(), args)\n\n  return JSON.stringify(\n    createSignableVoucher(await resolveFunction(args)),\n    null,\n    2\n  )\n}\n","import {spawn, subscriber, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {\n  config,\n  block,\n  getEventsAtBlockHeightRange,\n  send,\n  decode\n} from \"@onflow/sdk\"\n\nconst RATE = 10000\nconst UPDATED = \"UPDATED\"\nconst TICK = \"TICK\"\nconst HIGH_WATER_MARK = \"hwm\"\n\nconst scheduleTick = async ctx => {\n  return setTimeout(\n    () => ctx.sendSelf(TICK),\n    await config().get(\"fcl.eventPollRate\", RATE)\n  )\n}\n\nconst HANDLERS = {\n  [TICK]: async ctx => {\n    if (!ctx.hasSubs()) return\n    let hwm = ctx.get(HIGH_WATER_MARK)\n    if (hwm == null) {\n      ctx.put(HIGH_WATER_MARK, await block())\n      ctx.put(TICK, await scheduleTick(ctx))\n    } else {\n      let next = await block()\n      ctx.put(HIGH_WATER_MARK, next)\n      const data = await send([\n        getEventsAtBlockHeightRange(ctx.self(), hwm.height, next.height - 1),\n      ]).then(decode)\n      for (let d of data) ctx.broadcast(UPDATED, d.data)\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n  },\n  [SUBSCRIBE]: async (ctx, letter) => {\n    if (!ctx.hasSubs()) {\n      ctx.put(TICK, await scheduleTick(ctx))\n    }\n    ctx.subscribe(letter.from)\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => {\n    ctx.unsubscribe(letter.from)\n    if (!ctx.hasSubs()) {\n      clearTimeout(ctx.get(TICK))\n      ctx.delete(TICK)\n      ctx.delete(HIGH_WATER_MARK)\n    }\n  },\n}\n\nconst spawnEvents = key => spawn(HANDLERS, key)\n\nexport function events(key) {\n  return {\n    subscribe: callback => subscriber(key, spawnEvents, callback),\n  }\n}\n","import {config} from \"@onflow/config\"\nimport {invariant} from \"@onflow/util-invariant\"\nimport {VERSION} from \"../VERSION\"\n\nconst asyncPipe = (...fns) => input => fns.reduce((chain, fn) => chain.then(fn), Promise.resolve(input))\n\nasync function addServices(services = []) {\n  const endpoint = await config.get(\"discovery.authn.endpoint\")\n  invariant(Boolean(endpoint), `\"discovery.authn.endpoint\" in config must be defined.`)\n\n  const include = await config.get(\"discovery.authn.include\", [])\n  const url = new URL(endpoint)\n\n  return fetch(url, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n    body: JSON.stringify({\n      fclVersion: VERSION,\n      include\n    })\n  }).then(d => d.json())\n  .then(json => [...services, ...json])\n}\n\nfunction addExtensions(services = []) {\n  const extensions = window.fcl_extensions || []\n  return [...extensions, ...services]\n}\n\nfunction filterServicesByType(services = [], type) {\n  return services.filter(service => service.type === type)\n}\n\nexport const getServices = ({ type }) => asyncPipe(\n  addServices,\n  addExtensions,\n  s => filterServicesByType(s, type)\n)([])","import {spawn, subscriber, snapshoter, INIT, SUBSCRIBE, UNSUBSCRIBE} from \"@onflow/util-actor\"\nimport {getServices} from \"../services\"\n\nconst NAME = \"authn\"\nconst RESULTS = \"results\"\nconst SNAPSHOT = \"SNAPSHOT\"\nconst UPDATED = \"UPDATED\"\n\nconst warn = (fact, msg) => {\n  if (fact) {\n    console.warn(\n      `\n      %cFCL Warning\n      ============================\n      ${msg}\n      For more info, please see the docs: https://docs.onflow.org/fcl/\n      ============================\n      `,\n      \"font-weight:bold;font-family:monospace;\"\n    )\n  }\n}\n\nconst HANDLERS = {\n  [INIT]: async ctx => {\n    warn(typeof window === \"undefined\", '\"fcl.discovery\" is only available in the browser.')\n    const services = await getServices({ type: NAME })\n    ctx.put(RESULTS, services)\n  },\n  [SUBSCRIBE]: (ctx, letter) => {\n    ctx.subscribe(letter.from)\n    ctx.send(letter.from, UPDATED, {...ctx.all()})\n  },\n  [UNSUBSCRIBE]: (ctx, letter) => ctx.unsubscribe(letter.from),\n  [SNAPSHOT]: async (ctx, letter) => letter.reply({...ctx.all()}),\n}\n\nconst spawnProviders = () => spawn(HANDLERS, NAME)\n\nconst authn = {\n  subscribe: cb => subscriber(NAME, spawnProviders, cb),\n  snapshot: () => snapshoter(NAME, spawnProviders)\n}\n\nexport default authn\n","import authn from \"./services/authn\"\n\nconst discovery = {\n  authn\n}\n\nexport {discovery}","import \"./default-config\"\nexport {VERSION} from \"./VERSION\"\nexport {query} from \"./exec/query\"\nexport {mutate} from \"./exec/mutate\"\nexport {verifyUserSignatures} from \"./exec/verify\"\nexport {serialize} from \"./serialize\"\nexport {transaction as tx} from \"./transaction\"\nexport {events} from \"./events\"\n\nimport {currentUser} from \"./current-user\"\nexport {currentUser}\n\nimport {discovery} from \"./discovery\"\nexport {discovery}\n\nexport const authenticate = (opts = {}) => currentUser().authenticate(opts)\nexport const unauthenticate = () => currentUser().unauthenticate()\nexport const reauthenticate = (opts = {}) => {\n  currentUser().unauthenticate()\n  return currentUser().authenticate(opts)\n}\nexport const signUp = (opts = {}) => currentUser().authenticate(opts)\nexport const logIn = (opts = {}) => currentUser().authenticate(opts)\n\nexport const authz = currentUser().authorization\n\nimport * as types from \"@onflow/types\"\nexport const t = types\n\nimport * as WalletUtils from \"./wallet-utils\"\nexport {WalletUtils}\n\nimport * as AppUtils from \"./app-utils\"\nexport {AppUtils}\n\nexport {TestUtils} from \"@onflow/sdk\"\nexport {config} from \"@onflow/config\"\nexport {send} from \"@onflow/sdk\"\nexport {decode} from \"@onflow/sdk\"\nexport {account} from \"@onflow/sdk\"\nexport {block} from \"@onflow/sdk\"\nexport {isOk, isBad, why, pipe, build} from \"@onflow/sdk\"\nexport {withPrefix, sansPrefix, display} from \"@onflow/util-address\"\nexport {template as cadence} from \"@onflow/util-template\"\nexport {template as cdc} from \"@onflow/util-template\"\nexport {createSignableVoucher} from \"@onflow/sdk\"\nexport {voucherIntercept} from \"@onflow/sdk\"\nexport {voucherToTxId} from \"@onflow/sdk\"\n\n// builders\nexport {transaction} from \"@onflow/sdk\"\nexport {script} from \"@onflow/sdk\"\nexport {ping} from \"@onflow/sdk\"\nexport {atBlockHeight} from \"@onflow/sdk\"\nexport {atBlockId} from \"@onflow/sdk\"\nexport {getAccount} from \"@onflow/sdk\"\nexport {getEvents} from \"@onflow/sdk\"\nexport {getEventsAtBlockHeightRange} from \"@onflow/sdk\"\nexport {getEventsAtBlockIds} from \"@onflow/sdk\"\nexport {getBlock} from \"@onflow/sdk\"\nexport {getBlockHeader} from \"@onflow/sdk\"\nexport {getCollection} from \"@onflow/sdk\"\nexport {getTransactionStatus} from \"@onflow/sdk\"\nexport {getTransaction} from \"@onflow/sdk\"\nexport {authorizations, authorization} from \"@onflow/sdk\"\nexport {args, arg} from \"@onflow/sdk\"\nexport {proposer} from \"@onflow/sdk\"\nexport {payer} from \"@onflow/sdk\"\nexport {limit} from \"@onflow/sdk\"\nexport {ref} from \"@onflow/sdk\"\nexport {params, param} from \"@onflow/sdk\"\nexport {validator} from \"@onflow/sdk\"\nexport {invariant} from \"@onflow/sdk\"\n"],"names":["VERSION","getDiscoveryService","config","first","discoveryWallet","get","discoveryAuthnInclude","discoveryWalletMethod","type","endpoint","method","configLens","regex","where","Object","fromEntries","entries","map","key","value","replace","isServerSide","window","SESSION_STORAGE","can","JSON","parse","sessionStorage","getItem","put","setItem","stringify","STORAGE_DEFAULT","DISCOVERY_METHOD","is","d","isRequired","isObject","isString","isFunc","isNumber","normalizeArgs","ax","sdk","arg","t","preQuery","opts","invariant","cadence","query","send","script","args","limit","then","decode","fetchServices","servicesURL","code","url","URL","searchParams","append","fetch","headers","json","resp","Array","isArray","services","authorizations","service","push","keyId","provider","id","mergeServices","sx1","sx2","SERVICE_PRAGMA","f_type","f_vsn","IDENTITY_PRAGMA","USER_PRAGMA","POLLING_RESPONSE_PRAGMA","COMPOSITE_SIGNATURE_PRAGMA","normalizeAuthn","uid","authn","pid","address","withPrefix","addr","name","icon","normalizeAuthz","identity","params","data","normalizePreAuthz","normalizeFrame","old","normalizeBackChannelRpc","normalizeOpenId","normalizeUserSignature","Error","normalizeLocalView","normalizeAccountProof","normalizeAuthnRefresh","serviceNormalizers","authz","frame","normalizeService","normalized","error","console","deriveCompositeId","rlp","encode","toString","normalizeData","paddr","findService","find","buildUser","hks","cid","loggedIn","expiresAt","expires","serviceOfType","serviceEndpoint","location","origin","fetchService","body","undefined","normalizePollingResponse","status","reason","compositeSignature","updates","authorizationUpdates","local","poll","canContinue","serviceMethod","Promise","r","setTimeout","OPTIONS","FRAME","FRAME_STYLES","renderFrame","src","document","getElementById","$frame","createElement","allow","frameBorder","style","cssText","unmount","remove","contentWindow","POP","popup","previousUrl","popupWindow","windowName","win","w","h","y","top","outerHeight","screenY","x","outerWidth","screenX","open","renderPop","closed","focus","close","tab","renderTab","execLocal","VIEWS","execHttpPost","signable","fclVersion","_","serviceResponse","CLOSE_EVENT","READY_EVENT","RESPONSE_EVENT","e","toLowerCase","IGNORE","Set","deprecate","was","want","warn","buildMessageHandler","onReady","onResponse","onMessage","has","noop","onClose","addEventListener","removeEventListener","msg","postMessage","execIframeRPC","resolve","reject","includeOlderJsonRpcCall","deprecated","message","jsonrpc","result","pop","$pop","timer","setInterval","clearInterval","execPopRPC","redir","$tab","execTabRPC","extension","execExtRPC","recover","execService","fullConfig","app","client","fclLibrary","hostname","extensions","fcl_extensions","STRATEGIES","res","normalizeCompositeSignature","sansPrefix","signature","sig","pact","state","s","v","o","_settle","bind","observer","signUserMessage","spawnCurrentUser","authenticate","user","signingService","makeSignable","response","compSigs","_Pact","prototype","onFulfilled","onRejected","callback","_this","_isSettledPact","thenable","_for","test","update","stage","shouldContinue","updateValue","_resumeAfterTest","_resumeAfterBody","_resumeAfterUpdate","resolveArgument","Address","_catch","_finally","finalizer","authorization","account","tempId","preSignable","sequenceNum","signingFunction","preAuthz","resolvePreAuthz","_finallyRethrows","snapshot","discoveryService","accountProofData","NAME","SET_CURRENT_USER","refreshService","getAccountProofData","accountProofDataResolver","appIdentifier","nonce","UPDATED","SNAPSHOT","DEL_CURRENT_USER","DATA","getStoredUser","storage","fallback","stored","removeItem","HANDLERS","INIT","ctx","merge","notExpired","SUBSCRIBE","letter","subscribe","from","all","UNSUBSCRIBE","unsubscribe","reply","broadcast","spawn","Date","now","unauthenticate","normalizePreAuthzResponse","proposer","payer","axs","az","role","join","authorizer","EXIT","self","receive","tag","expectReply","timeout","currentUser","RATE","POLL","fetchTxStatus","transactionId","fclSend","getTransactionStatus","isExpired","tx","isSealed","isExecuted","isFinalized","isPending","isUnknown","isDiff","cur","next","sendSelf","scoped","spawnTransaction","transaction","snapshoter","subscriber","once","predicate","innerOnce","suppress","unsub","txStatus","statusCode","errorMessage","onceFinalized","onceExecuted","onceSealed","prepMutation","mutate","txid","onMessageFromFCL","messageType","cb","buildData","interaction","internal","sendMsgToFCL","parent","opener","ready","approve","decline","redirect","CompositeSignature","Number","rightPaddedHexBuffer","pad","Buffer","padEnd","leftPaddedHexBuffer","padStart","addressBuffer","nonceBuffer","encodeAccountProof","includeDomainTag","length","ACCOUNT_PROOF_DOMAIN_TAG","concat","rlpEncode","injectExtService","verifyUserSignatures","validateArgs","signaturesArr","keyIndices","el","getVerifySignaturesScript","USER_SIGNATURE","String","Int","verifyAccountProof","signatures","ACCOUNT_PROOF","every","i","arr","cs","verifyFunction","network","fclCryptoContract","promise","title","level","always","logger","verify","serialize","defaultResolve","resolveFunction","createSignableVoucher","pipe","TICK","HIGH_WATER_MARK","scheduleTick","hasSubs","hwm","block","getEventsAtBlockHeightRange","height","clearTimeout","spawnEvents","events","addServices","Boolean","include","asyncPipe","input","reduce","chain","fn","addExtensions","filterServicesByType","filter","getServices","RESULTS","fact","spawnProviders","discovery","reauthenticate","signUp","logIn","types"],"mappings":"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"}